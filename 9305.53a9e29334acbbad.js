"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9305],{9305:(e,n,t)=>{t.r(n),t.d(n,{CoreMainMenuUserMenuComponent:()=>S});var o=t(10467),i=t(74431),r=t(3353),a=t(7310),s=t(90121),l=t(60378),c=t(98870),u=t(5784),m=t(6319),_=t(15324),p=t(52749),d=t(89911),M=t(55554),g=t(79555),f=t(82461),C=t(54438),h=t(60177),b=t(64422),I=t(16658),U=t(10892),T=t(86198),k=t(58197),R=t(23007),G=t(88246),y=t(43570),$=t(73465),L=t(73955);const _c0=e=>["core-user-menu-handler",e],_c1=e=>({$a:e}),_c2=(e,n)=>["core-user-account-menu-handler",e,n];function CoreMainMenuUserMenuComponent_ion_item_13_img_2_Template(e,n){if(1&e&&C.nrm(0,"img",21),2&e){const e=C.XpG(2);C.Y8G("src",e.siteLogo,C.B4B)}}function CoreMainMenuUserMenuComponent_ion_item_13_Template(e,n){if(1&e&&(C.j41(0,"ion-item",16)(1,"ion-label"),C.DNE(2,CoreMainMenuUserMenuComponent_ion_item_13_img_2_Template,1,1,"img",17),C.j41(3,"p",18),C.nrm(4,"core-format-text",19),C.k0s(),C.j41(5,"a",20),C.EFF(6),C.k0s()()()),2&e){const e=C.XpG();C.Y8G("detail",!1)("href",e.siteUrl),C.R7$(2),C.Y8G("ngIf",e.siteLogo&&e.siteLogoLoaded),C.R7$(2),C.Y8G("text",e.siteName)("contextInstanceId",0)("wsNotFiltered",!0),C.R7$(),C.Y8G("href",e.siteUrl,C.B4B),C.R7$(),C.JRh(e.siteUrl)}}function CoreMainMenuUserMenuComponent_ion_item_14_img_2_Template(e,n){if(1&e&&C.nrm(0,"img",24),2&e){const e=C.XpG(2);C.Y8G("src",e.siteLogo,C.B4B)}}function CoreMainMenuUserMenuComponent_ion_item_14_Template(e,n){if(1&e&&(C.j41(0,"ion-item",22)(1,"ion-label"),C.DNE(2,CoreMainMenuUserMenuComponent_ion_item_14_img_2_Template,1,1,"img",23),C.j41(3,"p",18),C.nrm(4,"core-format-text",19),C.k0s()()()),2&e){const e=C.XpG();C.R7$(2),C.Y8G("ngIf",e.siteLogo&&e.siteLogoLoaded),C.R7$(2),C.Y8G("text",e.siteName)("contextInstanceId",0)("wsNotFiltered",!0)}}function CoreMainMenuUserMenuComponent_ion_item_15_Template(e,n){if(1&e){const e=C.RV6();C.j41(0,"ion-item",25),C.nI1(1,"translate"),C.bIt("click",(function CoreMainMenuUserMenuComponent_ion_item_15_Template_ion_item_click_0_listener(n){C.eBV(e);const t=C.XpG();return C.Njj(t.openUserProfile(n))})),C.nrm(2,"core-user-avatar",26),C.j41(3,"ion-label")(4,"p",10),C.EFF(5),C.k0s()()()}if(2&e){const e=C.XpG();C.Y8G("detail",!0),C.BMQ("aria-label",C.bMT(1,6,"core.user.profile")),C.R7$(2),C.Y8G("site",e.siteInfo)("userId",e.siteInfo.userid)("linkProfile",!1),C.R7$(3),C.JRh(e.siteInfo.fullname)}}function CoreMainMenuUserMenuComponent_ion_item_16_ion_icon_2_Template(e,n){if(1&e&&C.nrm(0,"ion-icon",32),2&e){const e=C.XpG().$implicit;C.Y8G("name",e.icon)}}function CoreMainMenuUserMenuComponent_ion_item_16_ion_badge_7_Template(e,n){if(1&e&&(C.j41(0,"ion-badge",33),C.EFF(1),C.k0s()),2&e){const e=C.XpG().$implicit;C.Y8G("hidden",e.loading||!e.badge),C.R7$(),C.SpI(" ",e.badge," ")}}function CoreMainMenuUserMenuComponent_ion_item_16_span_8_Template(e,n){if(1&e&&(C.j41(0,"span",34),C.EFF(1),C.nI1(2,"translate"),C.k0s()),2&e){const e=C.XpG().$implicit;C.R7$(),C.SpI(" ",C.i5U(2,1,e.badgeA11yText,C.eq3(4,_c1,e.badge))," ")}}function CoreMainMenuUserMenuComponent_ion_item_16_ion_spinner_9_Template(e,n){1&e&&(C.nrm(0,"ion-spinner",0),C.nI1(1,"translate")),2&e&&C.BMQ("aria-label",C.bMT(1,1,"core.loading"))}function CoreMainMenuUserMenuComponent_ion_item_16_Template(e,n){if(1&e){const e=C.RV6();C.j41(0,"ion-item",27),C.nI1(1,"translate"),C.bIt("click",(function CoreMainMenuUserMenuComponent_ion_item_16_Template_ion_item_click_0_listener(n){const t=C.eBV(e).$implicit,o=C.XpG();return C.Njj(o.handlerClicked(n,t))})),C.DNE(2,CoreMainMenuUserMenuComponent_ion_item_16_ion_icon_2_Template,1,1,"ion-icon",28),C.j41(3,"ion-label")(4,"p",10),C.EFF(5),C.nI1(6,"translate"),C.k0s()(),C.DNE(7,CoreMainMenuUserMenuComponent_ion_item_16_ion_badge_7_Template,2,2,"ion-badge",29)(8,CoreMainMenuUserMenuComponent_ion_item_16_span_8_Template,3,6,"span",30)(9,CoreMainMenuUserMenuComponent_ion_item_16_ion_spinner_9_Template,2,3,"ion-spinner",31),C.k0s()}if(2&e){const e=n.$implicit;C.Y8G("ngClass",C.eq3(13,_c0,e.class||""))("hidden",e.hidden)("detail",!0),C.BMQ("aria-label",C.bMT(1,9,e.title)),C.R7$(2),C.Y8G("ngIf",e.icon),C.R7$(3),C.JRh(C.bMT(6,11,e.title)),C.R7$(2),C.Y8G("ngIf",e.showBadge),C.R7$(),C.Y8G("ngIf",e.showBadge&&e.badge&&e.badgeA11yText),C.R7$(),C.Y8G("ngIf",e.showBadge&&e.loading)}}function CoreMainMenuUserMenuComponent_ion_item_17_ion_icon_2_Template(e,n){if(1&e&&C.nrm(0,"ion-icon",32),2&e){const e=C.XpG().$implicit;C.Y8G("name",e.icon)}}function CoreMainMenuUserMenuComponent_ion_item_17_ion_badge_7_Template(e,n){if(1&e&&(C.j41(0,"ion-badge",33),C.EFF(1),C.k0s()),2&e){const e=C.XpG().$implicit;C.Y8G("hidden",e.loading||!e.badge),C.R7$(),C.SpI(" ",e.badge," ")}}function CoreMainMenuUserMenuComponent_ion_item_17_span_8_Template(e,n){if(1&e&&(C.j41(0,"span",34),C.EFF(1),C.nI1(2,"translate"),C.k0s()),2&e){const e=C.XpG().$implicit;C.R7$(),C.SpI(" ",C.i5U(2,1,e.badgeA11yText,C.eq3(4,_c1,e.badge))," ")}}function CoreMainMenuUserMenuComponent_ion_item_17_ion_spinner_9_Template(e,n){1&e&&(C.nrm(0,"ion-spinner",0),C.nI1(1,"translate")),2&e&&C.BMQ("aria-label",C.bMT(1,1,"core.loading"))}function CoreMainMenuUserMenuComponent_ion_item_17_Template(e,n){if(1&e){const e=C.RV6();C.j41(0,"ion-item",27),C.nI1(1,"translate"),C.bIt("click",(function CoreMainMenuUserMenuComponent_ion_item_17_Template_ion_item_click_0_listener(n){const t=C.eBV(e).$implicit,o=C.XpG();return C.Njj(o.handlerClicked(n,t))})),C.DNE(2,CoreMainMenuUserMenuComponent_ion_item_17_ion_icon_2_Template,1,1,"ion-icon",28),C.j41(3,"ion-label")(4,"p",10),C.EFF(5),C.nI1(6,"translate"),C.k0s()(),C.DNE(7,CoreMainMenuUserMenuComponent_ion_item_17_ion_badge_7_Template,2,2,"ion-badge",29)(8,CoreMainMenuUserMenuComponent_ion_item_17_span_8_Template,3,6,"span",30)(9,CoreMainMenuUserMenuComponent_ion_item_17_ion_spinner_9_Template,2,3,"ion-spinner",31),C.k0s()}if(2&e){const e=n.$implicit;C.Y8G("ngClass",C.l_i(13,_c2,e.class||"",n.first?"core-user-menu-separator":""))("hidden",e.hidden)("detail",!0),C.BMQ("aria-label",C.bMT(1,9,e.title)),C.R7$(2),C.Y8G("ngIf",e.icon),C.R7$(3),C.JRh(C.bMT(6,11,e.title)),C.R7$(2),C.Y8G("ngIf",e.showBadge),C.R7$(),C.Y8G("ngIf",e.showBadge&&e.badge&&e.badgeA11yText),C.R7$(),C.Y8G("ngIf",e.showBadge&&e.loading)}}function CoreMainMenuUserMenuComponent_ion_item_25_Template(e,n){if(1&e){const e=C.RV6();C.j41(0,"ion-item",35),C.nI1(1,"translate"),C.bIt("click",(function CoreMainMenuUserMenuComponent_ion_item_25_Template_ion_item_click_0_listener(n){C.eBV(e);const t=C.XpG();return C.Njj(t.contactSupport(n))})),C.nrm(2,"ion-icon",36),C.j41(3,"ion-label")(4,"p",10),C.EFF(5),C.nI1(6,"translate"),C.k0s()()()}2&e&&(C.Y8G("detail",!0),C.BMQ("aria-label",C.bMT(1,3,"core.user.support")),C.R7$(5),C.JRh(C.bMT(6,5,"core.user.support")))}function CoreMainMenuUserMenuComponent_ion_item_27_Template(e,n){if(1&e){const e=C.RV6();C.j41(0,"ion-item",37),C.bIt("click",(function CoreMainMenuUserMenuComponent_ion_item_27_Template_ion_item_click_0_listener(n){C.eBV(e);const t=C.XpG();return C.Njj(t.switchAccounts(n))})),C.nrm(1,"ion-icon",38),C.j41(2,"ion-label")(3,"p",10),C.EFF(4),C.nI1(5,"translate"),C.k0s()()()}2&e&&(C.Y8G("detail",!0),C.R7$(4),C.JRh(C.bMT(5,2,"core.mainmenu.switchaccount")))}function CoreMainMenuUserMenuComponent_ng_container_31_Template(e,n){1&e&&(C.qex(0),C.nrm(1,"ion-icon",39),C.EFF(2),C.nI1(3,"translate"),C.bVm()),2&e&&(C.R7$(2),C.SpI(" ",C.bMT(3,1,"core.mainmenu.logout")," "))}function CoreMainMenuUserMenuComponent_ng_container_32_Template(e,n){1&e&&(C.qex(0),C.nrm(1,"ion-icon",40),C.EFF(2),C.nI1(3,"translate"),C.bVm()),2&e&&(C.R7$(2),C.SpI(" ",C.bMT(3,1,"core.login.removeaccount")," "))}let S=(()=>{var e;class CoreMainMenuUserMenuComponent{constructor(){this.siteLogoLoaded=!1,this.displaySiteUrl=!1,this.handlers=[],this.accountHandlers=[],this.handlersLoaded=!1,this.displaySwitchAccount=!0,this.displayContactSupport=!1,this.removeAccountOnLogout=!1}ngOnInit(){var e=this;return(0,o.A)((function*(){const n=p.CoreSites.getRequiredCurrentSite();if(e.siteId=n.getId(),e.siteInfo=n.getInfo(),e.siteName=yield n.getSiteName(),e.siteUrl=n.getURL(),e.displaySwitchAccount=!n.isFeatureDisabled("NoDelegate_SwitchAccount"),e.displayContactSupport=new s.z(n).canContactSupport(),e.removeAccountOnLogout=!!i.CoreConstants.CONFIG.removeaccountonlogout,e.displaySiteUrl=n.shouldDisplayInformativeLinks(),e.loadSiteLogo(n),e.siteInfo){try{e.user=yield c.CoreUser.getProfile(e.siteInfo.userid)}catch{e.user={id:e.siteInfo.userid,fullname:e.siteInfo.fullname}}e.subscription=u.CoreUserDelegate.getProfileHandlersFor(e.user,u.CoreUserDelegateContext.USER_MENU).subscribe((n=>{if(!e.user)return;let t=n.filter((e=>e.type===u.CoreUserProfileHandlerType.LIST_ITEM)).map((e=>e.data));t.length===e.handlers.length&&JSON.stringify(t)===JSON.stringify(e.handlers)||(e.handlers=t),t=n.filter((e=>e.type===u.CoreUserProfileHandlerType.LIST_ACCOUNT_ITEM)).map((e=>e.data)),t.length===e.handlers.length&&JSON.stringify(t)===JSON.stringify(e.handlers)||(e.accountHandlers=t),e.handlersLoaded=u.CoreUserDelegate.areHandlersLoaded(e.user.id,u.CoreUserDelegateContext.USER_MENU)}))}}))()}loadSiteLogo(e){var n=this;return(0,o.A)((function*(){if(e.forcesLocalLogo())return n.siteLogo=e.getLogoUrl(),n.siteLogoLoaded=!0,void 0;const t=yield M.g.ignoreErrors(e.getPublicConfig());n.siteLogo=e.getLogoUrl(t),n.siteLogoLoaded=!0}))()}openUserProfile(e){var n=this;return(0,o.A)((function*(){n.siteInfo&&(yield n.close(e),_.CoreNavigator.navigateToSitePath("user/about",{params:{userId:n.siteInfo.userid}}))}))()}openPreferences(e){var n=this;return(0,o.A)((function*(){yield n.close(e),_.CoreNavigator.navigateToSitePath("preferences")}))()}handlerClicked(e,n){var t=this;return(0,o.A)((function*(){t.user&&(yield t.close(e),n.action(e,t.user,u.CoreUserDelegateContext.USER_MENU))}))()}contactSupport(e){var n=this;return(0,o.A)((function*(){yield n.close(e),yield l.I.contact()}))()}logout(e){var n=this;return(0,o.A)((function*(){if(n.removeAccountOnLogout){const e=n.siteName?yield a.CoreFilter.formatText(n.siteName,{clean:!0,singleLine:!0,filter:!1},[],n.siteId):"";try{yield d.CoreDomUtils.showDeleteConfirm("core.login.confirmdeletesite",{sitename:e})}catch(e){return}}yield n.close(e),yield p.CoreSites.logout({forceLogout:!0,removeAccount:n.removeAccountOnLogout})}))()}switchAccounts(e){return(0,o.A)((function*(){const n=yield g.W3.getTop();e.preventDefault(),e.stopPropagation();const{CoreLoginSitesModalComponent:o}=yield t.e(554).then(t.bind(t,70554)),i=yield m.I.openSideModal({component:o,cssClass:"core-modal-lateral core-modal-lateral-sm"});n&&i&&(yield g.W3.dismiss(void 0,void 0,n.id))}))()}addAccount(e){var n=this;return(0,o.A)((function*(){yield n.close(e),yield f.CoreLoginHelper.goToAddSite(!0,!0)}))()}close(e){return(0,o.A)((function*(){e.preventDefault(),e.stopPropagation(),yield g.W3.dismiss()}))()}ngOnDestroy(){var e;null===(e=this.subscription)||void 0===e||e.unsubscribe()}}return(e=CoreMainMenuUserMenuComponent).ɵfac=function CoreMainMenuUserMenuComponent_Factory(n){return new(n||e)},e.ɵcmp=C.VBU({type:e,selectors:[["core-main-menu-user-menu"]],standalone:!0,features:[C.aNF],decls:33,vars:26,consts:[["slot","end"],["fill","clear",3,"click","ariaLabel"],["name","fas-xmark","slot","icon-only","aria-hidden","true"],[3,"hideUntil"],["button","","class","core-usermenu-siteinfo ion-text-wrap","lines","full","core-link","",3,"detail","href",4,"ngIf"],["class","core-usermenu-siteinfo ion-text-wrap","lines","full","detail","false",4,"ngIf"],["button","","class","core-usermenu-profile ion-text-wrap","lines","full",3,"detail","click",4,"ngIf"],["button","","class","ion-text-wrap",3,"ngClass","hidden","detail","click",4,"ngFor","ngForOf"],["button","",1,"core-user-menu-preferences","core-user-menu-separator",3,"click","detail"],["name","fas-wrench","slot","start","aria-hidden","true"],[1,"item-heading"],["button","","detailIcon","open-outline","class","core-user-menu-support",3,"detail","click",4,"ngIf"],["button","","lines","full","class","ion-text-wrap",3,"detail","click",4,"ngIf"],[1,"ion-padding"],["expand","block","color","danger",1,"ion-text-wrap",3,"click","ariaLabel"],[4,"ngIf"],["button","","lines","full","core-link","",1,"core-usermenu-siteinfo","ion-text-wrap",3,"detail","href"],["class","core-usermenu-site-logo","role","presentation","alt","","core-external-content","","onError","this.class='image-not-found'",3,"src",4,"ngIf"],[1,"core-usermenu-sitename"],["contextLevel","system",3,"text","contextInstanceId","wsNotFiltered"],["core-link","",1,"core-usermenu-siteurl",3,"href"],["role","presentation","alt","","core-external-content","","onError","this.class='image-not-found'",1,"core-usermenu-site-logo",3,"src"],["lines","full","detail","false",1,"core-usermenu-siteinfo","ion-text-wrap"],["class","core-usermenu-site-logo","role","presentation","alt","","onError","this.class='image-not-found'",3,"src",4,"ngIf"],["role","presentation","alt","","onError","this.class='image-not-found'",1,"core-usermenu-site-logo",3,"src"],["button","","lines","full",1,"core-usermenu-profile","ion-text-wrap",3,"click","detail"],["slot","start",3,"site","userId","linkProfile"],["button","",1,"ion-text-wrap",3,"click","ngClass","hidden","detail"],["slot","start","aria-hidden","true",3,"name",4,"ngIf"],["slot","end","aria-hidden","true",3,"hidden",4,"ngIf"],["class","sr-only",4,"ngIf"],["slot","end",4,"ngIf"],["slot","start","aria-hidden","true",3,"name"],["slot","end","aria-hidden","true",3,"hidden"],[1,"sr-only"],["button","","detailIcon","open-outline",1,"core-user-menu-support",3,"click","detail"],["name","fas-envelope","slot","start","aria-hidden","true"],["button","","lines","full",1,"ion-text-wrap",3,"click","detail"],["name","fas-right-left","slot","start","aria-hidden","true"],["name","fas-right-from-bracket","slot","start","aria-hidden","true"],["name","fas-trash","slot","start","aria-hidden","true"]],template:function CoreMainMenuUserMenuComponent_Template(e,n){1&e&&(C.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title")(3,"h1"),C.EFF(4),C.nI1(5,"translate"),C.k0s()(),C.j41(6,"ion-buttons",0)(7,"ion-button",1),C.nI1(8,"translate"),C.bIt("click",(function CoreMainMenuUserMenuComponent_Template_ion_button_click_7_listener(e){return n.close(e)})),C.nrm(9,"ion-icon",2),C.k0s()()()(),C.j41(10,"ion-content")(11,"core-loading",3)(12,"ion-list"),C.DNE(13,CoreMainMenuUserMenuComponent_ion_item_13_Template,7,8,"ion-item",4)(14,CoreMainMenuUserMenuComponent_ion_item_14_Template,5,4,"ion-item",5)(15,CoreMainMenuUserMenuComponent_ion_item_15_Template,6,8,"ion-item",6)(16,CoreMainMenuUserMenuComponent_ion_item_16_Template,10,15,"ion-item",7)(17,CoreMainMenuUserMenuComponent_ion_item_17_Template,10,16,"ion-item",7),C.j41(18,"ion-item",8),C.nI1(19,"translate"),C.bIt("click",(function CoreMainMenuUserMenuComponent_Template_ion_item_click_18_listener(e){return n.openPreferences(e)})),C.nrm(20,"ion-icon",9),C.j41(21,"ion-label")(22,"p",10),C.EFF(23),C.nI1(24,"translate"),C.k0s()()(),C.DNE(25,CoreMainMenuUserMenuComponent_ion_item_25_Template,7,7,"ion-item",11),C.k0s()()(),C.j41(26,"ion-footer"),C.DNE(27,CoreMainMenuUserMenuComponent_ion_item_27_Template,6,4,"ion-item",12),C.j41(28,"div",13)(29,"ion-button",14),C.nI1(30,"translate"),C.bIt("click",(function CoreMainMenuUserMenuComponent_Template_ion_button_click_29_listener(e){return n.logout(e)})),C.DNE(31,CoreMainMenuUserMenuComponent_ng_container_31_Template,4,3,"ng-container",15)(32,CoreMainMenuUserMenuComponent_ng_container_32_Template,4,3,"ng-container",15),C.k0s()()()),2&e&&(C.R7$(4),C.SpI(" ",C.bMT(5,16,"core.user.useraccount")," "),C.R7$(3),C.Y8G("ariaLabel",C.bMT(8,18,"core.close")),C.R7$(4),C.Y8G("hideUntil",n.siteLogoLoaded&&n.handlersLoaded),C.R7$(2),C.Y8G("ngIf",n.siteInfo&&n.displaySiteUrl),C.R7$(),C.Y8G("ngIf",n.siteInfo&&!n.displaySiteUrl),C.R7$(),C.Y8G("ngIf",n.siteInfo),C.R7$(),C.Y8G("ngForOf",n.handlers),C.R7$(),C.Y8G("ngForOf",n.accountHandlers),C.R7$(),C.Y8G("detail",!0),C.BMQ("aria-label",C.bMT(19,20,"core.settings.preferences")),C.R7$(5),C.JRh(C.bMT(24,22,"core.settings.preferences")),C.R7$(2),C.Y8G("ngIf",n.displayContactSupport),C.R7$(2),C.Y8G("ngIf",n.displaySwitchAccount),C.R7$(2),C.Y8G("ariaLabel",C.bMT(30,24,"core.mainmenu.logout")),C.R7$(2),C.Y8G("ngIf",!n.removeAccountOnLogout),C.R7$(),C.Y8G("ngIf",n.removeAccountOnLogout))},dependencies:[r.n,h.YU,h.Sq,h.bT,b.R,I.T,U.l,T.t,k.B,R.j,G.i,y.T,$.In,$.Jm,$.QW,$.W9,$.M0,$.eU,$.iq,$.uz,$.he,$.nf,$.w2,$.BC,$.ai,L.D9],styles:["[_nghost-%COMP%]   .core-user-menu-separator[_ngcontent-%COMP%]{--inner-border-width: 0;--border-width: 1px 0 0 0}.core-usermenu-siteinfo[_ngcontent-%COMP%]{text-align:center;--padding-top: 10px;--padding-bottom: 10px}.core-usermenu-siteinfo[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{margin:0}.core-usermenu-sitename[_ngcontent-%COMP%]{font:var(--mdl-typography-subtitle-font-lg)}img.core-usermenu-site-logo[_ngcontent-%COMP%]{margin-bottom:8px;max-height:var(--core-user-menu-site-logo-max-height)}img.image-not-found[_ngcontent-%COMP%]{display:none}ion-footer[_ngcontent-%COMP%]{background:var(--contrast-background)}"]}),CoreMainMenuUserMenuComponent})()}}]);