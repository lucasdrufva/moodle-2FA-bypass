"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[311],{80311:(e,t,r)=>{r.r(t),r.d(t,{CoreSitePluginsDirectivesModule:()=>w});var s=r(10467),n=r(79555),i=r(45433),a=r(15324),o=r(89911),l=r(49588),c=r(54438),u=r(32832),h=r(6787),C=r(63153),g=r(46526);let p=(()=>{var e;class CoreSitePluginsCallWSBaseDirective{constructor(e,t){this.parentContent=t,this.onSuccess=new c.bkB,this.onError=new c.bkB,this.onDone=new c.bkB,this.element=e.nativeElement||e,this.logger=h.CoreLogger.getInstance("CoreSitePluginsCallWS")}ngOnInit(){var e;null!==(e=this.parentContent)&&void 0!==e&&e.invalidateObservable&&(this.invalidateObserver=this.parentContent.invalidateObservable.subscribe((()=>{this.invalidate()})))}callWS(){var e=this;return(0,s.A)((function*(){try{const t=e.getParamsForWS(),r=yield u.CoreSitePlugins.callWS(e.name,t,e.preSets);e.onSuccess.emit(r),e.wsCallSuccess(r)}catch(t){throw e.onError.emit(t),e.logger.error(`Error calling WS ${e.name}`,t),t}finally{e.onDone.emit()}}))()}getParamsForWS(){let e=this.params||{};return this.parentContent&&(e=u.CoreSitePlugins.loadOtherDataInArgs(e,this.parentContent.otherData,this.useOtherDataForWS)),this.form&&document.forms[this.form]&&(e=Object.assign(e,C.R.getDataFromForm(document.forms[this.form]))),e}wsCallSuccess(e){}invalidate(){const e=this.getParamsForWS();return u.CoreSitePlugins.invalidateCallWS(this.name,e,this.preSets)}ngOnDestroy(){var e;null===(e=this.invalidateObserver)||void 0===e||e.unsubscribe()}}return(e=CoreSitePluginsCallWSBaseDirective).ɵfac=function CoreSitePluginsCallWSBaseDirective_Factory(t){return new(t||e)(c.rXU(c.aKT),c.rXU(g.U))},e.ɵdir=c.FsC({type:e,inputs:{name:"name",params:"params",preSets:"preSets",useOtherDataForWS:"useOtherDataForWS",form:"form"},outputs:{onSuccess:"onSuccess",onError:"onError",onDone:"onDone"}}),CoreSitePluginsCallWSBaseDirective})();var d=r(91416),S=r(23780);let v=(()=>{var e;class CoreSitePluginsCallWSOnClickBaseDirective extends p{constructor(e,t){super(e,t),this.showError=!0}ngOnInit(){var e=this;super.ngOnInit(),this.element.addEventListener("click",function(){var t=(0,s.A)((function*(t){if(t.preventDefault(),t.stopPropagation(),void 0!==e.confirmMessage)try{yield o.CoreDomUtils.showConfirm(e.confirmMessage||n.HT.instant("core.areyousure"))}catch{return}e.callWS()}));return function(e){return t.apply(this,arguments)}}())}callWS(){var _superprop_getCallWS=()=>super.callWS,e=this;return(0,s.A)((function*(){const t=yield S.CoreLoadings.show();try{yield _superprop_getCallWS().call(e)}catch(t){var r;if(e.showError)o.CoreDomUtils.showErrorModalDefault(t,n.HT.instant("core.serverconnection",{details:null!==(r=l.CoreErrorHelper.getErrorMessageFromError(t))&&void 0!==r?r:"Unknown error"}))}finally{t.dismiss()}}))()}}return(e=CoreSitePluginsCallWSOnClickBaseDirective).ɵfac=function CoreSitePluginsCallWSOnClickBaseDirective_Factory(t){return new(t||e)(c.rXU(c.aKT),c.rXU(g.U))},e.ɵdir=c.FsC({type:e,inputs:{confirmMessage:"confirmMessage",showError:[c.Mj6.HasDecoratorInputTransform,"showError","showError",d.G]},features:[c.GFd,c.Vt3]}),CoreSitePluginsCallWSOnClickBaseDirective})(),m=(()=>{var e;class CoreSitePluginsCallWSDirective extends v{constructor(e,t){super(e,t),this.goBackOnSuccess=!1,this.refreshOnSuccess=!1}wsCallSuccess(){var e=this;return(0,s.A)((function*(){e.goBackOnSuccess?yield a.CoreNavigator.back():e.refreshOnSuccess&&e.parentContent&&e.parentContent.refreshContent(!0),void 0!==e.successMessage&&i.CoreToasts.show({message:e.successMessage||n.HT.instant("core.success")})}))()}}return(e=CoreSitePluginsCallWSDirective).ɵfac=function CoreSitePluginsCallWSDirective_Factory(t){return new(t||e)(c.rXU(c.aKT),c.rXU(g.U,8))},e.ɵdir=c.FsC({type:e,selectors:[["","core-site-plugins-call-ws",""]],inputs:{successMessage:"successMessage",goBackOnSuccess:[c.Mj6.HasDecoratorInputTransform,"goBackOnSuccess","goBackOnSuccess",d.G],refreshOnSuccess:[c.Mj6.HasDecoratorInputTransform,"refreshOnSuccess","refreshOnSuccess",d.G]},features:[c.GFd,c.Vt3]}),CoreSitePluginsCallWSDirective})();var f=r(91768);let D=(()=>{var e;class CoreSitePluginsCallWSNewContentDirective extends v{constructor(e,t){super(e,t),this.samePage=!1,this.ptrEnabled=!0}wsCallSuccess(e){let t=this.args||{};this.parentContent&&(t=u.CoreSitePlugins.loadOtherDataInArgs(this.args,this.parentContent.otherData,this.useOtherData)),t=Object.assign(t,e);let r=this.jsData||{};var s;!0===r&&(r=(null===(s=this.parentContent)||void 0===s?void 0:s.data)||{});if(this.samePage){var n;null===(n=this.parentContent)||void 0===n||n.updateContent(t,this.component,this.method,r,this.newContentPreSets)}else{var i,o,l,c;const e=this.component||(null===(i=this.parentContent)||void 0===i?void 0:i.component),s=this.method||(null===(o=this.parentContent)||void 0===o?void 0:o.method),n=f.VV.hashAsciiStr(JSON.stringify(t));a.CoreNavigator.navigateToSitePath(`siteplugins/content/${e}/${s}/${n}`,{params:{title:this.title||(null===(l=this.parentContent)||void 0===l?void 0:l.pageTitle),args:t,initResult:null===(c=this.parentContent)||void 0===c?void 0:c.initResult,jsData:r,preSets:this.newContentPreSets,ptrEnabled:this.ptrEnabled}})}}}return(e=CoreSitePluginsCallWSNewContentDirective).ɵfac=function CoreSitePluginsCallWSNewContentDirective_Factory(t){return new(t||e)(c.rXU(c.aKT),c.rXU(g.U,8))},e.ɵdir=c.FsC({type:e,selectors:[["","core-site-plugins-call-ws-new-content",""]],inputs:{component:"component",method:"method",args:"args",title:"title",samePage:[c.Mj6.HasDecoratorInputTransform,"samePage","samePage",d.G],useOtherData:"useOtherData",form:"form",jsData:"jsData",newContentPreSets:"newContentPreSets",ptrEnabled:[c.Mj6.HasDecoratorInputTransform,"ptrEnabled","ptrEnabled",d.G]},features:[c.GFd,c.Vt3]}),CoreSitePluginsCallWSNewContentDirective})(),P=(()=>{var e;class CoreSitePluginsCallWSOnLoadDirective extends p{constructor(e,t){super(e,t)}ngOnInit(){super.ngOnInit(),this.callWS().catch((()=>{}))}}return(e=CoreSitePluginsCallWSOnLoadDirective).ɵfac=function CoreSitePluginsCallWSOnLoadDirective_Factory(t){return new(t||e)(c.rXU(c.aKT),c.rXU(g.U,8))},e.ɵdir=c.FsC({type:e,selectors:[["","core-site-plugins-call-ws-on-load",""]],features:[c.Vt3]}),CoreSitePluginsCallWSOnLoadDirective})(),O=(()=>{var e;class CoreSitePluginsNewContentDirective{constructor(e,t){this.parentContent=t,this.samePage=!1,this.ptrEnabled=!0,this.element=e.nativeElement||e}ngOnInit(){this.element.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation();let t=this.args||{};this.parentContent&&(t=u.CoreSitePlugins.loadOtherDataInArgs(this.args,this.parentContent.otherData,this.useOtherData)),this.form&&document.forms[this.form]&&(t=Object.assign(t,C.R.getDataFromForm(document.forms[this.form])));let r=this.jsData||{};var s;!0===r&&(r=(null===(s=this.parentContent)||void 0===s?void 0:s.data)||{});if(this.samePage){var n;null===(n=this.parentContent)||void 0===n||n.updateContent(t,this.component,this.method,r,this.preSets)}else{var i,o,l,c;const e=this.component||(null===(i=this.parentContent)||void 0===i?void 0:i.component),s=this.method||(null===(o=this.parentContent)||void 0===o?void 0:o.method),n=f.VV.hashAsciiStr(JSON.stringify(t));a.CoreNavigator.navigateToSitePath(`siteplugins/content/${e}/${s}/${n}`,{params:{title:this.title||(null===(l=this.parentContent)||void 0===l?void 0:l.pageTitle),args:t,initResult:null===(c=this.parentContent)||void 0===c?void 0:c.initResult,jsData:r,preSets:this.preSets,ptrEnabled:this.ptrEnabled}})}}))}}return(e=CoreSitePluginsNewContentDirective).ɵfac=function CoreSitePluginsNewContentDirective_Factory(t){return new(t||e)(c.rXU(c.aKT),c.rXU(g.U,8))},e.ɵdir=c.FsC({type:e,selectors:[["","core-site-plugins-new-content",""]],inputs:{component:"component",method:"method",args:"args",title:"title",samePage:[c.Mj6.HasDecoratorInputTransform,"samePage","samePage",d.G],useOtherData:"useOtherData",form:"form",jsData:"jsData",preSets:"preSets",ptrEnabled:[c.Mj6.HasDecoratorInputTransform,"ptrEnabled","ptrEnabled",d.G]},features:[c.GFd]}),CoreSitePluginsNewContentDirective})(),w=(()=>{var e;class CoreSitePluginsDirectivesModule{}return(e=CoreSitePluginsDirectivesModule).ɵfac=function CoreSitePluginsDirectivesModule_Factory(t){return new(t||e)},e.ɵmod=c.$C({type:e}),e.ɵinj=c.G2t({}),CoreSitePluginsDirectivesModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&c.Obh(w,{declarations:[m,D,P,O],exports:[m,D,P,O]}))}}]);