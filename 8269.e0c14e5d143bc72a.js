"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8269],{6784:(e,r,o)=>{o.r(r),o.d(r,{default:()=>j});var t=o(3353),a=o(10467),s=o(16179),n=o(25124),c=o(10883),i=o(44682),d=o(45155),l=o(89014),u=o(22693),h=o(15324),m=o(52749),_=o(89911),g=o(8014),p=o(81690),f=o(79555),M=o(55554),S=o(54438),b=o(60177),F=o(16986),y=o(66198),I=o(86198),A=o(58197),v=o(88246),P=o(73465),T=o(75357),R=o(4193),C=o(73955);const _c0=e=>({$a:e});function AddonModForumSearchPage_h1_6_Template(e,r){if(1&e&&(S.j41(0,"h1"),S.EFF(1),S.k0s()),2&e){const e=S.XpG();S.R7$(),S.JRh(e.forum.name)}}function AddonModForumSearchPage_h1_7_Template(e,r){1&e&&(S.j41(0,"h1"),S.EFF(1),S.nI1(2,"translate"),S.k0s()),2&e&&(S.R7$(),S.JRh(S.bMT(2,1,"addon.block_searchforums.pluginname")))}function AddonModForumSearchPage_ion_card_10_Template(e,r){if(1&e&&(S.j41(0,"ion-card",8)(1,"ion-item",9),S.nrm(2,"ion-icon",10),S.j41(3,"ion-label"),S.nrm(4,"core-format-text",1),S.k0s()()()),2&e){const e=S.XpG();S.R7$(4),S.Y8G("text",e.searchBanner)}}function AddonModForumSearchPage_ion_list_14_core_search_global_search_result_1_Template(e,r){if(1&e){const e=S.RV6();S.j41(0,"core-search-global-search-result",12),S.bIt("onClick",(function AddonModForumSearchPage_ion_list_14_core_search_global_search_result_1_Template_core_search_global_search_result_onClick_0_listener(){const r=S.eBV(e).$implicit,o=S.XpG(2);return S.Njj(o.visitResult(r))})),S.k0s()}if(2&e){S.Y8G("result",r.$implicit)("showCourse",!1)}}function AddonModForumSearchPage_ion_list_14_Template(e,r){if(1&e&&(S.j41(0,"ion-list"),S.DNE(1,AddonModForumSearchPage_ion_list_14_core_search_global_search_result_1_Template,1,2,"core-search-global-search-result",11),S.k0s()),2&e){const e=S.XpG();S.R7$(),S.Y8G("ngForOf",e.resultsSource.getItems())}}function AddonModForumSearchPage_core_empty_box_16_p_1_Template(e,r){1&e&&(S.j41(0,"p"),S.EFF(1),S.nI1(2,"translate"),S.k0s()),2&e&&(S.R7$(),S.JRh(S.bMT(2,1,"core.search.empty")))}function AddonModForumSearchPage_core_empty_box_16_ng_container_2_Template(e,r){if(1&e&&(S.qex(0),S.j41(1,"p")(2,"strong"),S.EFF(3),S.nI1(4,"translate"),S.k0s()(),S.j41(5,"p")(6,"small"),S.EFF(7),S.nI1(8,"translate"),S.k0s()(),S.bVm()),2&e){const e=S.XpG(2);S.R7$(3),S.JRh(S.i5U(4,2,"core.search.noresults",S.eq3(7,_c0,e.resultsSource.getQuery()))),S.R7$(4),S.JRh(S.bMT(8,5,"core.search.noresultshelp"))}}function AddonModForumSearchPage_core_empty_box_16_Template(e,r){if(1&e&&(S.j41(0,"core-empty-box",13),S.DNE(1,AddonModForumSearchPage_core_empty_box_16_p_1_Template,3,3,"p",2)(2,AddonModForumSearchPage_core_empty_box_16_ng_container_2_Template,9,9,"ng-container",2),S.k0s()),2&e){const e=S.XpG();S.Y8G("dimmed",!e.resultsSource.isLoaded()),S.R7$(),S.Y8G("ngIf",!e.resultsSource.isLoaded()),S.R7$(),S.Y8G("ngIf",e.resultsSource.isLoaded())}}let k=(()=>{var e;class AddonModForumSearchPage{constructor(){this.loadMoreError=!1,this.searchBanner=null,this.resultsSource=new d.u("",{}),this.ready=new n._}ngOnInit(){var e=this;return(0,a.A)((function*(){try{var r,o,t;const a=m.CoreSites.getRequiredCurrentSite(),n=null!==(r=null===(o=a.config)||void 0===o||null===(o=o.searchbanner)||void 0===o?void 0:o.trim())&&void 0!==r?r:"",c=h.CoreNavigator.getRequiredRouteNumberParam("courseId"),d=h.CoreNavigator.getRouteNumberParam("forumId"),l={courseIds:[c]};if(p.j.isTrueOrOne(null===(t=a.config)||void 0===t?void 0:t.searchbannerenable)&&n.length>0&&(e.searchBanner=n),d){e.forum=yield s.AddonModForum.getForumById(c,d);const r=yield i.CoreCourse.getModule(e.forum.cmid,c);l.searchAreaIds=["mod_forum-post"],r.contextid&&(l.contextIds=[r.contextid]),e.searchAreaId=`AddonModForumSearch-${c}-${e.forum.id}`}else l.searchAreaIds=["mod_forum-activity","mod_forum-post"],e.searchAreaId=`AddonModForumSearch-${c}`;e.resultsSource.setFilters(l),e.ready.resolve()}catch(e){return _.CoreDomUtils.showErrorModal(e),h.CoreNavigator.back(),void 0}}))()}search(e){var r=this;return(0,a.A)((function*(){yield r.ready,r.resultsSource.setQuery(e),r.resultsSource.hasEmptyQuery()||(yield _.CoreDomUtils.showOperationModals("core.searching",!0,(0,a.A)((function*(){yield r.resultsSource.reload(),yield M.g.ignoreErrors(l.CoreSearchGlobalSearch.logViewResults(r.resultsSource.getQuery(),r.resultsSource.getFilters())),u.OF.logEvent({type:u.qr.VIEW_ITEM_LIST,ws:"core_search_view_results",name:f.HT.instant("core.search.globalsearch"),data:{query:e,filters:JSON.stringify(r.resultsSource.getFilters())},url:g.F.addParamsToUrl("/search/index.php",{q:e})})}))))}))()}clearSearch(){this.loadMoreError=!1,this.resultsSource.setQuery(""),this.resultsSource.reset()}visitResult(e){return(0,a.A)((function*(){yield c.CoreContentLinksHelper.handleLink(e.url)}))()}loadMoreResults(e){var r=this;return(0,a.A)((function*(){try{var o;yield null===(o=r.resultsSource)||void 0===o?void 0:o.load()}catch(e){r.loadMoreError=!0}finally{e()}}))()}}return(e=AddonModForumSearchPage).ɵfac=function AddonModForumSearchPage_Factory(r){return new(r||e)},e.ɵcmp=S.VBU({type:e,selectors:[["page-addon-mod-forum-search"]],decls:17,vars:18,consts:[["slot","start"],[3,"text"],[4,"ngIf"],[1,"limited-width"],["class","core-danger-card",4,"ngIf"],[3,"onSubmit","onClear","placeholder","searchLabel","autoFocus","searchArea"],[3,"action","enabled","error"],["icon","fas-magnifying-glass","role","alert",3,"dimmed",4,"ngIf"],[1,"core-danger-card"],[1,"ion-text-wrap"],["name","fas-triangle-exclamation","slot","start","aria-hidden","true"],[3,"result","showCourse","onClick",4,"ngFor","ngForOf"],[3,"onClick","result","showCourse"],["icon","fas-magnifying-glass","role","alert",3,"dimmed"]],template:function AddonModForumSearchPage_Template(e,r){1&e&&(S.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),S.nrm(3,"ion-back-button",1),S.nI1(4,"translate"),S.k0s(),S.j41(5,"ion-title"),S.DNE(6,AddonModForumSearchPage_h1_6_Template,2,1,"h1",2)(7,AddonModForumSearchPage_h1_7_Template,3,3,"h1",2),S.k0s()()(),S.j41(8,"ion-content",3)(9,"div"),S.DNE(10,AddonModForumSearchPage_ion_card_10_Template,5,1,"ion-card",4),S.j41(11,"core-search-box",5),S.nI1(12,"translate"),S.nI1(13,"translate"),S.bIt("onSubmit",(function AddonModForumSearchPage_Template_core_search_box_onSubmit_11_listener(e){return r.search(e)}))("onClear",(function AddonModForumSearchPage_Template_core_search_box_onClear_11_listener(){return r.clearSearch()})),S.k0s(),S.DNE(14,AddonModForumSearchPage_ion_list_14_Template,2,1,"ion-list",2),S.j41(15,"core-infinite-loading",6),S.bIt("action",(function AddonModForumSearchPage_Template_core_infinite_loading_action_15_listener(e){return r.loadMoreResults(e)})),S.k0s(),S.DNE(16,AddonModForumSearchPage_core_empty_box_16_Template,3,3,"core-empty-box",7),S.k0s()()),2&e&&(S.R7$(3),S.Y8G("text",S.bMT(4,12,"core.back")),S.R7$(3),S.Y8G("ngIf",r.forum),S.R7$(),S.Y8G("ngIf",!r.forum),S.R7$(3),S.Y8G("ngIf",r.searchBanner),S.R7$(),S.Y8G("placeholder",S.bMT(12,14,"core.search"))("searchLabel",S.bMT(13,16,"core.search"))("autoFocus",!0)("searchArea",r.searchAreaId),S.R7$(3),S.Y8G("ngIf",r.resultsSource.isLoaded()),S.R7$(),S.Y8G("enabled",r.resultsSource.isLoaded()&&!r.resultsSource.isCompleted())("error",r.loadMoreError),S.R7$(),S.Y8G("ngIf",r.resultsSource.isEmpty()))},dependencies:[b.Sq,b.bT,F.h,y.b,I.t,A.B,v.i,P.QW,P.b_,P.W9,P.eU,P.iq,P.uz,P.he,P.nf,P.BC,P.ai,P.el,T.M,R.V,C.D9],encapsulation:2}),AddonModForumSearchPage})();var E=o(21182),$=o(47720),x=o(51734);const G=[{path:"",component:k}];let j=(()=>{var e;class AddonModForumSearchLazyModule{}return(e=AddonModForumSearchLazyModule).ɵfac=function AddonModForumSearchLazyModule_Factory(r){return new(r||e)},e.ɵmod=S.$C({type:e}),e.ɵinj=S.G2t({imports:[E.iI.forChild(G),t.n,x._,$.E]}),AddonModForumSearchLazyModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&S.Obh(j,{declarations:[k],imports:[E.iI,t.n,x._,$.E]}))},35716:(e,r,o)=>{o.d(r,{z:()=>CorePaginatedItemsManagerSource});var t=o(10467),a=o(58866);class CorePaginatedItemsManagerSource extends a.i{constructor(){super(...arguments),this.hasMoreItems=!0}isCompleted(){return!this.hasMoreItems}isEmpty(){var e;return!this.isLoaded()||0===(null!==(e=this.getItems())&&void 0!==e?e:[]).length}getPagesLoaded(){if(null===this.items)return 0;const e=this.getPageLength();return null===e?1:Math.ceil(this.items.length/e)}reset(){this.hasMoreItems=!0,super.reset()}reload(){var e=this;return(0,t.A)((function*(){e.dirty=!0,yield e.load()}))()}load(){var e=this;return(0,t.A)((function*(){var r;if(e.dirty){const{items:r,hasMoreItems:o}=yield e.loadPageItems(0);return e.dirty=!1,e.setItems(r,null!=o&&o),void 0}if(!e.hasMoreItems)return;const{items:o,hasMoreItems:t}=yield e.loadPageItems(e.getPagesLoaded());e.setItems((null!==(r=e.items)&&void 0!==r?r:[]).concat(o),null!=t&&t)}))()}getPageLength(){return null}setItems(e,r=!1){this.hasMoreItems=r,super.setItems(e)}}}}]);