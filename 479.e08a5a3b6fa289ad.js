"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[479],{20479:(e,a,t)=>{t.r(a),t.d(a,{default:()=>F});var n=t(21182),s=t(94114),o=t(93417),d=t(3353),r=t(85729),i=t(10467),g=t(70548),l=t(16474),c=t(89911),_=t(52749),u=t(55554),m=t(29492),p=t(15324),b=t(2401),f=t(57648),h=t(83696),B=t(22693),I=t(24742),y=t(79555),U=t(54438),T=t(60177),A=t(16986),R=t(64422),v=t(10892),k=t(88246),C=t(73465),w=t(59528),M=t(73955);function AddonBadgesUserBadgesPage_core_empty_box_15_Template(e,a){1&e&&(U.nrm(0,"core-empty-box",7),U.nI1(1,"translate")),2&e&&U.Y8G("message",U.bMT(1,1,"addon.badges.nobadges"))}function AddonBadgesUserBadgesPage_ion_list_16_ion_item_1_ion_badge_9_Template(e,a){1&e&&(U.j41(0,"ion-badge",14),U.EFF(1),U.nI1(2,"translate"),U.k0s()),2&e&&(U.R7$(),U.SpI(" ",U.bMT(2,1,"addon.badges.expired")," "))}function AddonBadgesUserBadgesPage_ion_list_16_ion_item_1_Template(e,a){if(1&e){const e=U.RV6();U.j41(0,"ion-item",10),U.bIt("click",(function AddonBadgesUserBadgesPage_ion_list_16_ion_item_1_Template_ion_item_click_0_listener(){const a=U.eBV(e).$implicit,t=U.XpG(2);return U.Njj(t.badges.select(a))})),U.j41(1,"ion-avatar",0),U.nrm(2,"img",11),U.k0s(),U.j41(3,"ion-label")(4,"p",12),U.EFF(5),U.k0s(),U.j41(6,"p"),U.EFF(7),U.nI1(8,"coreFormatDate"),U.k0s()(),U.DNE(9,AddonBadgesUserBadgesPage_ion_list_16_ion_item_1_ion_badge_9_Template,3,3,"ion-badge",13),U.k0s()}if(2&e){const e=a.$implicit,t=U.XpG(2);U.Y8G("detail",!0),U.BMQ("aria-label",e.name)("aria-current",t.badges.getItemAriaCurrent(e)),U.R7$(2),U.Y8G("url",e.badgeurl)("alt",e.name),U.R7$(3),U.JRh(e.name),U.R7$(2),U.JRh(U.i5U(8,8,1e3*e.dateissued,"strftimedatetimeshort")),U.R7$(2),U.Y8G("ngIf",e.dateexpire&&t.currentTime>=e.dateexpire)}}function AddonBadgesUserBadgesPage_ion_list_16_Template(e,a){if(1&e&&(U.j41(0,"ion-list",8),U.DNE(1,AddonBadgesUserBadgesPage_ion_list_16_ion_item_1_Template,10,11,"ion-item",9),U.k0s()),2&e){const e=U.XpG();U.R7$(),U.Y8G("ngForOf",e.badges.items)}}let P=(()=>{var e;class AddonBadgesUserBadgesPage{constructor(){var e,a;this.currentTime=0;let t=null!==(e=p.CoreNavigator.getRouteNumberParam("courseId"))&&void 0!==e?e:0;const n=null!==(a=p.CoreNavigator.getRouteNumberParam("userId"))&&void 0!==a?a:_.CoreSites.getCurrentSiteUserId();t===_.CoreSites.getCurrentSiteHomeId()&&(t=0),this.badges=new b.R(h.u.getOrCreateSource(f.j,[t,n]),AddonBadgesUserBadgesPage),this.logView=I.j.once((()=>{B.OF.logEvent({type:B.qr.VIEW_ITEM_LIST,ws:"core_badges_view_user_badges",name:y.HT.instant("addon.badges.badges"),data:{courseId:this.badges.getSource().COURSE_ID,category:"badges"},url:"/badges/mybadges.php"})}))}ngAfterViewInit(){var e=this;return(0,i.A)((function*(){yield e.fetchInitialBadges(),e.badges.start(e.splitView)}))()}ngOnDestroy(){this.badges.destroy()}refreshBadges(e){var a=this;return(0,i.A)((function*(){yield u.g.ignoreErrors(g.AddonBadges.invalidateUserBadges(a.badges.getSource().COURSE_ID,a.badges.getSource().USER_ID)),yield u.g.ignoreErrors(a.badges.reload()),null==e||e.complete()}))()}fetchInitialBadges(){var e=this;return(0,i.A)((function*(){e.currentTime=l.CoreTimeUtils.timestamp();try{yield e.badges.reload(),e.logView()}catch(a){c.CoreDomUtils.showErrorModalDefault(a,"Error loading badges"),e.badges.reset()}}))()}}return(e=AddonBadgesUserBadgesPage).ɵfac=function AddonBadgesUserBadgesPage_Factory(a){return new(a||e)},e.ɵcmp=U.VBU({type:e,selectors:[["page-addon-badges-user-badges"]],viewQuery:function AddonBadgesUserBadgesPage_Query(e,a){if(1&e&&U.GBs(m.M,5),2&e){let e;U.mGM(e=U.lsd())&&(a.splitView=e.first)}},decls:17,vars:13,consts:[["slot","start"],[3,"text"],["slot","fixed",3,"ionRefresh","disabled"],[3,"pullingText"],[3,"hideUntil"],["icon","fas-trophy",3,"message",4,"ngIf"],["class","ion-no-margin",4,"ngIf"],["icon","fas-trophy",3,"message"],[1,"ion-no-margin"],["button","","class","ion-text-wrap",3,"detail","click",4,"ngFor","ngForOf"],["button","",1,"ion-text-wrap",3,"click","detail"],["core-external-content","",3,"url","alt"],[1,"item-heading"],["slot","end","color","danger",4,"ngIf"],["slot","end","color","danger"]],template:function AddonBadgesUserBadgesPage_Template(e,a){1&e&&(U.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),U.nrm(3,"ion-back-button",1),U.nI1(4,"translate"),U.k0s(),U.j41(5,"ion-title")(6,"h1"),U.EFF(7),U.nI1(8,"translate"),U.k0s()()()(),U.j41(9,"ion-content")(10,"core-split-view")(11,"ion-refresher",2),U.bIt("ionRefresh",(function AddonBadgesUserBadgesPage_Template_ion_refresher_ionRefresh_11_listener(e){return a.refreshBadges(e.target)})),U.nrm(12,"ion-refresher-content",3),U.nI1(13,"translate"),U.k0s(),U.j41(14,"core-loading",4),U.DNE(15,AddonBadgesUserBadgesPage_core_empty_box_15_Template,2,3,"core-empty-box",5)(16,AddonBadgesUserBadgesPage_ion_list_16_Template,2,1,"ion-list",6),U.k0s()()()),2&e&&(U.R7$(3),U.Y8G("text",U.bMT(4,7,"core.back")),U.R7$(4),U.JRh(U.bMT(8,9,"addon.badges.badges")),U.R7$(4),U.Y8G("disabled",!a.badges.loaded),U.R7$(),U.FS9("pullingText",U.bMT(13,11,"core.pulltorefresh")),U.R7$(2),U.Y8G("hideUntil",a.badges.loaded),U.R7$(),U.Y8G("ngIf",a.badges.empty),U.R7$(),U.Y8G("ngIf",!a.badges.empty))},dependencies:[T.Sq,T.bT,A.h,R.R,m.M,v.l,k.i,C.mC,C.In,C.QW,C.W9,C.eU,C.uz,C.he,C.nf,C.To,C.Ki,C.BC,C.ai,C.el,w.f,M.D9],encapsulation:2}),AddonBadgesUserBadgesPage})();const S=[{path:"",component:P,children:[{path:":badgeHash",component:r.e,data:{usesSwipeNavigation:!0}}]}],E=[...(0,s.VI)([{path:"",pathMatch:"full",component:P},{path:":badgeHash",component:r.e,data:{usesSwipeNavigation:!0}}],(()=>o.CoreScreen.isMobile)),...(0,s.VI)(S,(()=>o.CoreScreen.isTablet))];let F=(()=>{var e;class AddonBadgesLazyModule{}return(e=AddonBadgesLazyModule).ɵfac=function AddonBadgesLazyModule_Factory(a){return new(a||e)},e.ɵmod=U.$C({type:e}),e.ɵinj=U.G2t({imports:[n.iI.forChild(E),d.n]}),AddonBadgesLazyModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&U.Obh(F,{declarations:[P],imports:[n.iI,d.n]}))}}]);