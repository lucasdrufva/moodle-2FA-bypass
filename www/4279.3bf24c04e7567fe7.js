"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4279],{14279:(e,n,o)=>{o.r(n),o.d(n,{AddonModChoiceIndexComponent:()=>F});var i=o(10467),t=o(75629),d=o(69006),c=o(52749),a=o(89911),s=o(16474),_=o(79555),l=o(49882),r=o(11793),p=o(68511),m=o(7265),h=o(77401),u=o(72890),f=o(23780),g=o(54438),I=o(73465),C=o(51024),x=o(60177),b=o(47222),M=o(69502),T=o(17388),w=o(64422),R=o(13988),A=o(16658),v=o(86198),k=o(58197),G=o(37557),$=o(66731),y=o(43570),j=o(89417),E=o(6736),O=o(30864),Y=o(73955);const _c0=e=>({option:e}),_c1=e=>({$a:e});function AddonModChoiceIndexComponent_Conditional_1_Template(e,n){if(1&e){const e=g.RV6();g.j41(0,"ion-button",8),g.nI1(1,"translate"),g.bIt("click",(function AddonModChoiceIndexComponent_Conditional_1_Template_ion_button_click_0_listener(){g.eBV(e);const n=g.XpG();return g.Njj(n.openModuleSummary())})),g.nrm(2,"ion-icon",9),g.k0s()}2&e&&g.Y8G("ariaLabel",g.bMT(1,1,"core.info"))}function AddonModChoiceIndexComponent_Conditional_2_Template(e,n){if(1&e){const e=g.RV6();g.j41(0,"core-context-menu")(1,"core-context-menu-item",10),g.nI1(2,"translate"),g.bIt("action",(function AddonModChoiceIndexComponent_Conditional_2_Template_core_context_menu_item_action_1_listener(){g.eBV(e);const n=g.XpG();return g.Njj(n.openModuleSummary())})),g.k0s()()}2&e&&(g.R7$(),g.Y8G("priority",5e3)("content",g.bMT(2,2,"core.info")))}function AddonModChoiceIndexComponent_ion_card_5_Template(e,n){1&e&&(g.j41(0,"ion-card",11)(1,"ion-item"),g.nrm(2,"ion-icon",12),g.j41(3,"ion-label")(4,"p"),g.EFF(5),g.nI1(6,"translate"),g.k0s()()()()),2&e&&(g.R7$(5),g.JRh(g.bMT(6,1,"addon.mod_choice.previewing")))}function AddonModChoiceIndexComponent_ion_card_6_Template(e,n){if(1&e&&(g.j41(0,"ion-card",11)(1,"ion-item"),g.nrm(2,"ion-icon",12),g.j41(3,"ion-label"),g.EFF(4),g.nI1(5,"translate"),g.k0s()()()),2&e){const e=g.XpG();g.R7$(4),g.JRh(g.bMT(5,1,e.publishInfo))}}function AddonModChoiceIndexComponent_ion_card_7_ng_container_1_ion_item_1_ng_container_2_Template(e,n){1&e&&g.eu8(0)}function AddonModChoiceIndexComponent_ion_card_7_ng_container_1_ion_item_1_Template(e,n){if(1&e){const e=g.RV6();g.j41(0,"ion-item",15)(1,"ion-checkbox",16),g.mxI("ngModelChange",(function AddonModChoiceIndexComponent_ion_card_7_ng_container_1_ion_item_1_Template_ion_checkbox_ngModelChange_1_listener(n){const o=g.eBV(e).$implicit;return g.DH7(o.checked,n)||(o.checked=n),g.Njj(n)})),g.DNE(2,AddonModChoiceIndexComponent_ion_card_7_ng_container_1_ion_item_1_ng_container_2_Template,1,0,"ng-container",17),g.k0s()()}if(2&e){const e=n.$implicit,o=g.XpG(3),i=g.sdS(13);g.R7$(),g.R50("ngModel",e.checked),g.Y8G("disabled",e.disabled||o.showPreview),g.R7$(),g.Y8G("ngTemplateOutlet",i)("ngTemplateOutletContext",g.eq3(4,_c0,e))}}function AddonModChoiceIndexComponent_ion_card_7_ng_container_1_Template(e,n){if(1&e&&(g.qex(0),g.DNE(1,AddonModChoiceIndexComponent_ion_card_7_ng_container_1_ion_item_1_Template,3,6,"ion-item",14),g.bVm()),2&e){const e=g.XpG(2);g.R7$(),g.Y8G("ngForOf",e.options)}}function AddonModChoiceIndexComponent_ion_card_7_ion_radio_group_2_ion_item_1_ng_container_2_Template(e,n){1&e&&g.eu8(0)}function AddonModChoiceIndexComponent_ion_card_7_ion_radio_group_2_ion_item_1_Template(e,n){if(1&e&&(g.j41(0,"ion-item",15)(1,"ion-radio",19),g.DNE(2,AddonModChoiceIndexComponent_ion_card_7_ion_radio_group_2_ion_item_1_ng_container_2_Template,1,0,"ng-container",17),g.k0s()()),2&e){const e=n.$implicit,o=g.XpG(3),i=g.sdS(13);g.R7$(),g.Y8G("value",e.id)("disabled",e.disabled||o.showPreview),g.R7$(),g.Y8G("ngTemplateOutlet",i)("ngTemplateOutletContext",g.eq3(4,_c0,e))}}function AddonModChoiceIndexComponent_ion_card_7_ion_radio_group_2_Template(e,n){if(1&e){const e=g.RV6();g.j41(0,"ion-radio-group",18),g.mxI("ngModelChange",(function AddonModChoiceIndexComponent_ion_card_7_ion_radio_group_2_Template_ion_radio_group_ngModelChange_0_listener(n){g.eBV(e);const o=g.XpG(2);return g.DH7(o.selectedOption.id,n)||(o.selectedOption.id=n),g.Njj(n)})),g.DNE(1,AddonModChoiceIndexComponent_ion_card_7_ion_radio_group_2_ion_item_1_Template,3,6,"ion-item",14),g.k0s()}if(2&e){const e=g.XpG(2);g.R50("ngModel",e.selectedOption.id),g.R7$(),g.Y8G("ngForOf",e.options)}}function AddonModChoiceIndexComponent_ion_card_7_Template(e,n){if(1&e&&(g.j41(0,"ion-card"),g.DNE(1,AddonModChoiceIndexComponent_ion_card_7_ng_container_1_Template,2,1,"ng-container",6)(2,AddonModChoiceIndexComponent_ion_card_7_ion_radio_group_2_Template,2,2,"ion-radio-group",13),g.k0s()),2&e){const e=g.XpG();g.R7$(),g.Y8G("ngIf",e.choice.allowmultiple),g.R7$(),g.Y8G("ngIf",!e.choice.allowmultiple)}}function AddonModChoiceIndexComponent_ion_card_8_ng_container_6_ion_item_1_Template(e,n){if(1&e&&(g.j41(0,"ion-item",15)(1,"ion-label"),g.nrm(2,"core-format-text",22),g.k0s()()),2&e){const e=g.XpG().$implicit,n=g.XpG(2);g.R7$(2),g.Y8G("text",e.text)("contextInstanceId",n.module.id)("courseId",n.courseId)}}function AddonModChoiceIndexComponent_ion_card_8_ng_container_6_Template(e,n){if(1&e&&(g.qex(0),g.DNE(1,AddonModChoiceIndexComponent_ion_card_8_ng_container_6_ion_item_1_Template,3,3,"ion-item",21),g.bVm()),2&e){const e=n.$implicit;g.R7$(),g.Y8G("ngIf",e.checked)}}function AddonModChoiceIndexComponent_ion_card_8_Template(e,n){if(1&e&&(g.j41(0,"ion-card")(1,"ion-item-divider")(2,"ion-label")(3,"h2"),g.EFF(4),g.nI1(5,"translate"),g.k0s()()(),g.DNE(6,AddonModChoiceIndexComponent_ion_card_8_ng_container_6_Template,2,1,"ng-container",20),g.k0s()),2&e){const e=g.XpG();g.R7$(4),g.JRh(g.bMT(5,2,"addon.mod_choice.yourselection")),g.R7$(2),g.Y8G("ngForOf",e.options)}}function AddonModChoiceIndexComponent_ng_container_9_ion_item_9_Template(e,n){1&e&&(g.j41(0,"ion-item",28),g.nrm(1,"ion-icon",29),g.j41(2,"ion-label"),g.EFF(3),g.nI1(4,"translate"),g.k0s()()),2&e&&(g.R7$(3),g.JRh(g.bMT(4,1,"addon.mod_choice.resultsnotsynced")))}function AddonModChoiceIndexComponent_ng_container_9_ion_col_13_ion_item_group_1_p_11_Template(e,n){if(1&e&&(g.j41(0,"p"),g.EFF(1),g.nI1(2,"translate"),g.k0s()),2&e){const e=g.XpG().$implicit;g.R7$(),g.SpI(" ",g.i5U(2,1,"addon.mod_choice.limita",g.eq3(4,_c1,e.maxanswer))," ")}}function AddonModChoiceIndexComponent_ng_container_9_ion_col_13_ion_item_group_1_ng_container_12_ion_item_1_Template(e,n){if(1&e&&(g.j41(0,"ion-item",35),g.nrm(1,"core-user-avatar",36),g.j41(2,"ion-label")(3,"p"),g.EFF(4),g.k0s()()()),2&e){const e=n.$implicit,o=g.XpG(5);g.Y8G("courseId",o.courseId)("userId",e.userid),g.BMQ("aria-label",e.fullname),g.R7$(),g.Y8G("user",e)("courseId",o.courseId)("linkProfile",!1),g.R7$(3),g.JRh(e.fullname)}}function AddonModChoiceIndexComponent_ng_container_9_ion_col_13_ion_item_group_1_ng_container_12_Template(e,n){if(1&e&&(g.qex(0),g.DNE(1,AddonModChoiceIndexComponent_ng_container_9_ion_col_13_ion_item_group_1_ng_container_12_ion_item_1_Template,5,7,"ion-item",34),g.bVm()),2&e){const e=g.XpG().$implicit;g.R7$(),g.Y8G("ngForOf",e.userresponses)}}function AddonModChoiceIndexComponent_ng_container_9_ion_col_13_ion_item_group_1_Template(e,n){if(1&e){const e=g.RV6();g.j41(0,"ion-item-group")(1,"ion-item",31),g.nI1(2,"translate"),g.bIt("click",(function AddonModChoiceIndexComponent_ng_container_9_ion_col_13_ion_item_group_1_Template_ion_item_click_1_listener(){const n=g.eBV(e).$implicit,o=g.XpG(3);return g.Njj(o.toggle(n))})),g.nrm(3,"ion-icon",32),g.j41(4,"ion-label")(5,"h3",33),g.nrm(6,"core-format-text",22),g.k0s(),g.j41(7,"p"),g.EFF(8),g.nI1(9,"translate"),g.nI1(10,"translate"),g.k0s(),g.DNE(11,AddonModChoiceIndexComponent_ng_container_9_ion_col_13_ion_item_group_1_p_11_Template,3,6,"p",6),g.k0s()(),g.DNE(12,AddonModChoiceIndexComponent_ng_container_9_ion_col_13_ion_item_group_1_ng_container_12_Template,2,1,"ng-container",6),g.k0s()}if(2&e){const e=n.$implicit,o=g.XpG(3);g.R7$(),g.Y8G("button",e.numberofuser>0)("detail",!1),g.BMQ("aria-label",g.bMT(2,14,e.expanded?"core.collapse":"core.expand")),g.R7$(2),g.AVh("expandable-status-icon-expanded",e.expanded),g.Y8G("name",e.numberofuser>0?"fas-chevron-right":""),g.R7$(3),g.Y8G("text",e.text)("contextInstanceId",o.module.id)("courseId",o.courseId),g.R7$(2),g.E5c(" ",g.bMT(9,16,"addon.mod_choice.numberofuser"),": ",e.numberofuser," (",g.i5U(10,18,"core.percentagenumber",g.eq3(21,_c1,e.percentageamountfixed)),") "),g.R7$(3),g.Y8G("ngIf",o.choice.limitanswers&&o.choice.showavailable),g.R7$(),g.Y8G("ngIf",e.expanded)}}function AddonModChoiceIndexComponent_ng_container_9_ion_col_13_Template(e,n){if(1&e&&(g.j41(0,"ion-col",30),g.DNE(1,AddonModChoiceIndexComponent_ng_container_9_ion_col_13_ion_item_group_1_Template,13,23,"ion-item-group",20),g.k0s()),2&e){const e=g.XpG(2);g.R7$(),g.Y8G("ngForOf",e.results)}}function AddonModChoiceIndexComponent_ng_container_9_Template(e,n){if(1&e&&(g.qex(0),g.j41(1,"ion-item-divider")(2,"ion-label")(3,"h2"),g.EFF(4),g.nI1(5,"translate"),g.k0s()()(),g.j41(6,"ion-grid",23)(7,"ion-row")(8,"ion-col",24),g.DNE(9,AddonModChoiceIndexComponent_ng_container_9_ion_item_9_Template,5,3,"ion-item",25),g.j41(10,"ion-item")(11,"ion-label"),g.nrm(12,"core-chart",26),g.k0s()()(),g.DNE(13,AddonModChoiceIndexComponent_ng_container_9_ion_col_13_Template,2,1,"ion-col",27),g.k0s()(),g.bVm()),2&e){const e=g.XpG();g.R7$(4),g.JRh(g.bMT(5,7,"addon.mod_choice.responses")),g.R7$(5),g.Y8G("ngIf",e.hasOffline),g.R7$(3),g.Y8G("data",e.data)("labels",e.labels)("contextInstanceId",e.module.id)("courseId",e.courseId),g.R7$(),g.Y8G("ngIf",e.choice.publish&&e.results)}}function AddonModChoiceIndexComponent_ion_card_10_Template(e,n){1&e&&(g.j41(0,"ion-card",11)(1,"ion-item"),g.nrm(2,"ion-icon",12),g.j41(3,"ion-label")(4,"p"),g.EFF(5),g.nI1(6,"translate"),g.k0s()()()()),2&e&&(g.R7$(5),g.JRh(g.bMT(6,1,"addon.mod_choice.noresultsviewable")))}function AddonModChoiceIndexComponent_div_11_div_1_ion_button_1_Template(e,n){if(1&e){const e=g.RV6();g.j41(0,"ion-button",43),g.bIt("click",(function AddonModChoiceIndexComponent_div_11_div_1_ion_button_1_Template_ion_button_click_0_listener(){g.eBV(e);const n=g.XpG(3);return g.Njj(n.delete())})),g.EFF(1),g.nI1(2,"translate"),g.k0s()}2&e&&(g.R7$(),g.SpI(" ",g.bMT(2,1,"addon.mod_choice.removemychoice")," "))}function AddonModChoiceIndexComponent_div_11_div_1_ion_button_2_Template(e,n){if(1&e){const e=g.RV6();g.j41(0,"ion-button",44),g.bIt("click",(function AddonModChoiceIndexComponent_div_11_div_1_ion_button_2_Template_ion_button_click_0_listener(){g.eBV(e);const n=g.XpG(3);return g.Njj(n.save())})),g.EFF(1),g.nI1(2,"translate"),g.k0s()}if(2&e){const e=g.XpG(3);g.Y8G("disabled",!e.canSave()),g.R7$(),g.SpI(" ",g.bMT(2,2,"addon.mod_choice.savemychoice")," ")}}function AddonModChoiceIndexComponent_div_11_div_1_Template(e,n){if(1&e&&(g.j41(0,"div",40),g.DNE(1,AddonModChoiceIndexComponent_div_11_div_1_ion_button_1_Template,3,3,"ion-button",41)(2,AddonModChoiceIndexComponent_div_11_div_1_ion_button_2_Template,3,4,"ion-button",42),g.k0s()),2&e){const e=g.XpG(2);g.R7$(),g.Y8G("ngIf",e.canDelete),g.R7$(),g.Y8G("ngIf",e.canEdit)}}function AddonModChoiceIndexComponent_div_11_Template(e,n){if(1&e&&(g.j41(0,"div",37),g.DNE(1,AddonModChoiceIndexComponent_div_11_div_1_Template,3,2,"div",38),g.nrm(2,"core-course-module-navigation",39),g.k0s()),2&e){const e=g.XpG();g.R7$(),g.Y8G("ngIf",e.options.length&&e.choice&&(e.canEdit||e.canDelete)),g.R7$(),g.Y8G("courseId",e.courseId)("currentModuleId",e.module.id)}}function AddonModChoiceIndexComponent_ng_template_12_span_2_Template(e,n){1&e&&(g.j41(0,"span"),g.EFF(1),g.nI1(2,"translate"),g.k0s()),2&e&&(g.R7$(),g.SpI(" ",g.bMT(2,1,"addon.mod_choice.full")," "))}function AddonModChoiceIndexComponent_ng_template_12_ng_container_3_Template(e,n){if(1&e&&(g.qex(0),g.j41(1,"p"),g.EFF(2),g.nI1(3,"translate"),g.k0s(),g.j41(4,"p"),g.EFF(5),g.nI1(6,"translate"),g.k0s(),g.bVm()),2&e){const e=g.XpG().option;g.R7$(2),g.JRh(g.i5U(3,2,"addon.mod_choice.responsesa",g.eq3(8,_c1,e.countanswers))),g.R7$(3),g.JRh(g.i5U(6,5,"addon.mod_choice.limita",g.eq3(10,_c1,e.maxanswers)))}}function AddonModChoiceIndexComponent_ng_template_12_Template(e,n){if(1&e&&(g.j41(0,"p",33),g.nrm(1,"core-format-text",22),g.DNE(2,AddonModChoiceIndexComponent_ng_template_12_span_2_Template,3,3,"span",6),g.k0s(),g.DNE(3,AddonModChoiceIndexComponent_ng_template_12_ng_container_3_Template,7,12,"ng-container",6)),2&e){const e=n.option,o=g.XpG();g.R7$(),g.Y8G("text",e.text)("contextInstanceId",o.module.id)("courseId",o.courseId),g.R7$(),g.Y8G("ngIf",o.choice.limitanswers&&e.countanswers>=e.maxanswers),g.R7$(),g.Y8G("ngIf",o.choice.limitanswers&&o.choice.showavailable)}}let F=(()=>{var e;class AddonModChoiceIndexComponent extends d.y{constructor(e,n){super("AddonModChoiceIndexComponent",e,n),this.content=e,this.component=u.yw,this.pluginName="choice",this.options=[],this.selectedOption={id:-1},this.showPreview=!1,this.showResultsMessage=!1,this.canEdit=!1,this.canDelete=!1,this.canSeeResults=!1,this.data=[],this.labels=[],this.results=[],this.syncEventName=u.zp,this.hasAnsweredOnline=!1,this.now=s.CoreTimeUtils.timestamp()}ngOnInit(){var _superprop_getNgOnInit=()=>super.ngOnInit,e=this;return(0,i.A)((function*(){_superprop_getNgOnInit().call(e),e.userId=c.CoreSites.getCurrentSiteUserId(),yield e.loadContent(!1,!0)}))()}invalidateContent(){var e=this;return(0,i.A)((function*(){const n=[];n.push(r.u.invalidateChoiceData(e.courseId)),e.choice&&(n.push(r.u.invalidateOptions(e.choice.id)),n.push(r.u.invalidateResults(e.choice.id))),yield Promise.all(n)}))()}isRefreshSyncNeeded(e){var n;return!(!this.choice||e.choiceId!=this.choice.id||e.userId!=this.userId)&&(null===(n=this.content)||void 0===n||n.scrollToTop(),!0)}fetchContent(e,n=!1,o=!1){var t=this;return(0,i.A)((function*(){if(t.now=s.CoreTimeUtils.timestamp(),t.choice=yield r.u.getChoice(t.courseId,t.module.id),n){(yield t.syncActivity(o))&&(t.choice=yield r.u.getChoice(t.courseId,t.module.id))}t.description=t.choice.intro,t.dataRetrieved.emit(t.choice),t.hasOffline=yield p.R.hasResponse(t.choice.id),yield t.fetchOptions(t.choice),yield t.fetchResults(t.choice)}))()}fetchOptions(e){var n=this;return(0,i.A)((function*(){let o=yield r.u.getOptions(e.id,{cmId:n.module.id});n.hasAnsweredOnline=o.some((e=>e.checked)),n.hasOffline&&(o=yield n.getOfflineResponses(e,o));const i=r.u.choiceHasBeenOpened(e,n.now)&&!r.u.choiceHasBeenClosed(e,n.now);n.selectedOption={id:-1};const t=o.some((o=>!!o.checked&&(e.allowmultiple||(n.selectedOption.id=o.id),!0)));n.canEdit=i&&(!!e.allowupdate||!t),n.canDelete=i&&!!e.allowupdate&&t,n.options=o,n.setPublishInfo(e,t)}))()}setPublishInfo(e,n){const o=!r.u.choiceHasBeenOpened(e,this.now)&&!r.u.choiceHasBeenClosed(e,this.now);if(!e.allowupdate&&n||!o)return this.showPreview=!1,this.showResultsMessage=!0,this.publishInfo="",void 0;switch(this.showResultsMessage=!1,this.showPreview=!!e.showpreview,e.showresults){case 0:this.publishInfo="addon.mod_choice.publishinfonever";break;case 1:this.publishInfo=e.publish===u.MO?"addon.mod_choice.publishinfoanonafter":"addon.mod_choice.publishinfofullafter";break;case 2:this.publishInfo=e.publish===u.MO?"addon.mod_choice.publishinfoanonclose":"addon.mod_choice.publishinfofullclose";break;default:this.publishInfo=""}}getOfflineResponses(e,n){return(0,i.A)((function*(){const o=yield p.R.getResponse(e.id),i={};return n.forEach((e=>{i[e.id]=e})),o.deleting?o.responses.length>0?o.responses.forEach((e=>{i[e]&&i[e].checked&&(i[e].checked=!1,i[e].countanswers--)})):Object.keys(i).forEach((e=>{i[e].checked&&(i[e].checked=!1,i[e].countanswers--)})):(Object.keys(i).forEach((e=>{i[e].checked&&(i[e].checked=!1,i[e].countanswers--)})),o.responses.forEach((e=>{i[e]&&(i[e].checked=!0,i[e].countanswers++)}))),Object.keys(i).map((e=>i[e]))}))()}fetchResults(e){var n=this;return(0,i.A)((function*(){if(!r.u.choiceHasBeenOpened(e,n.now))return n.canSeeResults=!1,void 0;const o=yield r.u.getResults(e.id,{cmId:n.module.id});let i=!1;n.data=[],n.labels=[],n.results=o.map((e=>(e.numberofuser>0&&(i=!0),n.data.push(e.numberofuser),n.labels.push(e.text),Object.assign(e,{percentageamountfixed:e.percentageamount.toFixed(1)})))),n.canSeeResults=i||r.u.canStudentSeeResults(e,n.hasAnsweredOnline,n.now)}))()}logActivity(){var e=this;return(0,i.A)((function*(){e.choice&&(yield r.u.logView(e.choice.id),e.analyticsLogEvent("mod_choice_view_choice"))}))()}canSave(){return!!this.choice&&(this.choice.allowmultiple?this.options.some((e=>e.checked)):-1!==this.selectedOption.id)}save(){var e=this;return(0,i.A)((function*(){if(!e.choice)return;e.choice.allowupdate||(yield a.CoreDomUtils.showConfirm(_.HT.instant("core.areyousure")));const n=[];e.choice.allowmultiple?e.options.forEach((e=>{e.checked&&n.push(e.id)})):n.push(e.selectedOption.id);const o=yield f.CoreLoadings.show("core.sending",!0);try{var i;const o=yield r.u.submitResponse(e.choice.id,e.choice.name,e.courseId,n);null===(i=e.content)||void 0===i||i.scrollToTop(),o&&(l.z.trigger(l.z.ACTIVITY_DATA_SENT,{module:e.moduleName}),e.checkCompletion()),e.analyticsLogEvent("mod_choice_view_choice",{data:{notify:"choicesaved"}}),yield e.dataUpdated(o)}catch(e){a.CoreDomUtils.showErrorModalDefault(e,"addon.mod_choice.cannotsubmit",!0)}finally{o.dismiss()}}))()}delete(){var e=this;return(0,i.A)((function*(){if(!e.choice)return;try{yield a.CoreDomUtils.showDeleteConfirm()}catch{return}const n=yield f.CoreLoadings.show("core.sending",!0);try{var o;yield r.u.deleteResponses(e.choice.id,e.choice.name,e.courseId),null===(o=e.content)||void 0===o||o.scrollToTop(),e.analyticsLogEvent("mod_choice_view_choice",{data:{action:"delchoice"}}),yield e.refreshContent(!1)}catch(e){a.CoreDomUtils.showErrorModalDefault(e,"addon.mod_choice.cannotsubmit",!0)}finally{n.dismiss()}}))()}dataUpdated(e){var n=this;return(0,i.A)((function*(){if(!e||!n.isPrefetched())return n.refreshContent(!1);try{yield m.j.prefetchAfterUpdate(h.D.instance,n.module,n.courseId),n.showLoadingAndFetch(!1,!1)}catch{return n.refreshContent(!1)}}))()}toggle(e){e.expanded=!e.expanded}sync(){if(!this.choice)throw new t.CoreError("Cannot sync without a choice.");return m.j.syncChoice(this.choice.id,this.userId)}}return(e=AddonModChoiceIndexComponent).ɵfac=function AddonModChoiceIndexComponent_Factory(n){return new(n||e)(g.rXU(I.W9),g.rXU(C.k,8))},e.ɵcmp=g.VBU({type:e,selectors:[["addon-mod-choice-index"]],features:[g.Vt3],decls:14,vars:15,consts:[["optionLabelTemplate",""],["slot","end"],["fill","clear","aria-haspopup","true",3,"ariaLabel"],[3,"hideUntil"],[3,"completionChanged","module","description","component","componentId","courseId","hasDataToSync"],["class","core-info-card",4,"ngIf"],[4,"ngIf"],["collapsible-footer","","slot","fixed",4,"ngIf"],["fill","clear","aria-haspopup","true",3,"click","ariaLabel"],["name","fas-circle-info","slot","icon-only","aria-hidden","true"],["iconAction","fas-circle-info",3,"action","priority","content"],[1,"core-info-card"],["name","fas-circle-info","slot","start","aria-hidden","true"],[3,"ngModel","ngModelChange",4,"ngIf"],["class","ion-text-wrap",4,"ngFor","ngForOf"],[1,"ion-text-wrap"],[3,"ngModelChange","ngModel","disabled"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngModelChange","ngModel"],[3,"value","disabled"],[4,"ngFor","ngForOf"],["class","ion-text-wrap",4,"ngIf"],["contextLevel","module",3,"text","contextInstanceId","courseId"],[1,"ion-no-padding"],["size","12","size-lg","5"],["class","ion-text-wrap core-warning-item",4,"ngIf"],["type","pie","height","300","contextLevel","module",3,"data","labels","contextInstanceId","courseId"],["size","12","size-lg","7",4,"ngIf"],[1,"ion-text-wrap","core-warning-item"],["slot","start","name","fas-triangle-exclamation","color","warning","aria-hidden","true"],["size","12","size-lg","7"],[1,"divider","ion-text-wrap",3,"click","button","detail"],["flip-rtl","","slot","start","aria-hidden","true",1,"expandable-status-icon",3,"name"],[1,"item-heading"],["core-user-link","","class","ion-text-wrap",3,"courseId","userId",4,"ngFor","ngForOf"],["core-user-link","",1,"ion-text-wrap",3,"courseId","userId"],["slot","start",3,"user","courseId","linkProfile"],["collapsible-footer","","slot","fixed"],["class","list-item-limited-width adaptable-buttons-row",4,"ngIf"],[3,"courseId","currentModuleId"],[1,"list-item-limited-width","adaptable-buttons-row"],["expand","block","fill","outline","class","ion-margin ion-text-wrap",3,"click",4,"ngIf"],["expand","block","class","ion-margin ion-text-wrap",3,"disabled","click",4,"ngIf"],["expand","block","fill","outline",1,"ion-margin","ion-text-wrap",3,"click"],["expand","block",1,"ion-margin","ion-text-wrap",3,"click","disabled"]],template:function AddonModChoiceIndexComponent_Template(e,n){if(1&e){const e=g.RV6();g.j41(0,"core-navbar-buttons",1),g.DNE(1,AddonModChoiceIndexComponent_Conditional_1_Template,3,3,"ion-button",2)(2,AddonModChoiceIndexComponent_Conditional_2_Template,3,4),g.k0s(),g.j41(3,"core-loading",3)(4,"core-course-module-info",4),g.bIt("completionChanged",(function AddonModChoiceIndexComponent_Template_core_course_module_info_completionChanged_4_listener(){return g.eBV(e),g.Njj(n.onCompletionChange())})),g.k0s(),g.DNE(5,AddonModChoiceIndexComponent_ion_card_5_Template,7,3,"ion-card",5)(6,AddonModChoiceIndexComponent_ion_card_6_Template,6,3,"ion-card",5)(7,AddonModChoiceIndexComponent_ion_card_7_Template,3,2,"ion-card",6)(8,AddonModChoiceIndexComponent_ion_card_8_Template,7,4,"ion-card",6)(9,AddonModChoiceIndexComponent_ng_container_9_Template,14,9,"ng-container",6)(10,AddonModChoiceIndexComponent_ion_card_10_Template,7,3,"ion-card",5)(11,AddonModChoiceIndexComponent_div_11_Template,3,3,"div",7),g.k0s(),g.DNE(12,AddonModChoiceIndexComponent_ng_template_12_Template,4,5,"ng-template",null,0,g.C5r)}2&e&&(g.R7$(),g.vxM(1,n.courseContentsPage?2:1),g.R7$(2),g.Y8G("hideUntil",!n.showLoading),g.R7$(),g.Y8G("module",n.module)("description",n.description)("component",n.component)("componentId",n.componentId)("courseId",n.courseId)("hasDataToSync",n.hasOffline),g.R7$(),g.Y8G("ngIf",n.showPreview&&n.options.length),g.R7$(),g.Y8G("ngIf",n.publishInfo&&n.options.length),g.R7$(),g.Y8G("ngIf",n.options.length&&n.choice&&(n.canEdit||n.showPreview)),g.R7$(),g.Y8G("ngIf",n.options.length&&n.choice&&!n.canEdit&&!n.showPreview),g.R7$(),g.Y8G("ngIf",n.canSeeResults&&n.choice),g.R7$(),g.Y8G("ngIf",!n.canSeeResults&&n.showResultsMessage),g.R7$(),g.Y8G("ngIf",!n.showLoading))},dependencies:[x.Sq,x.bT,x.T3,b.B,M.B,T.Q,w.R,R.c,A.T,v.t,k.B,G.O,$.i,y.T,j.BC,j.vS,I.Jm,I.b_,I.eY,I.hU,I.lO,I.iq,I.uz,I.Dg,I.jh,I.he,I.KO,I.f0,I.ln,I.hB,I.Je,E.Y,O.Q,Y.D9],encapsulation:2}),AddonModChoiceIndexComponent})()}}]);