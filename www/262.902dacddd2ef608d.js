"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[262],{262:(e,o,n)=>{n.r(o),n.d(o,{CoreBlockSideBlocksComponent:()=>y});var t=n(10467),l=n(79555),i=n(89911),c=n(44682),s=n(63561),r=n(44666),a=n(55554),d=n(50572),k=n(82907),m=n(53794),_=n(3353),p=n(78463),f=n(54438),b=n(60177),u=n(16986),C=n(64422),B=n(86198),h=n(88246),g=n(43570),I=n(73465),v=n(73955);function CoreBlockSideBlocksComponent_ion_list_11_ng_container_1_core_block_1_Template(e,o){if(1&e&&f.nrm(0,"core-block",12),2&e){const e=f.XpG().$implicit,o=f.XpG(2);f.Y8G("block",e)("contextLevel",o.contextLevel)("instanceId",o.instanceId)}}function CoreBlockSideBlocksComponent_ion_list_11_ng_container_1_Template(e,o){if(1&e&&(f.qex(0),f.DNE(1,CoreBlockSideBlocksComponent_ion_list_11_ng_container_1_core_block_1_Template,1,3,"core-block",11),f.bVm()),2&e){const e=o.$implicit;f.R7$(),f.Y8G("ngIf",e.visible)}}function CoreBlockSideBlocksComponent_ion_list_11_Template(e,o){if(1&e&&(f.j41(0,"ion-list"),f.DNE(1,CoreBlockSideBlocksComponent_ion_list_11_ng_container_1_Template,2,1,"ng-container",10),f.k0s()),2&e){const e=f.XpG();f.R7$(),f.Y8G("ngForOf",e.blocks)}}function CoreBlockSideBlocksComponent_core_empty_box_12_Template(e,o){1&e&&(f.nrm(0,"core-empty-box",13),f.nI1(1,"translate")),2&e&&f.Y8G("message",f.bMT(1,1,"core.block.noblocks"))}let y=(()=>{var e;class CoreBlockSideBlocksComponent{constructor(e){this.elementRef=e,this.loaded=!1,this.blocks=[]}ngOnInit(){var e=this;return(0,t.A)((function*(){e.loadContent().finally((()=>{e.loaded=!0,e.focusInitialBlock()}))}))()}invalidateBlocks(){var e=this;return(0,t.A)((function*(){var o;const n=[];n.push("course"===e.contextLevel?c.CoreCourse.invalidateCourseBlocks(e.instanceId):d.CoreCoursesDashboard.invalidateDashboardBlocks()),null===(o=e.blocksComponents)||void 0===o||o.forEach((e=>{n.push(e.invalidate().catch((()=>{})))})),yield Promise.all(n)}))()}loadContent(){var e=this;return(0,t.A)((function*(){try{if("course"===e.contextLevel)e.blocks=yield s.CoreBlockHelper.getCourseBlocks(e.instanceId);else{const o=yield d.CoreCoursesDashboard.getDashboardBlocks(void 0,void 0,e.myDashboardPage);e.blocks=o.sideBlocks}}catch(o){i.CoreDomUtils.showErrorModal(o),e.blocks=[]}e.blocks=e.blocks.filter((e=>"html"!==e.name||e.contents&&!k.y.htmlIsBlank(e.contents.content)))}))()}doRefresh(e){var o=this;return(0,t.A)((function*(){yield a.g.ignoreErrors(o.invalidateBlocks()),yield o.loadContent().finally((()=>{null==e||e.complete()}))}))()}closeModal(){l.W3.dismiss()}focusInitialBlock(){var e=this;return(0,t.A)((function*(){if(!e.initialBlockInstanceId)return;const o="#block-"+e.initialBlockInstanceId;yield m.H.waitFor((()=>!!e.elementRef.nativeElement.querySelector(o))),yield m.H.wait(200),k.y.scrollToElement(e.elementRef.nativeElement,o,{addYAxis:-10})}))()}}return(e=CoreBlockSideBlocksComponent).ɵfac=function CoreBlockSideBlocksComponent_Factory(o){return new(o||e)(f.rXU(f.aKT))},e.ɵcmp=f.VBU({type:e,selectors:[["core-block-side-blocks"]],viewQuery:function CoreBlockSideBlocksComponent_Query(e,o){if(1&e&&f.GBs(r.A,5),2&e){let e;f.mGM(e=f.lsd())&&(o.blocksComponents=e)}},inputs:{contextLevel:"contextLevel",instanceId:"instanceId",initialBlockInstanceId:"initialBlockInstanceId",myDashboardPage:"myDashboardPage"},standalone:!0,features:[f.aNF],decls:13,vars:11,consts:[[1,"no-title"],["slot","end"],["fill","clear",3,"click","ariaLabel"],["name","fas-xmark","slot","icon-only","aria-hidden","true"],[3,"fullscreen"],["slot","fixed",3,"ionRefresh","disabled"],[3,"pullingText"],[3,"hideUntil"],[4,"ngIf"],["icon","fas-table-cells-large",3,"message",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"block","contextLevel","instanceId",4,"ngIf"],[3,"block","contextLevel","instanceId"],["icon","fas-table-cells-large",3,"message"]],template:function CoreBlockSideBlocksComponent_Template(e,o){1&e&&(f.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1)(3,"ion-button",2),f.nI1(4,"translate"),f.bIt("click",(function CoreBlockSideBlocksComponent_Template_ion_button_click_3_listener(){return o.closeModal()})),f.nrm(5,"ion-icon",3),f.k0s()()()(),f.j41(6,"ion-content",4)(7,"ion-refresher",5),f.bIt("ionRefresh",(function CoreBlockSideBlocksComponent_Template_ion_refresher_ionRefresh_7_listener(e){return o.doRefresh(e.target)})),f.nrm(8,"ion-refresher-content",6),f.nI1(9,"translate"),f.k0s(),f.j41(10,"core-loading",7),f.DNE(11,CoreBlockSideBlocksComponent_ion_list_11_Template,2,1,"ion-list",8)(12,CoreBlockSideBlocksComponent_core_empty_box_12_Template,2,3,"core-empty-box",9),f.k0s()()),2&e&&(f.R7$(3),f.Y8G("ariaLabel",f.bMT(4,7,"core.close")),f.R7$(3),f.Y8G("fullscreen",!0),f.R7$(),f.Y8G("disabled",!o.loaded),f.R7$(),f.FS9("pullingText",f.bMT(9,9,"core.pulltorefresh")),f.R7$(2),f.Y8G("hideUntil",o.loaded),f.R7$(),f.Y8G("ngIf",o.blocks.length>0),f.R7$(),f.Y8G("ngIf",0===o.blocks.length))},dependencies:[_.n,b.Sq,b.bT,u.h,C.R,B.t,h.i,g.T,I.Jm,I.QW,I.W9,I.eU,I.iq,I.nf,I.To,I.Ki,I.ai,v.D9,p.R,r.A],styles:["@media (min-width: 768px){[_nghost-%COMP%]     core-block .ion-hide-md-down{display:none!important}[_nghost-%COMP%]     core-block .ion-hide-md-up{display:block!important}}"]}),CoreBlockSideBlocksComponent})()}}]);