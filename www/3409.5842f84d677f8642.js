"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3409],{83409:(t,e,n)=>{n.r(e),n.d(e,{default:()=>N});var o=n(21182),i=n(3353),a=n(6007),s=n(31249),r=n(96698),c=n(63455),d=n(54438);let _=(()=>{var t;class AddonModH5PActivityComponentsModule{}return(t=AddonModH5PActivityComponentsModule).ɵfac=function AddonModH5PActivityComponentsModule_Factory(e){return new(e||t)},t.ɵmod=d.$C({type:t}),t.ɵinj=d.G2t({imports:[i.n,s.r,c.v]}),AddonModH5PActivityComponentsModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&d.Obh(_,{declarations:[r.AddonModH5PActivityIndexComponent],imports:[i.n,s.r,c.v],exports:[r.AddonModH5PActivityIndexComponent]}));var l=n(10467),m=n(2138),p=n(89911),g=n(79555),u=n(58197),A=n(68273),h=n(88246),v=n(73465),y=n(73955);let f=(()=>{var t;class AddonModH5PActivityIndexPage extends m._{constructor(){super(...arguments),this.canLeaveSafely=!1}canLeave(){var t=this;return(0,l.A)((function*(){var e;if(null===(e=t.activityComponent)||void 0===e||!e.playing||t.activityComponent.isOpeningPage||t.activityComponent.saveStateEnabled)return!0;if(!t.canLeaveSafely)try{return yield p.CoreDomUtils.showConfirm(g.HT.instant("core.confirmleaveunknownchanges")),!0}catch{return!1}return!0}))()}setCanleaveSafely(t){this.canLeaveSafely=t,this.remainingTimeout&&clearTimeout(this.remainingTimeout),this.remainingTimeout=window.setTimeout((()=>{this.canLeaveSafely=!1}),1e4)}ngOnDestroy(){this.remainingTimeout&&clearTimeout(this.remainingTimeout)}}return(t=AddonModH5PActivityIndexPage).ɵfac=(()=>{let e;return function AddonModH5PActivityIndexPage_Factory(n){return(e||(e=d.xGo(t)))(n||t)}})(),t.ɵcmp=d.VBU({type:t,selectors:[["page-addon-mod-h5pactivity-index"]],viewQuery:function AddonModH5PActivityIndexPage_Query(t,e){if(1&t&&d.GBs(r.AddonModH5PActivityIndexComponent,5),2&t){let t;d.mGM(t=d.lsd())&&(e.activityComponent=t.first)}},features:[d.Vt3],decls:14,vars:12,consts:[["collapsible",""],["slot","start"],[3,"text"],["contextLevel","module",3,"text","contextInstanceId","courseId"],["slot","end"],["slot","fixed",3,"ionRefresh","disabled"],[3,"pullingText"],[3,"dataRetrieved","onActivityFinish","module","courseId"]],template:function AddonModH5PActivityIndexPage_Template(t,e){1&t&&(d.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),d.nrm(3,"ion-back-button",2),d.nI1(4,"translate"),d.k0s(),d.j41(5,"ion-title")(6,"h1"),d.nrm(7,"core-format-text",3),d.k0s()(),d.nrm(8,"ion-buttons",4),d.k0s()(),d.j41(9,"ion-content")(10,"ion-refresher",5),d.bIt("ionRefresh",(function AddonModH5PActivityIndexPage_Template_ion_refresher_ionRefresh_10_listener(t){return null==e.activityComponent?null:e.activityComponent.doRefresh(t.target)})),d.nrm(11,"ion-refresher-content",6),d.nI1(12,"translate"),d.k0s(),d.j41(13,"addon-mod-h5pactivity-index",7),d.bIt("dataRetrieved",(function AddonModH5PActivityIndexPage_Template_addon_mod_h5pactivity_index_dataRetrieved_13_listener(t){return e.updateData(t)}))("onActivityFinish",(function AddonModH5PActivityIndexPage_Template_addon_mod_h5pactivity_index_onActivityFinish_13_listener(t){return e.setCanleaveSafely(t)})),d.k0s()()),2&t&&(d.R7$(3),d.Y8G("text",d.bMT(4,8,"core.back")),d.R7$(4),d.Y8G("text",e.title)("contextInstanceId",e.module.id)("courseId",e.courseId),d.R7$(3),d.Y8G("disabled",null==e.activityComponent?null:e.activityComponent.showLoading),d.R7$(),d.FS9("pullingText",d.bMT(12,10,"core.pulltorefresh")),d.R7$(2),d.Y8G("module",e.module)("courseId",e.courseId))},dependencies:[u.B,A.M,h.i,v.QW,v.W9,v.eU,v.To,v.Ki,v.BC,v.ai,v.el,r.AddonModH5PActivityIndexComponent,y.D9],encapsulation:2}),AddonModH5PActivityIndexPage})();var P=n(98870),I=n(15324),R=n(52749),M=n(55554),T=n(34961),b=n(24742),x=n(22693),$=n(60177),H=n(16986),k=n(64422),F=n(16658),U=n(86198),G=n(37557),w=n(59528);const _c0=t=>({attempts:t}),_c1=t=>({$a:t});function AddonModH5PActivityUserAttemptsPage_core_format_text_7_Template(t,e){if(1&t&&d.nrm(0,"core-format-text",11),2&t){const t=d.XpG();d.Y8G("text",t.h5pActivity.name)("contextInstanceId",t.h5pActivity.coursemodule)("courseId",t.courseId)}}function AddonModH5PActivityUserAttemptsPage_ion_item_13_Template(t,e){if(1&t&&(d.j41(0,"ion-item",12),d.nrm(1,"core-user-avatar",13),d.j41(2,"ion-label")(3,"h2"),d.EFF(4),d.k0s()()()),2&t){const t=d.XpG();d.Y8G("userId",t.user.id)("courseId",t.courseId)("detail",!0),d.BMQ("aria-label",t.user.fullname),d.R7$(),d.Y8G("user",t.user)("courseId",t.courseId)("linkProfile",!1),d.R7$(3),d.JRh(t.user.fullname)}}function AddonModH5PActivityUserAttemptsPage_ion_item_14_Template(t,e){if(1&t&&(d.j41(0,"ion-item",14),d.nrm(1,"core-user-avatar",15),d.j41(2,"ion-label")(3,"h2"),d.EFF(4),d.nI1(5,"translate"),d.k0s()()()),2&t){const t=d.XpG();d.R7$(),d.Y8G("user",t.user)("courseId",t.courseId),d.R7$(3),d.JRh(d.bMT(5,3,"addon.mod_h5pactivity.myattempts"))}}function AddonModH5PActivityUserAttemptsPage_ion_list_15_ng_container_1_ng_container_5_Template(t,e){1&t&&d.eu8(0)}function AddonModH5PActivityUserAttemptsPage_ion_list_15_ng_container_1_Template(t,e){if(1&t&&(d.qex(0),d.j41(1,"ion-item-divider")(2,"ion-label")(3,"h3",16),d.EFF(4),d.k0s()()(),d.DNE(5,AddonModH5PActivityUserAttemptsPage_ion_list_15_ng_container_1_ng_container_5_Template,1,0,"ng-container",17),d.bVm()),2&t){const t=d.XpG(2),e=d.sdS(18);d.R7$(4),d.JRh(t.attemptsData.scored.title),d.R7$(),d.Y8G("ngTemplateOutlet",e)("ngTemplateOutletContext",d.eq3(3,_c0,t.attemptsData.scored.attempts))}}function AddonModH5PActivityUserAttemptsPage_ion_list_15_ng_container_2_ng_container_6_Template(t,e){1&t&&d.eu8(0)}function AddonModH5PActivityUserAttemptsPage_ion_list_15_ng_container_2_Template(t,e){if(1&t&&(d.qex(0),d.j41(1,"ion-item-divider")(2,"ion-label")(3,"h3",16),d.EFF(4),d.nI1(5,"translate"),d.k0s()()(),d.DNE(6,AddonModH5PActivityUserAttemptsPage_ion_list_15_ng_container_2_ng_container_6_Template,1,0,"ng-container",17),d.bVm()),2&t){const t=d.XpG(2),e=d.sdS(18);d.R7$(4),d.JRh(d.bMT(5,3,"addon.mod_h5pactivity.all_attempts")),d.R7$(2),d.Y8G("ngTemplateOutlet",e)("ngTemplateOutletContext",d.eq3(5,_c0,t.attemptsData.attempts))}}function AddonModH5PActivityUserAttemptsPage_ion_list_15_Template(t,e){if(1&t&&(d.j41(0,"ion-list"),d.DNE(1,AddonModH5PActivityUserAttemptsPage_ion_list_15_ng_container_1_Template,6,5,"ng-container",9)(2,AddonModH5PActivityUserAttemptsPage_ion_list_15_ng_container_2_Template,7,7,"ng-container",9),d.k0s()),2&t){const t=d.XpG();d.R7$(),d.Y8G("ngIf",t.attemptsData.scored),d.R7$(),d.Y8G("ngIf",t.attemptsData.attempts&&t.attemptsData.attempts.length)}}function AddonModH5PActivityUserAttemptsPage_core_empty_box_16_Template(t,e){1&t&&(d.nrm(0,"core-empty-box",18),d.nI1(1,"translate")),2&t&&d.Y8G("message",d.bMT(1,1,"addon.mod_h5pactivity.attempts_none"))}function AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_img_18_Template(t,e){1&t&&(d.nrm(0,"img",33),d.nI1(1,"translate")),2&t&&d.Y8G("alt",d.bMT(1,1,"addon.mod_h5pactivity.attempt_completion_yes"))}function AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_img_19_Template(t,e){1&t&&(d.nrm(0,"img",34),d.nI1(1,"translate")),2&t&&d.Y8G("alt",d.bMT(1,1,"addon.mod_h5pactivity.attempt_completion_no"))}function AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_ion_icon_21_Template(t,e){1&t&&(d.nrm(0,"ion-icon",35),d.nI1(1,"translate")),2&t&&d.BMQ("aria-label",d.bMT(1,1,"addon.mod_h5pactivity.attempt_success_pass"))}function AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_ion_icon_22_Template(t,e){1&t&&(d.nrm(0,"ion-icon",36),d.nI1(1,"translate")),2&t&&d.BMQ("aria-label",d.bMT(1,1,"addon.mod_h5pactivity.attempt_success_fail"))}function AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_img_23_Template(t,e){1&t&&(d.nrm(0,"img",37),d.nI1(1,"translate")),2&t&&d.Y8G("alt",d.bMT(1,1,"addon.mod_h5pactivity.attempt_success_unknown"))}function AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_Template(t,e){if(1&t){const t=d.RV6();d.j41(0,"ion-item",25),d.nI1(1,"translate"),d.bIt("click",(function AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_Template_ion_item_click_0_listener(){const e=d.eBV(t).$implicit,n=d.XpG(2);return d.Njj(n.openAttempt(e))})),d.j41(2,"ion-label")(3,"ion-row",20)(4,"ion-col",21),d.EFF(5),d.k0s(),d.j41(6,"ion-col",22),d.EFF(7),d.nI1(8,"coreFormatDate"),d.k0s(),d.j41(9,"ion-col",21),d.EFF(10),d.j41(11,"span",26),d.EFF(12),d.k0s()(),d.j41(13,"ion-col",23),d.EFF(14),d.k0s(),d.j41(15,"ion-col",23),d.EFF(16),d.k0s(),d.j41(17,"ion-col",23),d.DNE(18,AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_img_18_Template,2,3,"img",27)(19,AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_img_19_Template,2,3,"img",28),d.k0s(),d.j41(20,"ion-col",29),d.DNE(21,AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_ion_icon_21_Template,2,3,"ion-icon",30)(22,AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_ion_icon_22_Template,2,3,"ion-icon",31)(23,AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_img_23_Template,2,3,"img",32),d.k0s()()()()}if(2&t){const t=e.$implicit;d.Y8G("detail",!0),d.BMQ("aria-label",d.i5U(1,13,"addon.mod_h5pactivity.viewattempt",d.eq3(19,_c1,t.attempt))),d.R7$(5),d.JRh(t.attempt),d.R7$(2),d.SpI(" ",d.i5U(8,16,t.timemodified,"strftimedatetimeshort")," "),d.R7$(3),d.SpI(" ",t.rawscore,""),d.R7$(2),d.SpI(" / ",t.maxscore,""),d.R7$(2),d.JRh(t.maxscore),d.R7$(2),d.JRh(t.durationReadable),d.R7$(2),d.Y8G("ngIf",t.completion),d.R7$(),d.Y8G("ngIf",!t.completion),d.R7$(2),d.Y8G("ngIf",null!==t.success&&t.success),d.R7$(),d.Y8G("ngIf",null!==t.success&&!t.success),d.R7$(),d.Y8G("ngIf",null===t.success)}}function AddonModH5PActivityUserAttemptsPage_ng_template_17_Template(t,e){if(1&t&&(d.j41(0,"ion-item",19)(1,"ion-label")(2,"ion-row",20)(3,"ion-col",21),d.EFF(4,"#"),d.k0s(),d.j41(5,"ion-col",22),d.EFF(6),d.nI1(7,"translate"),d.k0s(),d.j41(8,"ion-col",21),d.EFF(9),d.nI1(10,"translate"),d.k0s(),d.j41(11,"ion-col",23),d.EFF(12),d.nI1(13,"translate"),d.k0s(),d.j41(14,"ion-col",23),d.EFF(15),d.nI1(16,"translate"),d.k0s(),d.j41(17,"ion-col",23),d.EFF(18),d.nI1(19,"translate"),d.k0s(),d.j41(20,"ion-col",21),d.EFF(21),d.nI1(22,"translate"),d.k0s()()()(),d.DNE(23,AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_Template,24,21,"ion-item",24)),2&t){const t=e.attempts;d.Y8G("detail",!0),d.R7$(6),d.JRh(d.bMT(7,8,"core.date")),d.R7$(3),d.JRh(d.bMT(10,10,"addon.mod_h5pactivity.score")),d.R7$(3),d.JRh(d.bMT(13,12,"addon.mod_h5pactivity.maxscore")),d.R7$(3),d.JRh(d.bMT(16,14,"addon.mod_h5pactivity.duration")),d.R7$(3),d.JRh(d.bMT(19,16,"addon.mod_h5pactivity.completion")),d.R7$(3),d.JRh(d.bMT(22,18,"core.success")),d.R7$(2),d.Y8G("ngForOf",t)}}let E=(()=>{var t;class AddonModH5PActivityUserAttemptsPage{constructor(){var t=this;this.loaded=!1,this.isCurrentUser=!1,this.logView=b.j.once((0,l.A)((function*(){t.h5pActivity&&(yield M.g.ignoreErrors(T.R.logViewReport(t.h5pActivity.id,{userId:t.userId})),x.OF.logEvent({type:x.qr.VIEW_ITEM,ws:"mod_h5pactivity_log_report_viewed",name:t.h5pActivity.name,data:{id:t.h5pActivity.id,userid:t.userId,category:"h5pactivity"},url:`/mod/h5pactivity/report.php?a=${t.h5pActivity.id}&userid=${t.userId}`}))})))}ngOnInit(){var t=this;return(0,l.A)((function*(){try{t.courseId=I.CoreNavigator.getRequiredRouteNumberParam("courseId"),t.cmId=I.CoreNavigator.getRequiredRouteNumberParam("cmId"),t.userId=I.CoreNavigator.getRouteNumberParam("userId")||R.CoreSites.getCurrentSiteUserId()}catch(t){return p.CoreDomUtils.showErrorModal(t),I.CoreNavigator.back(),void 0}t.isCurrentUser=t.userId==R.CoreSites.getCurrentSiteUserId(),yield t.fetchData()}))()}doRefresh(t){this.refreshData().finally((()=>{t.complete()}))}fetchData(){var t=this;return(0,l.A)((function*(){try{t.h5pActivity=yield T.R.getH5PActivity(t.courseId,t.cmId),yield Promise.all([t.fetchAttempts(),t.fetchUserProfile()]),t.logView()}catch(t){p.CoreDomUtils.showErrorModalDefault(t,"Error loading attempts.")}finally{t.loaded=!0}}))()}fetchAttempts(){var t=this;return(0,l.A)((function*(){t.h5pActivity&&(t.attemptsData=yield T.R.getUserAttempts(t.h5pActivity.id,{cmId:t.cmId,userId:t.userId}))}))()}fetchUserProfile(){var t=this;return(0,l.A)((function*(){try{t.user=yield P.CoreUser.getProfile(t.userId,t.courseId,!0)}catch{}}))()}refreshData(){var t=this;return(0,l.A)((function*(){const e=[T.R.invalidateActivityData(t.courseId)];t.h5pActivity&&e.push(T.R.invalidateUserAttempts(t.h5pActivity.id,t.userId)),yield M.g.ignoreErrors(Promise.all(e)),yield t.fetchData()}))()}openAttempt(t){I.CoreNavigator.navigate(`../../attemptresults/${t.id}`)}}return(t=AddonModH5PActivityUserAttemptsPage).ɵfac=function AddonModH5PActivityUserAttemptsPage_Factory(e){return new(e||t)},t.ɵcmp=d.VBU({type:t,selectors:[["page-addon-mod-h5pactivity-user-attempts"]],decls:19,vars:13,consts:[["attemptsTemplate",""],["slot","start"],[3,"text"],["contextLevel","module",3,"text","contextInstanceId","courseId",4,"ngIf"],["slot","fixed",3,"ionRefresh","disabled"],[3,"pullingText"],[3,"hideUntil"],["class","ion-text-wrap","core-user-link","","button","",3,"userId","courseId","detail",4,"ngIf"],["class","ion-text-wrap",4,"ngIf"],[4,"ngIf"],["icon","fas-chart-bar",3,"message",4,"ngIf"],["contextLevel","module",3,"text","contextInstanceId","courseId"],["core-user-link","","button","",1,"ion-text-wrap",3,"userId","courseId","detail"],["slot","start",3,"user","courseId","linkProfile"],[1,"ion-text-wrap"],["slot","start",3,"user","courseId"],[1,"item-heading"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["icon","fas-chart-bar",3,"message"],[1,"addon-mod_h5pactivity-table-header","hide-detail",3,"detail"],[1,"ion-align-items-center"],[1,"ion-text-center"],["size","5","size-md","2",1,"ion-text-center"],[1,"ion-text-center","ion-hide-md-down"],["class","ion-text-wrap addon-mod_h5pactivity-table-row","button","",3,"detail","click",4,"ngFor","ngForOf"],["button","",1,"ion-text-wrap","addon-mod_h5pactivity-table-row",3,"click","detail"],[1,"ion-hide-md-up"],["src","assets/img/completion/completion-auto-y.svg",3,"alt",4,"ngIf"],["src","assets/img/completion/completion-auto-n.svg",3,"alt",4,"ngIf"],[1,"ion-text-center","addon-mod_h5pactivity-table-success-col"],["name","fas-circle-check",4,"ngIf"],["name","far-circle",4,"ngIf"],["src","assets/img/icons/empty.svg",3,"alt",4,"ngIf"],["src","assets/img/completion/completion-auto-y.svg",3,"alt"],["src","assets/img/completion/completion-auto-n.svg",3,"alt"],["name","fas-circle-check"],["name","far-circle"],["src","assets/img/icons/empty.svg",3,"alt"]],template:function AddonModH5PActivityUserAttemptsPage_Template(t,e){if(1&t){const t=d.RV6();d.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",1),d.nrm(3,"ion-back-button",2),d.nI1(4,"translate"),d.k0s(),d.j41(5,"ion-title")(6,"h1"),d.DNE(7,AddonModH5PActivityUserAttemptsPage_core_format_text_7_Template,1,3,"core-format-text",3),d.k0s()()()(),d.j41(8,"ion-content")(9,"ion-refresher",4),d.bIt("ionRefresh",(function AddonModH5PActivityUserAttemptsPage_Template_ion_refresher_ionRefresh_9_listener(n){return d.eBV(t),d.Njj(e.doRefresh(n.target))})),d.nrm(10,"ion-refresher-content",5),d.nI1(11,"translate"),d.k0s(),d.j41(12,"core-loading",6),d.DNE(13,AddonModH5PActivityUserAttemptsPage_ion_item_13_Template,5,8,"ion-item",7)(14,AddonModH5PActivityUserAttemptsPage_ion_item_14_Template,6,5,"ion-item",8)(15,AddonModH5PActivityUserAttemptsPage_ion_list_15_Template,3,2,"ion-list",9)(16,AddonModH5PActivityUserAttemptsPage_core_empty_box_16_Template,2,3,"core-empty-box",10),d.k0s()(),d.DNE(17,AddonModH5PActivityUserAttemptsPage_ng_template_17_Template,24,20,"ng-template",null,0,d.C5r)}2&t&&(d.R7$(3),d.Y8G("text",d.bMT(4,9,"core.back")),d.R7$(4),d.Y8G("ngIf",e.h5pActivity),d.R7$(2),d.Y8G("disabled",!e.loaded),d.R7$(),d.FS9("pullingText",d.bMT(11,11,"core.pulltorefresh")),d.R7$(2),d.Y8G("hideUntil",e.loaded),d.R7$(),d.Y8G("ngIf",e.user&&!e.isCurrentUser),d.R7$(),d.Y8G("ngIf",e.user&&e.isCurrentUser),d.R7$(),d.Y8G("ngIf",e.attemptsData),d.R7$(),d.Y8G("ngIf",e.attemptsData&&(!e.attemptsData.attempts||!e.attemptsData.attempts.length)))},dependencies:[$.Sq,$.bT,$.T3,H.h,k.R,F.T,U.t,u.B,G.O,h.i,v.QW,v.hU,v.W9,v.eU,v.iq,v.uz,v.Dg,v.he,v.nf,v.To,v.Ki,v.ln,v.BC,v.ai,v.el,w.f,y.D9],styles:["[_nghost-%COMP%]   .addon-mod_h5pactivity-table-header[_ngcontent-%COMP%]{font-weight:700}[_nghost-%COMP%]   .addon-mod_h5pactivity-table-header[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}[_nghost-%COMP%]   .addon-mod_h5pactivity-table-row[_ngcontent-%COMP%]   .addon-mod_h5pactivity-table-success-col[_ngcontent-%COMP%]{font-size:1.2em}"]}),AddonModH5PActivityUserAttemptsPage})();var C=n(9153);const attempt_results_c0=t=>({$a:t}),attempt_results_c1=t=>({answer:t});function AddonModH5PActivityAttemptResultsPage_core_format_text_7_Template(t,e){if(1&t&&d.nrm(0,"core-format-text",8),2&t){const t=d.XpG();d.Y8G("text",t.h5pActivity.name)("contextInstanceId",t.h5pActivity.coursemodule)("courseId",t.courseId)}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ion_item_1_Template(t,e){if(1&t&&(d.j41(0,"ion-item",14),d.nrm(1,"core-user-avatar",15),d.j41(2,"ion-label")(3,"p",13),d.EFF(4),d.nI1(5,"translate"),d.k0s()()()),2&t){const t=d.XpG(2);d.Y8G("userId",t.user.id)("courseId",t.courseId),d.BMQ("aria-label",t.user.fullname),d.R7$(),d.Y8G("user",t.user)("courseId",t.courseId)("linkProfile",!1),d.R7$(3),d.E5c("",d.bMT(5,9,"addon.mod_h5pactivity.attempt")," #",t.attempt.attempt,": ",t.user.fullname,"")}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ion_item_2_Template(t,e){if(1&t&&(d.j41(0,"ion-item",12)(1,"ion-label")(2,"p",13),d.EFF(3),d.nI1(4,"translate"),d.k0s()()()),2&t){const t=d.XpG(2);d.R7$(3),d.Lme("",d.bMT(4,2,"addon.mod_h5pactivity.attempt")," #",t.attempt.attempt,"")}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_p_18_Template(t,e){1&t&&(d.j41(0,"p"),d.nrm(1,"img",16),d.EFF(2),d.nI1(3,"translate"),d.k0s()),2&t&&(d.R7$(2),d.SpI(" ",d.bMT(3,1,"addon.mod_h5pactivity.attempt_completion_yes")," "))}function AddonModH5PActivityAttemptResultsPage_ng_container_13_p_19_Template(t,e){1&t&&(d.j41(0,"p"),d.nrm(1,"img",17),d.EFF(2),d.nI1(3,"translate"),d.k0s()),2&t&&(d.R7$(2),d.SpI(" ",d.bMT(3,1,"addon.mod_h5pactivity.attempt_completion_no")," "))}function AddonModH5PActivityAttemptResultsPage_ng_container_13_p_32_Template(t,e){1&t&&(d.j41(0,"p"),d.nrm(1,"ion-icon",18),d.EFF(2),d.nI1(3,"translate"),d.k0s()),2&t&&(d.R7$(2),d.SpI(" ",d.bMT(3,1,"addon.mod_h5pactivity.attempt_success_pass")," "))}function AddonModH5PActivityAttemptResultsPage_ng_container_13_p_33_Template(t,e){1&t&&(d.j41(0,"p"),d.nrm(1,"ion-icon",19),d.EFF(2),d.nI1(3,"translate"),d.k0s()),2&t&&(d.R7$(2),d.SpI(" ",d.bMT(3,1,"addon.mod_h5pactivity.attempt_success_fail")," "))}function AddonModH5PActivityAttemptResultsPage_ng_container_13_p_34_Template(t,e){1&t&&(d.j41(0,"p"),d.EFF(1),d.nI1(2,"translate"),d.k0s()),2&t&&(d.R7$(),d.SpI(" ",d.bMT(2,1,"addon.mod_h5pactivity.attempt_success_unknown")," "))}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ion_item_35_Template(t,e){if(1&t&&(d.j41(0,"ion-item",12)(1,"ion-label")(2,"p",13),d.EFF(3),d.nI1(4,"translate"),d.k0s(),d.j41(5,"p"),d.EFF(6),d.nI1(7,"translate"),d.k0s()()()),2&t){const t=d.XpG(2);d.R7$(3),d.JRh(d.bMT(4,2,"addon.mod_h5pactivity.totalscore")),d.R7$(3),d.JRh(d.i5U(7,4,"addon.mod_h5pactivity.score_out_of",d.eq3(7,attempt_results_c0,t.attempt)))}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ion_item_4_Template(t,e){if(1&t&&(d.j41(0,"ion-item",12)(1,"ion-label"),d.nrm(2,"core-format-text",21),d.k0s()()),2&t){const t=d.XpG().$implicit,e=d.XpG(3);d.R7$(2),d.Y8G("text",t.content)("component",e.component)("componentId",e.cmId)("contextInstanceId",e.cmId)("courseId",e.courseId)}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_10_ng_container_6_ng_container_1_Template(t,e){1&t&&d.eu8(0)}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_10_ng_container_6_Template(t,e){if(1&t&&(d.qex(0),d.DNE(1,AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_10_ng_container_6_ng_container_1_Template,1,0,"ng-container",30),d.bVm()),2&t){const t=d.XpG().$implicit;d.XpG(5);const e=d.sdS(15);d.R7$(),d.Y8G("ngTemplateOutlet",e)("ngTemplateOutletContext",d.eq3(2,attempt_results_c1,t.correctanswer))}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_10_ng_container_8_ng_container_1_Template(t,e){1&t&&d.eu8(0)}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_10_ng_container_8_Template(t,e){if(1&t&&(d.qex(0),d.DNE(1,AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_10_ng_container_8_ng_container_1_Template,1,0,"ng-container",30),d.bVm()),2&t){const t=d.XpG().$implicit;d.XpG(5);const e=d.sdS(15);d.R7$(),d.Y8G("ngTemplateOutlet",e)("ngTemplateOutletContext",d.eq3(2,attempt_results_c1,t.useranswer))}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_10_Template(t,e){if(1&t&&(d.j41(0,"ion-item",29)(1,"ion-label")(2,"ion-row",24)(3,"ion-col",25),d.nrm(4,"core-format-text",21),d.k0s(),d.j41(5,"ion-col",26),d.DNE(6,AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_10_ng_container_6_Template,2,4,"ng-container",7),d.k0s(),d.j41(7,"ion-col",26),d.DNE(8,AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_10_ng_container_8_Template,2,4,"ng-container",7),d.k0s()()()()),2&t){const t=e.$implicit,n=d.XpG(5);d.R7$(4),d.Y8G("text",t.description)("component",n.component)("componentId",n.cmId)("contextInstanceId",n.cmId)("courseId",n.courseId),d.R7$(2),d.Y8G("ngIf",t.correctanswer),d.R7$(2),d.Y8G("ngIf",t.useranswer)}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_11_Template(t,e){if(1&t&&(d.j41(0,"ion-item",31)(1,"ion-label")(2,"p")(3,"strong"),d.EFF(4),d.nI1(5,"translate"),d.nI1(6,"translate"),d.k0s()()()()),2&t){const t=d.XpG(2).$implicit;d.R7$(4),d.Lme(" ",d.bMT(5,2,"addon.mod_h5pactivity.score"),": ",d.i5U(6,4,"addon.mod_h5pactivity.score_out_of",d.eq3(7,attempt_results_c0,t))," ")}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_Template(t,e){if(1&t&&(d.qex(0),d.j41(1,"ion-item",23)(2,"ion-label")(3,"ion-row",24)(4,"ion-col",25),d.EFF(5),d.k0s(),d.j41(6,"ion-col",26),d.EFF(7),d.k0s(),d.j41(8,"ion-col",26),d.EFF(9),d.k0s()()()(),d.DNE(10,AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_10_Template,9,7,"ion-item",27)(11,AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_ion_item_11_Template,7,9,"ion-item",28),d.bVm()),2&t){const t=d.XpG().$implicit;d.R7$(5),d.JRh(t.optionslabel),d.R7$(2),d.JRh(t.correctlabel),d.R7$(2),d.JRh(t.answerlabel),d.R7$(),d.Y8G("ngForOf",t.options),d.R7$(),d.Y8G("ngIf",t.maxscore)}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ion_item_6_Template(t,e){if(1&t&&(d.j41(0,"ion-item",32),d.nrm(1,"ion-icon",33),d.j41(2,"ion-label"),d.EFF(3),d.nI1(4,"translate"),d.k0s()()),2&t){const t=d.XpG().$implicit;d.R7$(3),d.SpI(" ",d.i5U(4,1,"addon.mod_h5pactivity.no_compatible_track",d.eq3(4,attempt_results_c0,t.interactiontype))," ")}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_Template(t,e){if(1&t&&(d.j41(0,"ion-card")(1,"ion-card-header",12)(2,"ion-card-title"),d.nrm(3,"core-format-text",21),d.k0s()(),d.DNE(4,AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ion_item_4_Template,3,5,"ion-item",10)(5,AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ng_container_5_Template,12,5,"ng-container",7)(6,AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_ion_item_6_Template,5,6,"ion-item",22),d.k0s()),2&t){const t=e.$implicit,n=d.XpG(3);d.R7$(3),d.Y8G("text",t.description)("component",n.component)("componentId",n.cmId)("contextInstanceId",n.cmId)("courseId",n.courseId),d.R7$(),d.Y8G("ngIf",t.content),d.R7$(),d.Y8G("ngIf",t.options&&t.options.length),d.R7$(),d.Y8G("ngIf",!t.track)}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_Template(t,e){if(1&t&&(d.qex(0),d.DNE(1,AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_ion_card_1_Template,7,8,"ion-card",20),d.bVm()),2&t){const t=d.XpG(2);d.R7$(),d.Y8G("ngForOf",t.attempt.results)}}function AddonModH5PActivityAttemptResultsPage_ng_container_13_Template(t,e){if(1&t&&(d.qex(0),d.DNE(1,AddonModH5PActivityAttemptResultsPage_ng_container_13_ion_item_1_Template,6,11,"ion-item",9)(2,AddonModH5PActivityAttemptResultsPage_ng_container_13_ion_item_2_Template,5,4,"ion-item",10),d.j41(3,"ion-card",11)(4,"ion-list")(5,"ion-item",12)(6,"ion-label")(7,"p",13),d.EFF(8),d.nI1(9,"translate"),d.k0s(),d.j41(10,"p"),d.EFF(11),d.nI1(12,"coreFormatDate"),d.k0s()()(),d.j41(13,"ion-item",12)(14,"ion-label")(15,"p",13),d.EFF(16),d.nI1(17,"translate"),d.k0s(),d.DNE(18,AddonModH5PActivityAttemptResultsPage_ng_container_13_p_18_Template,4,3,"p",7)(19,AddonModH5PActivityAttemptResultsPage_ng_container_13_p_19_Template,4,3,"p",7),d.k0s()(),d.j41(20,"ion-item",12)(21,"ion-label")(22,"p",13),d.EFF(23),d.nI1(24,"translate"),d.k0s(),d.j41(25,"p"),d.EFF(26),d.k0s()()(),d.j41(27,"ion-item",12)(28,"ion-label")(29,"p",13),d.EFF(30),d.nI1(31,"translate"),d.k0s(),d.DNE(32,AddonModH5PActivityAttemptResultsPage_ng_container_13_p_32_Template,4,3,"p",7)(33,AddonModH5PActivityAttemptResultsPage_ng_container_13_p_33_Template,4,3,"p",7)(34,AddonModH5PActivityAttemptResultsPage_ng_container_13_p_34_Template,3,3,"p",7),d.k0s()(),d.DNE(35,AddonModH5PActivityAttemptResultsPage_ng_container_13_ion_item_35_Template,8,9,"ion-item",10),d.k0s()(),d.DNE(36,AddonModH5PActivityAttemptResultsPage_ng_container_13_ng_container_36_Template,2,1,"ng-container",7),d.bVm()),2&t){const t=d.XpG();d.R7$(),d.Y8G("ngIf",t.user),d.R7$(),d.Y8G("ngIf",!t.user),d.R7$(6),d.JRh(d.bMT(9,15,"addon.mod_h5pactivity.startdate")),d.R7$(3),d.JRh(d.i5U(12,17,t.attempt.timecreated,"strftimedatetime")),d.R7$(5),d.JRh(d.bMT(17,20,"addon.mod_h5pactivity.completion")),d.R7$(2),d.Y8G("ngIf",t.attempt.completion),d.R7$(),d.Y8G("ngIf",!t.attempt.completion),d.R7$(4),d.JRh(d.bMT(24,22,"addon.mod_h5pactivity.duration")),d.R7$(3),d.JRh(t.attempt.durationReadable),d.R7$(4),d.JRh(d.bMT(31,24,"addon.mod_h5pactivity.outcome")),d.R7$(2),d.Y8G("ngIf",null!==t.attempt.success&&t.attempt.success),d.R7$(),d.Y8G("ngIf",null!==t.attempt.success&&!t.attempt.success),d.R7$(),d.Y8G("ngIf",null===t.attempt.success),d.R7$(),d.Y8G("ngIf",t.attempt.maxscore),d.R7$(),d.Y8G("ngIf",t.attempt.results)}}function AddonModH5PActivityAttemptResultsPage_ng_template_14_p_0_Template(t,e){if(1&t&&(d.j41(0,"p"),d.nrm(1,"ion-icon",34),d.nI1(2,"translate"),d.EFF(3),d.k0s()),2&t){const t=d.XpG().answer;d.R7$(),d.BMQ("aria-label",d.bMT(2,2,"addon.mod_h5pactivity.answer_correct")),d.R7$(2),d.SpI(" ",t.answer," ")}}function AddonModH5PActivityAttemptResultsPage_ng_template_14_p_1_Template(t,e){if(1&t&&(d.j41(0,"p"),d.nrm(1,"ion-icon",35),d.nI1(2,"translate"),d.EFF(3),d.k0s()),2&t){const t=d.XpG().answer;d.R7$(),d.BMQ("aria-label",d.bMT(2,2,"addon.mod_h5pactivity.answer_incorrect")),d.R7$(2),d.SpI(" ",t.answer," ")}}function AddonModH5PActivityAttemptResultsPage_ng_template_14_p_2_Template(t,e){if(1&t&&(d.j41(0,"p"),d.EFF(1),d.k0s()),2&t){const t=d.XpG().answer;d.R7$(),d.SpI(" ",t.answer," ")}}function AddonModH5PActivityAttemptResultsPage_ng_template_14_p_3_Template(t,e){1&t&&(d.j41(0,"p"),d.nrm(1,"ion-icon",36),d.nI1(2,"translate"),d.k0s()),2&t&&(d.R7$(),d.BMQ("aria-label",d.bMT(2,1,"addon.mod_h5pactivity.answer_checked")))}function AddonModH5PActivityAttemptResultsPage_ng_template_14_p_4_Template(t,e){1&t&&(d.j41(0,"p"),d.nrm(1,"ion-icon",34),d.nI1(2,"translate"),d.k0s()),2&t&&(d.R7$(),d.BMQ("aria-label",d.bMT(2,1,"addon.mod_h5pactivity.answer_pass")))}function AddonModH5PActivityAttemptResultsPage_ng_template_14_p_5_Template(t,e){1&t&&(d.j41(0,"p"),d.nrm(1,"ion-icon",35),d.nI1(2,"translate"),d.k0s()),2&t&&(d.R7$(),d.BMQ("aria-label",d.bMT(2,1,"addon.mod_h5pactivity.answer_fail")))}function AddonModH5PActivityAttemptResultsPage_ng_template_14_Template(t,e){if(1&t&&d.DNE(0,AddonModH5PActivityAttemptResultsPage_ng_template_14_p_0_Template,4,4,"p",7)(1,AddonModH5PActivityAttemptResultsPage_ng_template_14_p_1_Template,4,4,"p",7)(2,AddonModH5PActivityAttemptResultsPage_ng_template_14_p_2_Template,2,1,"p",7)(3,AddonModH5PActivityAttemptResultsPage_ng_template_14_p_3_Template,3,3,"p",7)(4,AddonModH5PActivityAttemptResultsPage_ng_template_14_p_4_Template,3,3,"p",7)(5,AddonModH5PActivityAttemptResultsPage_ng_template_14_p_5_Template,3,3,"p",7),2&t){const t=e.answer;d.Y8G("ngIf",t.correct),d.R7$(),d.Y8G("ngIf",t.incorrect),d.R7$(),d.Y8G("ngIf",t.text),d.R7$(),d.Y8G("ngIf",t.checked),d.R7$(),d.Y8G("ngIf",t.pass),d.R7$(),d.Y8G("ngIf",t.fail)}}let j=(()=>{var t;class AddonModH5PActivityAttemptResultsPage{constructor(){var t=this;this.loaded=!1,this.component=C.hS,this.logView=b.j.once((0,l.A)((function*(){t.h5pActivity&&(yield M.g.ignoreErrors(T.R.logViewReport(t.h5pActivity.id,{attemptId:t.attemptId})),x.OF.logEvent({type:x.qr.VIEW_ITEM,ws:"mod_h5pactivity_log_report_viewed",name:t.h5pActivity.name,data:{id:t.h5pActivity.id,attemptid:t.attemptId,category:"h5pactivity"},url:`/mod/h5pactivity/report.php?a=${t.h5pActivity.id}&attemptid=${t.attemptId}`}))})))}ngOnInit(){var t=this;return(0,l.A)((function*(){try{t.courseId=I.CoreNavigator.getRequiredRouteNumberParam("courseId"),t.cmId=I.CoreNavigator.getRequiredRouteNumberParam("cmId"),t.attemptId=I.CoreNavigator.getRequiredRouteNumberParam("attemptId")}catch(t){return p.CoreDomUtils.showErrorModal(t),I.CoreNavigator.back(),void 0}yield t.fetchData()}))()}doRefresh(t){this.refreshData().finally((()=>{t.complete()}))}fetchData(){var t=this;return(0,l.A)((function*(){try{t.h5pActivity=yield T.R.getH5PActivity(t.courseId,t.cmId),t.attempt=yield T.R.getAttemptResults(t.h5pActivity.id,t.attemptId,{cmId:t.cmId}),yield t.fetchUserProfile(),t.logView()}catch(t){p.CoreDomUtils.showErrorModalDefault(t,"Error loading attempt.")}finally{t.loaded=!0}}))()}fetchUserProfile(){var t=this;return(0,l.A)((function*(){if(t.attempt)try{t.user=yield P.CoreUser.getProfile(t.attempt.userid,t.courseId,!0)}catch{}}))()}refreshData(){var t=this;return(0,l.A)((function*(){const e=[T.R.invalidateActivityData(t.courseId)];t.h5pActivity&&e.push(T.R.invalidateAttemptResults(t.h5pActivity.id,t.attemptId)),yield M.g.ignoreErrors(Promise.all(e)),yield t.fetchData()}))()}}return(t=AddonModH5PActivityAttemptResultsPage).ɵfac=function AddonModH5PActivityAttemptResultsPage_Factory(e){return new(e||t)},t.ɵcmp=d.VBU({type:t,selectors:[["page-addon-mod-h5pactivity-attempt-results"]],decls:16,vars:10,consts:[["answerTemplate",""],["slot","start"],[3,"text"],["contextLevel","module",3,"text","contextInstanceId","courseId",4,"ngIf"],["slot","fixed",3,"ionRefresh","disabled"],[3,"pullingText"],[3,"hideUntil"],[4,"ngIf"],["contextLevel","module",3,"text","contextInstanceId","courseId"],["class","ion-text-wrap","core-user-link","",3,"userId","courseId",4,"ngIf"],["class","ion-text-wrap",4,"ngIf"],[1,"addon-mod_h5pactivity-attempt-result-summary"],[1,"ion-text-wrap"],[1,"item-heading"],["core-user-link","",1,"ion-text-wrap",3,"userId","courseId"],["slot","start",3,"user","courseId","linkProfile"],["src","assets/img/completion/completion-auto-y.svg","role","presentation","alt",""],["src","assets/img/completion/completion-auto-n.svg","role","presentation","alt",""],["name","fas-circle-check","aria-hidden","true"],["name","far-circle","aria-hidden","true"],[4,"ngFor","ngForOf"],["contextLevel","module",3,"text","component","componentId","contextInstanceId","courseId"],["class","ion-text-wrap core-warning-item",4,"ngIf"],[1,"ion-text-wrap","addon-mod_h5pactivity-result-table-header"],[1,"ion-align-items-center"],[1,"ion-text-start"],[1,"ion-text-center"],["class","ion-text-wrap addon-mod_h5pactivity-result-table-row",4,"ngFor","ngForOf"],["class","ion-text-wrap ion-text-end addon-mod_h5pactivity-result-score",4,"ngIf"],[1,"ion-text-wrap","addon-mod_h5pactivity-result-table-row"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"ion-text-wrap","ion-text-end","addon-mod_h5pactivity-result-score"],[1,"ion-text-wrap","core-warning-item"],["slot","start","name","fas-triangle-exclamation","color","warning","aria-hidden","true"],["name","fas-check","color","success"],["name","fas-xmark","color","danger"],["name","fas-circle-check"]],template:function AddonModH5PActivityAttemptResultsPage_Template(t,e){if(1&t){const t=d.RV6();d.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",1),d.nrm(3,"ion-back-button",2),d.nI1(4,"translate"),d.k0s(),d.j41(5,"ion-title")(6,"h1"),d.DNE(7,AddonModH5PActivityAttemptResultsPage_core_format_text_7_Template,1,3,"core-format-text",3),d.k0s()()()(),d.j41(8,"ion-content")(9,"ion-refresher",4),d.bIt("ionRefresh",(function AddonModH5PActivityAttemptResultsPage_Template_ion_refresher_ionRefresh_9_listener(n){return d.eBV(t),d.Njj(e.doRefresh(n.target))})),d.nrm(10,"ion-refresher-content",5),d.nI1(11,"translate"),d.k0s(),d.j41(12,"core-loading",6),d.DNE(13,AddonModH5PActivityAttemptResultsPage_ng_container_13_Template,37,26,"ng-container",7),d.k0s()(),d.DNE(14,AddonModH5PActivityAttemptResultsPage_ng_template_14_Template,6,6,"ng-template",null,0,d.C5r)}2&t&&(d.R7$(3),d.Y8G("text",d.bMT(4,6,"core.back")),d.R7$(4),d.Y8G("ngIf",e.h5pActivity),d.R7$(2),d.Y8G("disabled",!e.loaded),d.R7$(),d.FS9("pullingText",d.bMT(11,8,"core.pulltorefresh")),d.R7$(2),d.Y8G("hideUntil",e.loaded),d.R7$(),d.Y8G("ngIf",e.attempt))},dependencies:[$.Sq,$.bT,$.T3,k.R,F.T,U.t,u.B,G.O,h.i,v.QW,v.b_,v.ME,v.tN,v.hU,v.W9,v.eU,v.iq,v.uz,v.he,v.nf,v.To,v.Ki,v.ln,v.BC,v.ai,v.el,w.f,y.D9],styles:["[_nghost-%COMP%]   .core-warning-item[_ngcontent-%COMP%]{--inner-border-width: 0px}[_nghost-%COMP%]   .addon-mod_h5pactivity-attempt-result-summary[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:16px;height:16px;display:inline;margin-inline-start:0;margin-inline-end:4px}[_nghost-%COMP%]   .addon-mod_h5pactivity-attempt-result-summary[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-mod_h5pactivity-result-table-header[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-mod_h5pactivity-result-table-row[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.2em}[_nghost-%COMP%]   .addon-mod_h5pactivity-result-table-header[_ngcontent-%COMP%]{font-weight:700}[_nghost-%COMP%]   .addon-mod_h5pactivity-result-table-row.item[_ngcontent-%COMP%]:nth-child(2n){--background: var(--light)}[_nghost-%COMP%]   .addon-mod_h5pactivity-result-score[_ngcontent-%COMP%]{border-top:1px solid black}:root.dark[_nghost-%COMP%]   .addon-mod_h5pactivity-result-table-row.item[_ngcontent-%COMP%]:nth-child(2n), :root.dark   [_nghost-%COMP%]   .addon-mod_h5pactivity-result-table-row.item[_ngcontent-%COMP%]:nth-child(2n){--background: var(--gray-900)}"]}),AddonModH5PActivityAttemptResultsPage})();var Y=n(66198);const users_attempts_c0=t=>({$a:t});function AddonModH5PActivityUsersAttemptsPage_core_format_text_7_Template(t,e){if(1&t&&d.nrm(0,"core-format-text",9),2&t){const t=d.XpG();d.Y8G("text",t.h5pActivity.name)("contextInstanceId",t.h5pActivity.coursemodule)("courseId",t.courseId)}}function AddonModH5PActivityUsersAttemptsPage_ion_list_13_ion_item_16_span_9_Template(t,e){if(1&t&&(d.j41(0,"span"),d.EFF(1),d.nI1(2,"coreFormatDate"),d.k0s()),2&t){const t=d.XpG().$implicit;d.R7$(),d.SpI(" ",d.i5U(2,1,t.attempts[t.attempts.length-1].timemodified,"strftimedatetimeshort")," ")}}function AddonModH5PActivityUsersAttemptsPage_ion_list_13_ion_item_16_span_10_Template(t,e){1&t&&(d.j41(0,"span"),d.EFF(1,"-"),d.k0s())}function AddonModH5PActivityUsersAttemptsPage_ion_list_13_ion_item_16_span_12_Template(t,e){if(1&t&&(d.j41(0,"span"),d.EFF(1),d.nI1(2,"translate"),d.k0s()),2&t){const t=d.XpG().$implicit;d.R7$(),d.SpI(" ",d.i5U(2,1,"core.percentagenumber",d.eq3(4,users_attempts_c0,t.score))," ")}}function AddonModH5PActivityUsersAttemptsPage_ion_list_13_ion_item_16_span_13_Template(t,e){1&t&&(d.j41(0,"span"),d.EFF(1,"-"),d.k0s())}function AddonModH5PActivityUsersAttemptsPage_ion_list_13_ion_item_16_Template(t,e){if(1&t){const t=d.RV6();d.j41(0,"ion-item",15),d.nI1(1,"translate"),d.bIt("click",(function AddonModH5PActivityUsersAttemptsPage_ion_list_13_ion_item_16_Template_ion_item_click_0_listener(){const e=d.eBV(t).$implicit,n=d.XpG(2);return d.Njj(n.openUser(e))})),d.j41(2,"ion-label")(3,"ion-row",11)(4,"ion-col",12)(5,"p"),d.nrm(6,"core-user-avatar",16),d.k0s(),d.EFF(7),d.k0s(),d.j41(8,"ion-col",12),d.DNE(9,AddonModH5PActivityUsersAttemptsPage_ion_list_13_ion_item_16_span_9_Template,3,4,"span",6)(10,AddonModH5PActivityUsersAttemptsPage_ion_list_13_ion_item_16_span_10_Template,2,0,"span",6),d.k0s(),d.j41(11,"ion-col",13),d.DNE(12,AddonModH5PActivityUsersAttemptsPage_ion_list_13_ion_item_16_span_12_Template,3,6,"span",6)(13,AddonModH5PActivityUsersAttemptsPage_ion_list_13_ion_item_16_span_13_Template,2,0,"span",6),d.k0s(),d.j41(14,"ion-col",13),d.EFF(15),d.k0s()()()()}if(2&t){const t=e.$implicit,n=d.XpG(2);d.AVh("hide-detail",!t.attempts.length),d.Y8G("detail",!0)("button",t.attempts.length>0),d.BMQ("aria-label",d.i5U(1,13,"addon.mod_h5pactivity.review_user_attempts",d.eq3(16,users_attempts_c0,t.attempts.length))),d.R7$(6),d.Y8G("user",t.user)("courseId",n.courseId),d.R7$(),d.SpI(" ",t.user.fullname," "),d.R7$(2),d.Y8G("ngIf",t.attempts.length),d.R7$(),d.Y8G("ngIf",!t.attempts.length),d.R7$(2),d.Y8G("ngIf",void 0!==t.score),d.R7$(),d.Y8G("ngIf",void 0===t.score),d.R7$(2),d.SpI(" ",t.attempts.length," ")}}function AddonModH5PActivityUsersAttemptsPage_ion_list_13_Template(t,e){if(1&t&&(d.j41(0,"ion-list")(1,"ion-item",10)(2,"ion-label")(3,"ion-row",11)(4,"ion-col",12),d.EFF(5),d.nI1(6,"translate"),d.k0s(),d.j41(7,"ion-col",12),d.EFF(8),d.nI1(9,"translate"),d.k0s(),d.j41(10,"ion-col",13),d.EFF(11),d.nI1(12,"translate"),d.k0s(),d.j41(13,"ion-col",13),d.EFF(14),d.nI1(15,"translate"),d.k0s()()()(),d.DNE(16,AddonModH5PActivityUsersAttemptsPage_ion_list_13_ion_item_16_Template,16,18,"ion-item",14),d.k0s()),2&t){const t=d.XpG();d.R7$(),d.Y8G("detail",!0),d.R7$(4),d.JRh(d.bMT(6,6,"core.user")),d.R7$(3),d.JRh(d.bMT(9,8,"core.date")),d.R7$(3),d.JRh(d.bMT(12,10,"addon.mod_h5pactivity.score")),d.R7$(3),d.JRh(d.bMT(15,12,"addon.mod_h5pactivity.attempts")),d.R7$(2),d.Y8G("ngForOf",t.users)}}function AddonModH5PActivityUsersAttemptsPage_core_empty_box_14_Template(t,e){1&t&&(d.nrm(0,"core-empty-box",17),d.nI1(1,"translate")),2&t&&d.Y8G("message",d.bMT(1,1,"addon.mod_h5pactivity.noparticipants"))}let D=(()=>{var t;class AddonModH5PActivityUsersAttemptsPage{constructor(){var t=this;this.loaded=!1,this.users=[],this.fetchMoreUsersFailed=!1,this.canLoadMore=!1,this.page=0,this.logView=b.j.once((0,l.A)((function*(){t.h5pActivity&&(yield M.g.ignoreErrors(T.R.logViewReport(t.h5pActivity.id)),x.OF.logEvent({type:x.qr.VIEW_ITEM_LIST,ws:"mod_h5pactivity_log_report_viewed",name:t.h5pActivity.name,data:{id:t.h5pActivity.id,category:"h5pactivity"},url:`/mod/h5pactivity/report.php?a=${t.h5pActivity.id}`}))})))}ngOnInit(){var t=this;return(0,l.A)((function*(){try{t.courseId=I.CoreNavigator.getRequiredRouteNumberParam("courseId"),t.cmId=I.CoreNavigator.getRequiredRouteNumberParam("cmId")}catch(t){return p.CoreDomUtils.showErrorModal(t),I.CoreNavigator.back(),void 0}t.fetchData()}))()}doRefresh(t){this.refreshData().finally((()=>{t.complete()}))}fetchData(t){var e=this;return(0,l.A)((function*(){try{e.h5pActivity=yield T.R.getH5PActivity(e.courseId,e.cmId),yield Promise.all([e.fetchUsers(t)]),e.logView()}catch(t){p.CoreDomUtils.showErrorModalDefault(t,"Error loading attempts.")}finally{e.loaded=!0}}))()}fetchUsers(t){var e=this;return(0,l.A)((function*(){if(!e.h5pActivity)return;t&&(e.page=0);const n=yield T.R.getUsersAttempts(e.h5pActivity.id,{cmId:e.cmId,page:e.page}),o=yield e.formatUsers(e.h5pActivity,n.users);e.users=0===e.page?o:e.users.concat(o),e.canLoadMore=n.canLoadMore,e.page++}))()}formatUsers(t,e){var n=this;return(0,l.A)((function*(){return Promise.all(e.map(function(){var e=(0,l.A)((function*(e){var o;if(e.user=yield P.CoreUser.getProfile(e.userid,n.courseId,!0),0===t.grademethod);else if(2===t.grademethod){if(e.attempts.length){const t=e.attempts.reduce(((t,e)=>t+100*e.rawscore/e.maxscore),0);e.score=Math.round(t/e.attempts.length)}}else null!==(o=e.scored)&&void 0!==o&&o.attempts[0]&&(e.score=Math.round(100*e.scored.attempts[0].rawscore/e.scored.attempts[0].maxscore));return e}));return function(t){return e.apply(this,arguments)}}()))}))()}fetchMoreUsers(t){var e=this;return(0,l.A)((function*(){try{yield e.fetchUsers(!1)}catch(t){p.CoreDomUtils.showErrorModalDefault(t,"Error loading more users"),e.fetchMoreUsersFailed=!0}t()}))()}refreshData(){var t=this;return(0,l.A)((function*(){const e=[T.R.invalidateActivityData(t.courseId)];t.h5pActivity&&e.push(T.R.invalidateAllUsersAttempts(t.h5pActivity.id)),yield M.g.ignoreErrors(Promise.all(e)),yield t.fetchData(!0)}))()}openUser(t){t.attempts.length&&I.CoreNavigator.navigate(`../userattempts/${t.userid}`)}}return(t=AddonModH5PActivityUsersAttemptsPage).ɵfac=function AddonModH5PActivityUsersAttemptsPage_Factory(e){return new(e||t)},t.ɵcmp=d.VBU({type:t,selectors:[["page-addon-mod-h5pactivity-users-attempts"]],decls:16,vars:13,consts:[["slot","start"],[3,"text"],["contextLevel","module",3,"text","contextInstanceId","courseId",4,"ngIf"],["slot","fixed",3,"ionRefresh","disabled"],[3,"pullingText"],[3,"hideUntil"],[4,"ngIf"],["icon","fas-chart-bar",3,"message",4,"ngIf"],[3,"action","enabled","error"],["contextLevel","module",3,"text","contextInstanceId","courseId"],[1,"addon-mod_h5pactivity-table-header","hide-detail","font-bold",3,"detail"],[1,"ion-align-items-center"],["size","4",1,"ion-text-center"],["size","2",1,"ion-text-center"],["class","ion-text-wrap addon-mod_h5pactivity-table-row",3,"detail","hide-detail","button","click",4,"ngFor","ngForOf"],[1,"ion-text-wrap","addon-mod_h5pactivity-table-row",3,"click","detail","button"],[3,"user","courseId"],["icon","fas-chart-bar",3,"message"]],template:function AddonModH5PActivityUsersAttemptsPage_Template(t,e){1&t&&(d.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),d.nrm(3,"ion-back-button",1),d.nI1(4,"translate"),d.k0s(),d.j41(5,"ion-title")(6,"h1"),d.DNE(7,AddonModH5PActivityUsersAttemptsPage_core_format_text_7_Template,1,3,"core-format-text",2),d.k0s()()()(),d.j41(8,"ion-content")(9,"ion-refresher",3),d.bIt("ionRefresh",(function AddonModH5PActivityUsersAttemptsPage_Template_ion_refresher_ionRefresh_9_listener(t){return e.doRefresh(t.target)})),d.nrm(10,"ion-refresher-content",4),d.nI1(11,"translate"),d.k0s(),d.j41(12,"core-loading",5),d.DNE(13,AddonModH5PActivityUsersAttemptsPage_ion_list_13_Template,17,14,"ion-list",6)(14,AddonModH5PActivityUsersAttemptsPage_core_empty_box_14_Template,2,3,"core-empty-box",7),d.j41(15,"core-infinite-loading",8),d.bIt("action",(function AddonModH5PActivityUsersAttemptsPage_Template_core_infinite_loading_action_15_listener(t){return e.fetchMoreUsers(t)})),d.k0s()()()),2&t&&(d.R7$(3),d.Y8G("text",d.bMT(4,9,"core.back")),d.R7$(4),d.Y8G("ngIf",e.h5pActivity),d.R7$(2),d.Y8G("disabled",!e.loaded),d.R7$(),d.FS9("pullingText",d.bMT(11,11,"core.pulltorefresh")),d.R7$(2),d.Y8G("hideUntil",e.loaded),d.R7$(),d.Y8G("ngIf",e.users.length),d.R7$(),d.Y8G("ngIf",!e.users.length&&!e.canLoadMore),d.R7$(),d.Y8G("enabled",e.loaded&&e.canLoadMore)("error",e.fetchMoreUsersFailed))},dependencies:[$.Sq,$.bT,H.h,Y.b,k.R,F.T,u.B,h.i,v.QW,v.hU,v.W9,v.eU,v.uz,v.he,v.nf,v.To,v.Ki,v.ln,v.BC,v.ai,v.el,w.f,y.D9],styles:["[_nghost-%COMP%]   .addon-mod_h5pactivity-table-header[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]}),AddonModH5PActivityUsersAttemptsPage})();const O=[{path:":courseId/:cmId",component:f,canDeactivate:[a.V]},{path:":courseId/:cmId/userattempts/:userId",component:E},{path:":courseId/:cmId/attemptresults/:attemptId",component:j},{path:":courseId/:cmId/users",component:D}];let N=(()=>{var t;class AddonModH5PActivityLazyModule{}return(t=AddonModH5PActivityLazyModule).ɵfac=function AddonModH5PActivityLazyModule_Factory(e){return new(e||t)},t.ɵmod=d.$C({type:t}),t.ɵinj=d.G2t({imports:[o.iI.forChild(O),i.n,_]}),AddonModH5PActivityLazyModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&d.Obh(N,{declarations:[f,E,j,D],imports:[o.iI,i.n,_]}))}}]);