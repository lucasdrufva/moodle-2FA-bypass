"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2125,9522,7141],{92010:(e,t,s)=>{s.d(t,{E:()=>AddonModGlossaryEntriesSource});var r=s(10467),i=s(99522),n=s(21113),a=s(20119),o=s(59829);class AddonModGlossaryEntriesSource extends i.F{constructor(e,t,s){super(),this.isSearch=!1,this.hasSearched=!1,this.onlineEntries=[],this.offlineEntries=[],this.COURSE_ID=e,this.CM_ID=t,this.GLOSSARY_PATH_PREFIX=s}isOnlineEntry(e){return"id"in e}isOfflineEntry(e){return!this.isOnlineEntry(e)}getItemPath(e){return this.isOfflineEntry(e)?`${this.GLOSSARY_PATH_PREFIX}entry/new-${e.timecreated}`:`${this.GLOSSARY_PATH_PREFIX}entry/${e.id}`}getItemQueryParams(){return{cmId:this.CM_ID,courseId:this.COURSE_ID}}getPagesLoaded(){return null===this.items?0:Math.ceil(this.onlineEntries.length/this.getPageLength())}startSearch(){this.isSearch=!0,this.setDirty(!0)}stopSearch(e,t){this.fetchMode&&(this.isSearch=!1,this.hasSearched=!1,this.onlineEntries=e,this.hasMoreItems=t,this.setDirty(!0))}search(e){if(!this.glossary)return;const t=this.glossary.id;this.fetchFunction=s=>n.$.getEntriesBySearch(t,e,!0,s),this.fetchInvalidate=()=>n.$.invalidateEntriesBySearch(t,e,!0),this.hasSearched=!0,this.setDirty(!0)}loadGlossary(){var e=this;return(0,r.A)((function*(){e.glossary=yield n.$.getGlossary(e.COURSE_ID,e.CM_ID)}))()}invalidateCache(e=!0){var t=this;return(0,r.A)((function*(){yield Promise.all([t.fetchInvalidate&&t.fetchInvalidate(),e&&n.$.invalidateCourseGlossaries(t.COURSE_ID),e&&t.glossary&&n.$.invalidateCategories(t.glossary.id)])}))()}switchMode(e){if(!this.glossary)throw new Error("Can't switch entries mode without a glossary!");const t=this.glossary.id;switch(this.fetchMode=e,this.isSearch=!1,this.setDirty(!0),e){case"author_all":this.viewMode="author",this.fetchFunction=e=>n.$.getEntriesByAuthor(t,e),this.fetchInvalidate=()=>n.$.invalidateEntriesByAuthor(t);break;case"cat_all":this.viewMode="cat",this.fetchFunction=e=>n.$.getEntriesByCategory(t,e),this.fetchInvalidate=()=>n.$.invalidateEntriesByCategory(t);break;case"newest_first":this.viewMode="date",this.fetchFunction=e=>n.$.getEntriesByDate(t,"CREATION",e),this.fetchInvalidate=()=>n.$.invalidateEntriesByDate(t,"CREATION");break;case"recently_updated":this.viewMode="date",this.fetchFunction=e=>n.$.getEntriesByDate(t,"UPDATE",e),this.fetchInvalidate=()=>n.$.invalidateEntriesByDate(t,"UPDATE");break;default:this.viewMode="letter",this.fetchMode="letter_all",this.fetchFunction=e=>n.$.getEntriesByLetter(t,e),this.fetchInvalidate=()=>n.$.invalidateEntriesByLetter(t)}}loadPageItems(e){var t=this;return(0,r.A)((function*(){const s=t.glossary,r=t.fetchFunction;if(!s||!r)throw new Error("Can't load entries without glossary or fetch function");const i=[];if(0===e){const e=yield a.e.getGlossaryOfflineEntries(s.id);e.sort(((e,t)=>e.concept.localeCompare(t.concept))),i.push(...e)}const n=e*t.getPageLength(),o=yield r({from:n,cmId:t.CM_ID});return i.push(...o.entries),{items:i,hasMoreItems:n+o.entries.length<o.count}}))()}getPageLength(){return o.sT}setItems(e,t){this.onlineEntries=[],this.offlineEntries=[],e.forEach((e=>{this.isOnlineEntry(e)&&this.onlineEntries.push(e),this.isOfflineEntry(e)&&this.offlineEntries.push(e)})),super.setItems(e,t)}reset(){this.onlineEntries=[],this.offlineEntries=[],super.reset()}}},35716:(e,t,s)=>{s.d(t,{z:()=>CorePaginatedItemsManagerSource});var r=s(10467),i=s(58866);class CorePaginatedItemsManagerSource extends i.i{constructor(){super(...arguments),this.hasMoreItems=!0}isCompleted(){return!this.hasMoreItems}isEmpty(){var e;return!this.isLoaded()||0===(null!==(e=this.getItems())&&void 0!==e?e:[]).length}getPagesLoaded(){if(null===this.items)return 0;const e=this.getPageLength();return null===e?1:Math.ceil(this.items.length/e)}reset(){this.hasMoreItems=!0,super.reset()}reload(){var e=this;return(0,r.A)((function*(){e.dirty=!0,yield e.load()}))()}load(){var e=this;return(0,r.A)((function*(){var t;if(e.dirty){const{items:t,hasMoreItems:s}=yield e.loadPageItems(0);return e.dirty=!1,e.setItems(t,null!=s&&s),void 0}if(!e.hasMoreItems)return;const{items:s,hasMoreItems:r}=yield e.loadPageItems(e.getPagesLoaded());e.setItems((null!==(t=e.items)&&void 0!==t?t:[]).concat(s),null!=r&&r)}))()}getPageLength(){return null}setItems(e,t=!1){this.hasMoreItems=t,super.setItems(e)}}},99522:(e,t,s)=>{s.d(t,{F:()=>CoreRoutedItemsManagerSource});var r=s(35716);class CoreRoutedItemsManagerSource extends r.z{static getSourceId(...e){return e.map((e=>String(e))).join("-")}getItemQueryParams(e){return{}}}},83696:(e,t,s)=>{var r;s.d(t,{u:()=>CoreRoutedItemsManagerSourcesTracker});class CoreRoutedItemsManagerSourcesTracker{static getSource(e,t){var s,r;const i="string"==typeof t?t:e.getSourceId(...t);return null!==(s=null===(r=this.getConstructorInstances(e)[i])||void 0===r?void 0:r.instance)&&void 0!==s?s:null}static getOrCreateSource(e,t){var s;const r=e.getSourceId(...t);return null!==(s=this.getSource(e,r))&&void 0!==s?s:this.createInstance(r,e,t)}static addReference(e,t){const s=this.getConstructorInstances(e.constructor),r=this.instanceIds.get(e);void 0!==r&&(r in s||(s[r]={instance:e,references:[]}),s[r].references.push(t))}static removeReference(e,t){var s,r;const i=this.instances.get(e.constructor),n=this.instanceIds.get(e),a=null!==(s=null==i||null===(r=i[null!=n?n:""])||void 0===r?void 0:r.references.indexOf(t))&&void 0!==s?s:-1;i&&void 0!==n&&-1!==a&&(i[n].references.splice(a,1),0===i[n].references.length&&delete i[n])}static getConstructorInstances(e){var t;return null!==(t=this.instances.get(e))&&void 0!==t?t:this.initialiseConstructorInstances(e)}static initialiseConstructorInstances(e){const t={};return this.instances.set(e,t),t}static createInstance(e,t,s){const r=new t(...s);return this.instanceIds.set(r,e),r}}(r=CoreRoutedItemsManagerSourcesTracker).instances=new WeakMap,r.instanceIds=new WeakMap},95990:(e,t,s)=>{s.d(t,{u:()=>CoreRoutedItemsManager});var r=s(10467),i=s(15324),n=s(42022),a=s(83696);class CoreRoutedItemsManager extends n.f{setSource(e){this.source&&a.u.removeReference(this.source.instance,this),e&&a.u.addReference(e,this),super.setSource(e)}getSelectedItemPath(e){return e?this.getSelectedItemPathFromRoute(e):null}updateSelectedItem(e=null){var t,s,r,i;e=null!==(t=null!==(s=e)&&void 0!==s?s:this.getCurrentPageRoute())&&void 0!==t?t:null;const n=this.getSelectedItemPath(e),a=n&&null!==(r=null===(i=this.itemsMap)||void 0===i?void 0:i[n])&&void 0!==r?r:null;this.setSelectedItem(a)}navigateToItem(e,t={}){var s=this;return(0,r.A)((function*(){const r=s.getCurrentPageRoute();if(null===r)return;const n=s.getSource().getItemPath(e),a=s.getSelectedItemPath(r);if(a===n)return;const o=s.getSource().getItemQueryParams(e),c=a?a.split("/").fill("../").join(""):"";yield i.CoreNavigator.navigate(c+n,{params:o,...t})}))()}navigateToIndex(e={}){var t=this;return(0,r.A)((function*(){const s=t.getCurrentPageRoute();if(null===s)return;const r=t.getSelectedItemPath(s);if(null===r)return;const n=r?r.split("/").fill("../").join(""):"";yield i.CoreNavigator.navigate(n,e)}))()}onSourceItemsUpdated(e){super.onSourceItemsUpdated(e);const t=this.selectedItem;null!==t&&e.some((e=>e===t))||this.updateSelectedItem()}getItemId(e){return this.getSource().getItemPath(e)}}}}]);