"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5382],{75382:(e,n,t)=>{t.r(n),t.d(n,{default:()=>B});var o=t(21182),a=t(94114),i=t(93417),r=t(3353),c=t(10467),l=t(89911),s=t(15324),p=t(52266),d=t(83696),m=t(99522),_=t(49697),u=t(41140),g=t(8657),f=t(55351);class AddonCompetencyPlansSource extends m.F{static getSourceId(e){return e?String(e):"current-user"}constructor(e){super(),this.USER_ID=e}getItemPath(e){return`${e.id}/${_.f$}`}getItemQueryParams(){return this.USER_ID?{userId:this.USER_ID}:{}}invalidateCache(){var e=this;return(0,c.A)((function*(){yield u.AddonCompetency.invalidateLearningPlans(e.USER_ID)}))()}loadPageItems(){var e=this;return(0,c.A)((function*(){const n=yield u.AddonCompetency.getLearningPlans(e.USER_ID);return n.forEach((e=>{switch(e.statusname=g.AddonCompetencyHelper.getPlanStatusName(e.status),e.status){case u.AddonCompetencyProvider.STATUS_ACTIVE:e.statuscolor=f.$.SUCCESS;break;case u.AddonCompetencyProvider.STATUS_COMPLETE:e.statuscolor=f.$.DANGER;break;default:e.statuscolor=f.$.WARNING}})),{items:n}}))()}}var y=t(2401),P=t(71852),h=t(22693),I=t(24742),C=t(54438),R=t(60177),b=t(64422),$=t(49234),A=t(16658),T=t(58197),G=t(28988),k=t(88246),x=t(73465),E=t(59528),F=t(73955);const _c0=(e,n)=>({x:e,y:n}),_c1=e=>({$a:e});function AddonCompetencyPlanPage_h1_6_Template(e,n){if(1&e&&(C.j41(0,"h1"),C.nrm(1,"core-format-text",7),C.k0s()),2&e){const e=C.XpG();C.R7$(),C.Y8G("text",e.plan.plan.name)("contextInstanceId",e.plan.plan.userid)}}function AddonCompetencyPlanPage_ion_card_12_Template(e,n){if(1&e&&(C.j41(0,"ion-card")(1,"ion-item",8)(2,"ion-label"),C.nrm(3,"core-user-avatar",9),C.j41(4,"p",10),C.EFF(5),C.k0s()()()()),2&e){const e=C.XpG();C.R7$(3),C.Y8G("user",e.user),C.R7$(2),C.JRh(e.user.fullname)}}function AddonCompetencyPlanPage_ion_card_13_ion_item_2_Template(e,n){if(1&e&&(C.j41(0,"ion-item",8)(1,"ion-label")(2,"p"),C.nrm(3,"core-format-text",7),C.k0s()()()),2&e){const e=C.XpG(2);C.R7$(3),C.Y8G("text",e.plan.plan.description)("contextInstanceId",e.plan.plan.userid)}}function AddonCompetencyPlanPage_ion_card_13_ion_item_10_Template(e,n){if(1&e&&(C.j41(0,"ion-item",8)(1,"ion-label")(2,"p",10),C.EFF(3),C.nI1(4,"translate"),C.k0s(),C.j41(5,"p"),C.EFF(6),C.nI1(7,"coreFormatDate"),C.k0s()()()),2&e){const e=C.XpG(2);C.R7$(3),C.JRh(C.bMT(4,2,"addon.competency.duedate")),C.R7$(3),C.JRh(C.bMT(7,4,1e3*e.plan.plan.duedate))}}function AddonCompetencyPlanPage_ion_card_13_ion_item_11_Template(e,n){if(1&e&&(C.j41(0,"ion-item",8)(1,"ion-label")(2,"p",10),C.EFF(3),C.nI1(4,"translate"),C.k0s(),C.j41(5,"p"),C.nrm(6,"core-format-text",14),C.k0s()()()),2&e){const e=C.XpG(2);C.R7$(3),C.JRh(C.bMT(4,3,"addon.competency.template")),C.R7$(3),C.Y8G("text",e.plan.plan.template.shortname)("contextInstanceId",0)}}function AddonCompetencyPlanPage_ion_card_13_Template(e,n){if(1&e&&(C.j41(0,"ion-card")(1,"ion-list"),C.DNE(2,AddonCompetencyPlanPage_ion_card_13_ion_item_2_Template,4,2,"ion-item",11),C.j41(3,"ion-item",8)(4,"ion-label")(5,"p",10),C.EFF(6),C.nI1(7,"translate"),C.k0s(),C.j41(8,"p"),C.EFF(9),C.k0s()()(),C.DNE(10,AddonCompetencyPlanPage_ion_card_13_ion_item_10_Template,8,6,"ion-item",11)(11,AddonCompetencyPlanPage_ion_card_13_ion_item_11_Template,7,5,"ion-item",11),C.j41(12,"ion-item",8)(13,"ion-label",12)(14,"p",10),C.EFF(15),C.nI1(16,"translate"),C.k0s(),C.j41(17,"p"),C.EFF(18),C.nI1(19,"translate"),C.k0s(),C.nrm(20,"core-progress-bar",13),C.k0s()()()()),2&e){const e=C.XpG();C.R7$(2),C.Y8G("ngIf",e.plan.plan.description),C.R7$(4),C.JRh(C.bMT(7,13,"addon.competency.status")),C.R7$(3),C.JRh(e.plan.plan.statusname),C.R7$(),C.Y8G("ngIf",e.plan.plan.duedate>0),C.R7$(),C.Y8G("ngIf",e.plan.plan.template),C.R7$(2),C.Mz_("id","addon-competency-plan-",e.plan.plan.id,"-progress"),C.R7$(2),C.JRh(C.bMT(16,15,"addon.competency.progress")),C.R7$(3),C.SpI(" ",C.i5U(19,17,"addon.competency.xcompetenciesproficientoutofy",C.eq3(23,_c1,C.l_i(20,_c0,e.plan.proficientcompetencycount,e.plan.competencycount)))," "),C.R7$(2),C.Mz_("ariaDescribedBy","addon-competency-plan-",e.plan.plan.id,"-progress"),C.Y8G("progress",e.plan.proficientcompetencypercentage)("text",e.plan.proficientcompetencypercentageformatted)}}function AddonCompetencyPlanPage_ion_card_14_ion_item_6_Template(e,n){1&e&&(C.j41(0,"ion-item",8)(1,"ion-label")(2,"p"),C.EFF(3),C.nI1(4,"translate"),C.k0s()()()),2&e&&(C.R7$(3),C.JRh(C.bMT(4,1,"addon.competency.nocompetencies")))}function AddonCompetencyPlanPage_ion_card_14_ion_item_7_ion_badge_6_Template(e,n){if(1&e&&(C.j41(0,"ion-badge",18),C.EFF(1),C.k0s()),2&e){const e=C.XpG().$implicit;C.Y8G("color",e.usercompetencyplan.proficiency?"success":"danger"),C.R7$(),C.SpI(" ",e.usercompetencyplan.gradename," ")}}function AddonCompetencyPlanPage_ion_card_14_ion_item_7_ion_badge_7_Template(e,n){if(1&e&&(C.j41(0,"ion-badge",18),C.EFF(1),C.k0s()),2&e){const e=C.XpG().$implicit;C.Y8G("color",e.usercompetency.proficiency?"success":"danger"),C.R7$(),C.SpI(" ",e.usercompetency.gradename," ")}}function AddonCompetencyPlanPage_ion_card_14_ion_item_7_Template(e,n){if(1&e){const e=C.RV6();C.j41(0,"ion-item",16),C.bIt("click",(function AddonCompetencyPlanPage_ion_card_14_ion_item_7_Template_ion_item_click_0_listener(){const n=C.eBV(e).$implicit,t=C.XpG(2);return C.Njj(t.competencies.select(n))})),C.j41(1,"ion-label")(2,"p",10),C.nrm(3,"core-format-text",7),C.j41(4,"em"),C.EFF(5),C.k0s()()(),C.DNE(6,AddonCompetencyPlanPage_ion_card_14_ion_item_7_ion_badge_6_Template,2,2,"ion-badge",17)(7,AddonCompetencyPlanPage_ion_card_14_ion_item_7_ion_badge_7_Template,2,2,"ion-badge",17),C.k0s()}if(2&e){const e=n.$implicit,t=C.XpG(2);C.Y8G("detail",!0),C.BMQ("aria-label",e.competency.shortname),C.R7$(3),C.Y8G("text",e.competency.shortname)("contextInstanceId",t.plan.plan.userid),C.R7$(2),C.JRh(e.competency.idnumber),C.R7$(),C.Y8G("ngIf",e.usercompetencyplan),C.R7$(),C.Y8G("ngIf",!e.usercompetencyplan)}}function AddonCompetencyPlanPage_ion_card_14_Template(e,n){if(1&e&&(C.j41(0,"ion-card")(1,"ion-card-header",8)(2,"ion-card-title"),C.EFF(3),C.nI1(4,"translate"),C.k0s()(),C.j41(5,"ion-list"),C.DNE(6,AddonCompetencyPlanPage_ion_card_14_ion_item_6_Template,5,3,"ion-item",11)(7,AddonCompetencyPlanPage_ion_card_14_ion_item_7_Template,8,7,"ion-item",15),C.k0s()()),2&e){const e=C.XpG();C.R7$(3),C.JRh(C.bMT(4,3,"addon.competency.learningplancompetencies")),C.R7$(3),C.Y8G("ngIf",0===e.plan.competencycount),C.R7$(),C.Y8G("ngForOf",e.competencies.items)}}let L=(()=>{var e;class AddonCompetencyPlanPage{constructor(){this.logView=I.j.once((()=>this.performLogView()));try{const e=s.CoreNavigator.getRequiredRouteNumberParam("planId"),n=s.CoreNavigator.getRouteNumberParam("userId"),t=d.u.getOrCreateSource(AddonCompetencyPlansSource,[n]),o=d.u.getOrCreateSource(P.P,[e]);this.competencies=new y.R(o,AddonCompetencyPlanPage),this.plans=new p.Z(t)}catch(e){return l.CoreDomUtils.showErrorModal(e),s.CoreNavigator.back(),void 0}}get plan(){return this.competencies.getSource().plan}get user(){return this.competencies.getSource().user}ngOnInit(){var e=this;return(0,c.A)((function*(){yield e.fetchLearningPlan(),yield e.plans.start(),yield e.competencies.start()}))()}ngOnDestroy(){this.plans.destroy(),this.competencies.destroy()}fetchLearningPlan(){var e=this;return(0,c.A)((function*(){try{yield e.competencies.getSource().reload(),e.logView()}catch(e){l.CoreDomUtils.showErrorModalDefault(e,"Error getting learning plan data.")}}))()}refreshLearningPlan(e){var n=this;return(0,c.A)((function*(){yield n.competencies.getSource().invalidateCache(),n.fetchLearningPlan().finally((()=>{null==e||e.complete()}))}))()}performLogView(){if(!this.plan)return;const e=this.competencies.getSource().PLAN_ID;h.OF.logEvent({type:h.qr.VIEW_ITEM_LIST,ws:"tool_lp_data_for_plan_page",name:this.plan.plan.name,data:{category:"competency",planid:e},url:`/admin/tool/lp/coursecompetencies.php?id=${e}`})}}return(e=AddonCompetencyPlanPage).ɵfac=function AddonCompetencyPlanPage_Factory(n){return new(n||e)},e.ɵcmp=C.VBU({type:e,selectors:[["page-addon-competency-plan"]],decls:15,vars:13,consts:[["slot","start"],[3,"text"],[4,"ngIf"],[1,"limited-width",3,"core-swipe-navigation"],["slot","fixed",3,"ionRefresh","disabled"],[3,"pullingText"],[3,"hideUntil"],["contextLevel","user",3,"text","contextInstanceId"],[1,"ion-text-wrap"],["slot","start",3,"user"],[1,"item-heading"],["class","ion-text-wrap",4,"ngIf"],[3,"id"],[3,"progress","text","ariaDescribedBy"],["contextLevel","system",3,"text","contextInstanceId"],["class","ion-text-wrap","button","",3,"detail","click",4,"ngFor","ngForOf"],["button","",1,"ion-text-wrap",3,"click","detail"],["slot","end",3,"color",4,"ngIf"],["slot","end",3,"color"]],template:function AddonCompetencyPlanPage_Template(e,n){1&e&&(C.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),C.nrm(3,"ion-back-button",1),C.nI1(4,"translate"),C.k0s(),C.j41(5,"ion-title"),C.DNE(6,AddonCompetencyPlanPage_h1_6_Template,2,2,"h1",2),C.k0s()()(),C.j41(7,"ion-content",3)(8,"ion-refresher",4),C.bIt("ionRefresh",(function AddonCompetencyPlanPage_Template_ion_refresher_ionRefresh_8_listener(e){return n.refreshLearningPlan(e.target)})),C.nrm(9,"ion-refresher-content",5),C.nI1(10,"translate"),C.k0s(),C.j41(11,"core-loading",6),C.DNE(12,AddonCompetencyPlanPage_ion_card_12_Template,6,2,"ion-card",2)(13,AddonCompetencyPlanPage_ion_card_13_Template,21,25,"ion-card",2)(14,AddonCompetencyPlanPage_ion_card_14_Template,8,5,"ion-card",2),C.k0s()()),2&e&&(C.R7$(3),C.Y8G("text",C.bMT(4,9,"core.back")),C.R7$(3),C.Y8G("ngIf",n.plan),C.R7$(),C.Y8G("core-swipe-navigation",n.plans),C.R7$(),C.Y8G("disabled",!n.competencies.loaded),C.R7$(),C.FS9("pullingText",C.bMT(10,11,"core.pulltorefresh")),C.R7$(2),C.Y8G("hideUntil",n.competencies.loaded),C.R7$(),C.Y8G("ngIf",n.user),C.R7$(),C.Y8G("ngIf",n.plan),C.R7$(),C.Y8G("ngIf",n.plan))},dependencies:[R.Sq,R.bT,b.R,$.z,A.T,T.B,G.n,k.i,x.In,x.QW,x.b_,x.ME,x.tN,x.W9,x.eU,x.uz,x.he,x.nf,x.To,x.Ki,x.BC,x.ai,x.el,E.f,F.D9],encapsulation:2}),AddonCompetencyPlanPage})();var j=t(29492),v=t(52749),S=t(79555),w=t(16986);function AddonCompetencyPlanListPage_core_empty_box_15_Template(e,n){1&e&&(C.nrm(0,"core-empty-box",7),C.nI1(1,"translate")),2&e&&C.Y8G("message",C.bMT(1,1,"addon.competency.noplanswerecreated"))}function AddonCompetencyPlanListPage_ion_list_16_ion_item_1_p_4_Template(e,n){if(1&e&&(C.j41(0,"p"),C.EFF(1),C.nI1(2,"translate"),C.nI1(3,"coreFormatDate"),C.k0s()),2&e){const e=C.XpG().$implicit;C.R7$(),C.Lme(" ",C.bMT(2,2,"addon.competency.duedate"),":  ",C.i5U(3,4,1e3*e.duedate,"strftimedatetimeshort")," ")}}function AddonCompetencyPlanListPage_ion_list_16_ion_item_1_Template(e,n){if(1&e){const e=C.RV6();C.j41(0,"ion-item",10),C.bIt("click",(function AddonCompetencyPlanListPage_ion_list_16_ion_item_1_Template_ion_item_click_0_listener(){const n=C.eBV(e).$implicit,t=C.XpG(2);return C.Njj(t.plans.select(n))})),C.j41(1,"ion-label")(2,"p",11),C.nrm(3,"core-format-text",12),C.k0s(),C.DNE(4,AddonCompetencyPlanListPage_ion_list_16_ion_item_1_p_4_Template,4,7,"p",13),C.k0s(),C.j41(5,"ion-badge",14),C.EFF(6),C.k0s()()}if(2&e){const e=n.$implicit,t=C.XpG(2);C.Y8G("detail",!0),C.BMQ("aria-label",e.name)("aria-current",t.plans.getItemAriaCurrent(e)),C.R7$(3),C.Y8G("text",e.name)("contextInstanceId",e.userid),C.R7$(),C.Y8G("ngIf",e.duedate>0),C.R7$(),C.Y8G("color",e.statuscolor),C.R7$(),C.JRh(e.statusname)}}function AddonCompetencyPlanListPage_ion_list_16_Template(e,n){if(1&e&&(C.j41(0,"ion-list",8),C.DNE(1,AddonCompetencyPlanListPage_ion_list_16_ion_item_1_Template,7,8,"ion-item",9),C.k0s()),2&e){const e=C.XpG();C.R7$(),C.Y8G("ngForOf",e.plans.items)}}let M=(()=>{var e;class AddonCompetencyPlanListPage{constructor(){var e;const n=null!==(e=s.CoreNavigator.getRouteNumberParam("userId"))&&void 0!==e?e:v.CoreSites.getCurrentSiteUserId(),t=d.u.getOrCreateSource(AddonCompetencyPlansSource,[n]);this.plans=new y.R(t,AddonCompetencyPlanListPage),this.logView=I.j.once((0,c.A)((function*(){h.OF.logEvent({type:h.qr.VIEW_ITEM_LIST,ws:"tool_lp_data_for_plans_page",name:S.HT.instant("addon.competency.userplans"),data:{userid:n},url:`/admin/tool/lp/plans.php?userid=${n}`})})))}ngAfterViewInit(){var e=this;return(0,c.A)((function*(){yield e.fetchLearningPlans(),e.plans.start(e.splitView)}))()}fetchLearningPlans(){var e=this;return(0,c.A)((function*(){try{yield e.plans.load(),e.logView()}catch(e){l.CoreDomUtils.showErrorModalDefault(e,"Error getting learning plans data.")}}))()}refreshLearningPlans(e){var n=this;return(0,c.A)((function*(){yield n.plans.getSource().invalidateCache(),n.plans.getSource().setDirty(!0),n.fetchLearningPlans().finally((()=>{null==e||e.complete()}))}))()}ngOnDestroy(){this.plans.destroy()}}return(e=AddonCompetencyPlanListPage).ɵfac=function AddonCompetencyPlanListPage_Factory(n){return new(n||e)},e.ɵcmp=C.VBU({type:e,selectors:[["page-addon-competency-planlist"]],viewQuery:function AddonCompetencyPlanListPage_Query(e,n){if(1&e&&C.GBs(j.M,5),2&e){let e;C.mGM(e=C.lsd())&&(n.splitView=e.first)}},decls:17,vars:13,consts:[["slot","start"],[3,"text"],["slot","fixed",3,"ionRefresh","disabled"],[3,"pullingText"],[3,"hideUntil"],["icon","fas-route",3,"message",4,"ngIf"],["class","ion-no-margin",4,"ngIf"],["icon","fas-route",3,"message"],[1,"ion-no-margin"],["class","ion-text-wrap","button","",3,"detail","click",4,"ngFor","ngForOf"],["button","",1,"ion-text-wrap",3,"click","detail"],[1,"item-heading"],["contextLevel","user",3,"text","contextInstanceId"],[4,"ngIf"],["slot","end",1,"ion-text-wrap",3,"color"]],template:function AddonCompetencyPlanListPage_Template(e,n){1&e&&(C.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),C.nrm(3,"ion-back-button",1),C.nI1(4,"translate"),C.k0s(),C.j41(5,"ion-title")(6,"h1"),C.EFF(7),C.nI1(8,"translate"),C.k0s()()()(),C.j41(9,"ion-content")(10,"core-split-view")(11,"ion-refresher",2),C.bIt("ionRefresh",(function AddonCompetencyPlanListPage_Template_ion_refresher_ionRefresh_11_listener(e){return n.refreshLearningPlans(e.target)})),C.nrm(12,"ion-refresher-content",3),C.nI1(13,"translate"),C.k0s(),C.j41(14,"core-loading",4),C.DNE(15,AddonCompetencyPlanListPage_core_empty_box_15_Template,2,3,"core-empty-box",5)(16,AddonCompetencyPlanListPage_ion_list_16_Template,2,1,"ion-list",6),C.k0s()()()),2&e&&(C.R7$(3),C.Y8G("text",C.bMT(4,7,"core.back")),C.R7$(4),C.JRh(C.bMT(8,9,"addon.competency.userplans")),C.R7$(4),C.Y8G("disabled",!n.plans.loaded),C.R7$(),C.FS9("pullingText",C.bMT(13,11,"core.pulltorefresh")),C.R7$(2),C.Y8G("hideUntil",n.plans.loaded),C.R7$(),C.Y8G("ngIf",n.plans.empty),C.R7$(),C.Y8G("ngIf",!n.plans.empty))},dependencies:[R.Sq,R.bT,w.h,b.R,j.M,T.B,k.i,x.In,x.QW,x.W9,x.eU,x.uz,x.he,x.nf,x.To,x.Ki,x.BC,x.ai,x.el,E.f,F.D9],encapsulation:2}),AddonCompetencyPlanListPage})();var Y=t(52639),D=t(139),N=t(77876),U=t(47248),V=t(37811),O=t(91784);const X=[{path:"",component:M,children:[{path:`:planId/${_.f$}`,component:L}]},{path:`:planId/${_.f$}`,component:V.m,children:[{path:":competencyId",component:Y.C}]}],J=[...(0,a.VI)([{path:"",pathMatch:"full",component:M},{path:`:planId/${_.f$}`,component:L},{path:`:planId/${_.f$}/:competencyId`,component:Y.C}],(()=>i.CoreScreen.isMobile)),...(0,a.VI)(X,(()=>i.CoreScreen.isTablet)),{path:`:planId/${_.f$}/:competencyId/${_.kO}`,component:D._}];let B=(()=>{var e;class AddonCompetencyLearningPlansLazyModule{}return(e=AddonCompetencyLearningPlansLazyModule).ɵfac=function AddonCompetencyLearningPlansLazyModule_Factory(n){return new(n||e)},e.ɵmod=C.$C({type:e}),e.ɵinj=C.G2t({imports:[o.iI.forChild(J),r.n,O.y,N.a,U.Q]}),AddonCompetencyLearningPlansLazyModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&C.Obh(B,{declarations:[L,M],imports:[o.iI,r.n,O.y,N.a,U.Q]}))}}]);