"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4715],{24715:(e,t,n)=>{n.r(t),n.d(t,{default:()=>E});var i=n(54438),r=n(21182),o=n(3353),s=n(94114),a=n(93417),l=n(10467),c=n(49882),g=n(52749),d=n(15324),_=n(29492),h=n(2401),f=n(83696),m=n(87455),u=n(89911),p=n(94455),C=n(79555),S=n(74431),b=n(85190),P=n(99522),I=n(63196);class CoreSettingsHandlersSource extends P.F{constructor(){super(...arguments),this.handlers=[]}loadPageItems(){var e=this;return(0,l.A)((function*(){return e.handlers=I.CoreSettingsDelegate.getHandlers(),{items:e.handlers.filter((e=>"page"in e))}}))()}getItemPath(e){return e.page}getItemQueryParams(e){return e.params||{}}}var y=n(45433),T=n(60177),k=n(76954),R=n(64422),w=n(86198),M=n(88246),v=n(43570),$=n(89417),G=n(73465),D=n(73955);function CoreSitePreferencesPage_ion_item_17_ion_icon_2_Template(e,t){if(1&e&&i.nrm(0,"ion-icon",16),2&e){const e=i.XpG().$implicit;i.Y8G("name",e.icon)}}function CoreSitePreferencesPage_ion_item_17_ion_toggle_7_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"ion-toggle",17),i.mxI("ngModelChange",(function CoreSitePreferencesPage_ion_item_17_ion_toggle_7_Template_ion_toggle_ngModelChange_0_listener(t){i.eBV(e);const n=i.XpG().$implicit;return i.DH7(n.toggleChecked,t)||(n.toggleChecked=t),i.Njj(t)})),i.bIt("ionChange",(function CoreSitePreferencesPage_ion_item_17_ion_toggle_7_Template_ion_toggle_ionChange_0_listener(t){i.eBV(e);const n=i.XpG().$implicit;return i.Njj(n.toggle(t.detail.checked))})),i.k0s()}if(2&e){const e=i.XpG().$implicit;i.R50("ngModel",e.toggleChecked)}}function CoreSitePreferencesPage_ion_item_17_Template(e,t){if(1&e){const e=i.RV6();i.j41(0,"ion-item",13),i.nI1(1,"translate"),i.bIt("click",(function CoreSitePreferencesPage_ion_item_17_Template_ion_item_click_0_listener(){const t=i.eBV(e).$implicit,n=i.XpG();return i.Njj(!t.toggle&&n.handlers.select(t))})),i.DNE(2,CoreSitePreferencesPage_ion_item_17_ion_icon_2_Template,1,1,"ion-icon",14),i.j41(3,"ion-label")(4,"p",8),i.EFF(5),i.nI1(6,"translate"),i.k0s()(),i.DNE(7,CoreSitePreferencesPage_ion_item_17_ion_toggle_7_Template,1,1,"ion-toggle",15),i.k0s()}if(2&e){const e=t.$implicit,n=i.XpG();i.Y8G("ngClass",e.class)("button",!e.toggle)("detail",!e.toggle),i.BMQ("aria-label",i.bMT(1,8,e.title))("aria-current",n.handlers.getItemAriaCurrent(e)),i.R7$(2),i.Y8G("ngIf",e.icon),i.R7$(3),i.JRh(i.bMT(6,10,e.title)),i.R7$(2),i.Y8G("ngIf",e.toggle)}}function CoreSitePreferencesPage_ion_item_31_ng_container_3_Template(e,t){1&e&&(i.qex(0),i.EFF(1),i.nI1(2,"translate"),i.bVm()),2&e&&(i.R7$(),i.SpI(" ",i.bMT(2,1,"core.settings.connectwifitosync"),""))}function CoreSitePreferencesPage_ion_item_31_ng_container_4_Template(e,t){1&e&&(i.qex(0),i.EFF(1),i.nI1(2,"translate"),i.bVm()),2&e&&(i.R7$(),i.JRh(i.bMT(2,1,"core.settings.connecttosync")))}function CoreSitePreferencesPage_ion_item_31_Template(e,t){if(1&e&&(i.j41(0,"ion-item",18),i.nrm(1,"ion-icon",19),i.j41(2,"ion-label"),i.DNE(3,CoreSitePreferencesPage_ion_item_31_ng_container_3_Template,3,3,"ng-container",20)(4,CoreSitePreferencesPage_ion_item_31_ng_container_4_Template,3,3,"ng-container",20),i.k0s()()),2&e){const e=i.XpG();i.R7$(3),i.Y8G("ngIf",e.isOnline&&e.dataSaver&&e.limitedConnection),i.R7$(),i.Y8G("ngIf",!e.isOnline)}}let O=(()=>{var e;class CoreSitePreferencesPage{get handlerItems(){return this.handlers.getSource().handlers}constructor(){this.dataSaver=!1,this.limitedConnection=!1,this.isOnline=!0,this.isDestroyed=!1,this.siteId=g.CoreSites.getCurrentSiteId();const e=f.u.getOrCreateSource(CoreSettingsHandlersSource,[]);this.handlers=new h.R(e,CoreSitePreferencesPage),this.sitesObserver=c.z.on(c.z.SITE_UPDATED,(()=>{this.refreshData()}),this.siteId),this.isOnline=p.WE.isOnline(),this.limitedConnection=this.isOnline&&p.WE.isNetworkAccessLimited(),this.networkObserver=p.WE.onChange().subscribe((()=>{C.SK.run((()=>{this.isOnline=p.WE.isOnline(),this.limitedConnection=this.isOnline&&p.WE.isNetworkAccessLimited()}))}))}ngAfterViewInit(){var e=this;return(0,l.A)((function*(){e.dataSaver=yield b.CoreConfig.get(S.CoreConstants.SETTINGS_SYNC_ONLY_ON_WIFI,!0);const t=d.CoreNavigator.getRouteParam("page");try{yield e.fetchData()}finally{const n=t?e.handlers.items.find((e=>e.page==t)):void 0;n?(e.handlers.watchSplitViewOutlet(e.splitView),yield e.handlers.select(n)):yield e.handlers.start(e.splitView)}}))()}fetchData(){var e=this;return(0,l.A)((function*(){yield e.handlers.load()}))()}synchronize(){var e=this;return(0,l.A)((function*(){try{yield m.CoreSettingsHelper.synchronizeSite(!1,e.siteId),y.CoreToasts.show({message:"core.settings.sitesynccompleted",translateMessage:!0})}catch(t){if(e.isDestroyed)return;u.CoreDomUtils.showErrorModalDefault(t,"core.settings.sitesyncfailed",!0)}}))()}isSynchronizing(){return!!m.CoreSettingsHelper.getSiteSyncPromise(this.siteId)}refreshData(e){this.handlers.getSource().setDirty(!0),this.fetchData().finally((()=>{null==e||e.complete()}))}ngOnDestroy(){this.isDestroyed=!0,this.sitesObserver.off(),this.networkObserver.unsubscribe(),this.handlers.destroy()}}return(e=CoreSitePreferencesPage).ɵfac=function CoreSitePreferencesPage_Factory(t){return new(t||e)},e.ɵcmp=i.VBU({type:e,selectors:[["page-core-site-preferences"]],viewQuery:function CoreSitePreferencesPage_Query(e,t){if(1&e&&i.GBs(_.M,5),2&e){let e;i.mGM(e=i.lsd())&&(t.splitView=e.first)}},decls:32,vars:24,consts:[["slot","start"],[3,"text"],["slot","end"],["slot","fixed",3,"ionRefresh","disabled"],[3,"pullingText"],[3,"hideUntil"],["class","core-settings-handler","lines","none",3,"ngClass","button","detail","click",4,"ngFor","ngForOf"],[1,"ion-text-wrap"],[1,"item-heading"],["slot","end",3,"loading"],["fill","clear",3,"click","ariaLabel","disabled"],["name","fas-rotate","slot","icon-only","aria-hidden","true"],["class","core-warning-item ion-text-wrap",4,"ngIf"],["lines","none",1,"core-settings-handler",3,"click","ngClass","button","detail"],["slot","start","aria-hidden","true",3,"name",4,"ngIf"],["slot","end",3,"ngModel","ngModelChange","ionChange",4,"ngIf"],["slot","start","aria-hidden","true",3,"name"],["slot","end",3,"ngModelChange","ionChange","ngModel"],[1,"core-warning-item","ion-text-wrap"],["name","fas-triangle-exclamation","slot","start","aria-hidden","true"],[4,"ngIf"]],template:function CoreSitePreferencesPage_Template(e,t){1&e&&(i.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),i.nrm(3,"ion-back-button",1),i.nI1(4,"translate"),i.k0s(),i.j41(5,"ion-title")(6,"h1"),i.EFF(7),i.nI1(8,"translate"),i.k0s()(),i.nrm(9,"ion-buttons",2),i.k0s()(),i.j41(10,"ion-content")(11,"core-split-view")(12,"ion-refresher",3),i.bIt("ionRefresh",(function CoreSitePreferencesPage_Template_ion_refresher_ionRefresh_12_listener(e){return t.refreshData(e.target)})),i.nrm(13,"ion-refresher-content",4),i.nI1(14,"translate"),i.k0s(),i.j41(15,"core-loading",5)(16,"ion-list"),i.DNE(17,CoreSitePreferencesPage_ion_item_17_Template,8,12,"ion-item",6),i.k0s(),i.j41(18,"ion-card")(19,"ion-item",7)(20,"ion-label")(21,"p",8),i.EFF(22),i.nI1(23,"translate"),i.k0s(),i.j41(24,"p"),i.EFF(25),i.nI1(26,"translate"),i.k0s()(),i.j41(27,"core-button-with-spinner",9)(28,"ion-button",10),i.nI1(29,"translate"),i.bIt("click",(function CoreSitePreferencesPage_Template_ion_button_click_28_listener(){return t.synchronize()})),i.nrm(30,"ion-icon",11),i.k0s()()(),i.DNE(31,CoreSitePreferencesPage_ion_item_31_Template,5,2,"ion-item",12),i.k0s()()()()),2&e&&(i.R7$(3),i.Y8G("text",i.bMT(4,12,"core.back")),i.R7$(4),i.JRh(i.bMT(8,14,"core.settings.preferences")),i.R7$(5),i.Y8G("disabled",!t.handlers.loaded),i.R7$(),i.FS9("pullingText",i.bMT(14,16,"core.pulltorefresh")),i.R7$(2),i.Y8G("hideUntil",t.handlers.loaded),i.R7$(2),i.Y8G("ngForOf",t.handlerItems),i.R7$(5),i.JRh(i.bMT(23,18,"core.settings.synchronizenow")),i.R7$(3),i.SpI(" ",i.bMT(26,20,"core.settings.synchronizenowhelp")," "),i.R7$(2),i.Y8G("loading",t.isSynchronizing()),i.R7$(),i.Y8G("ariaLabel",i.bMT(29,22,"core.settings.synchronizenow"))("disabled",!t.isOnline||t.dataSaver&&t.limitedConnection),i.R7$(3),i.Y8G("ngIf",!t.isOnline||t.dataSaver&&t.limitedConnection))},dependencies:[T.YU,T.Sq,T.bT,k.q,R.R,_.M,w.t,M.i,v.T,$.BC,$.vS,G.Jm,G.QW,G.b_,G.W9,G.eU,G.iq,G.uz,G.he,G.nf,G.To,G.Ki,G.BC,G.BY,G.ai,G.hB,G.el,D.D9],encapsulation:2}),CoreSitePreferencesPage})();var F=n(49450);function buildRoutes(e){const t=(0,F.o)(e),n=[{path:"",component:O},...t.siblings],i=[{path:"",component:O,children:t.siblings}];return[...(0,s.VI)(n,(()=>a.CoreScreen.isMobile)),...(0,s.VI)(i,(()=>a.CoreScreen.isTablet))]}let E=(()=>{var e;class CoreettingsSiteLazyModule{}return(e=CoreettingsSiteLazyModule).ɵfac=function CoreettingsSiteLazyModule_Factory(t){return new(t||e)},e.ɵmod=i.$C({type:e}),e.ɵinj=i.G2t({providers:[{provide:r.bw,multi:!0,useFactory:buildRoutes,deps:[i.zZn]}],imports:[o.n]}),CoreettingsSiteLazyModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&i.Obh(E,{declarations:[O],imports:[o.n]}))}}]);