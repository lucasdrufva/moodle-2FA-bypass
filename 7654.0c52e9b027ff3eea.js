"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7654],{17654:(e,t,n)=>{n.r(t),n.d(t,{default:()=>fe});var o=n(21182),a=n(3353),i=n(31249),r=n(91983),d=n(54438);let c=(()=>{var e;class AddonModFeedbackComponentsModule{}return(e=AddonModFeedbackComponentsModule).ɵfac=function AddonModFeedbackComponentsModule_Factory(t){return new(t||e)},e.ɵmod=d.$C({type:e}),e.ɵinj=d.G2t({imports:[a.n,i.r]}),AddonModFeedbackComponentsModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&d.Obh(c,{declarations:[r.AddonModFeedbackIndexComponent],imports:[a.n,i.r],exports:[r.AddonModFeedbackIndexComponent]}));var _=n(2138),s=n(15324),l=n(58197),m=n(68273),g=n(88246),p=n(73465),u=n(73955);let f=(()=>{var e;class AddonModFeedbackIndexPage extends _._{ngOnInit(){super.ngOnInit(),this.selectedTab=s.CoreNavigator.getRouteParam("tab"),this.selectedGroup=s.CoreNavigator.getRouteNumberParam("group")}}return(e=AddonModFeedbackIndexPage).ɵfac=(()=>{let t;return function AddonModFeedbackIndexPage_Factory(n){return(t||(t=d.xGo(e)))(n||e)}})(),e.ɵcmp=d.VBU({type:e,selectors:[["page-addon-mod-feedback-index"]],viewQuery:function AddonModFeedbackIndexPage_Query(e,t){if(1&e&&d.GBs(r.AddonModFeedbackIndexComponent,5),2&e){let e;d.mGM(e=d.lsd())&&(t.activityComponent=e.first)}},features:[d.Vt3],decls:14,vars:14,consts:[["collapsible",""],["slot","start"],[3,"text"],["contextLevel","module",3,"text","contextInstanceId","courseId"],["slot","end"],[1,"limited-width"],["slot","fixed",3,"ionRefresh","disabled"],[3,"pullingText"],[3,"dataRetrieved","module","courseId","group","selectedTab"]],template:function AddonModFeedbackIndexPage_Template(e,t){1&e&&(d.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),d.nrm(3,"ion-back-button",2),d.nI1(4,"translate"),d.k0s(),d.j41(5,"ion-title")(6,"h1"),d.nrm(7,"core-format-text",3),d.k0s()(),d.nrm(8,"ion-buttons",4),d.k0s()(),d.j41(9,"ion-content",5)(10,"ion-refresher",6),d.bIt("ionRefresh",(function AddonModFeedbackIndexPage_Template_ion_refresher_ionRefresh_10_listener(e){return null==t.activityComponent?null:t.activityComponent.doRefresh(e.target)})),d.nrm(11,"ion-refresher-content",7),d.nI1(12,"translate"),d.k0s(),d.j41(13,"addon-mod-feedback-index",8),d.bIt("dataRetrieved",(function AddonModFeedbackIndexPage_Template_addon_mod_feedback_index_dataRetrieved_13_listener(e){return t.updateData(e)})),d.k0s()()),2&e&&(d.R7$(3),d.Y8G("text",d.bMT(4,10,"core.back")),d.R7$(4),d.Y8G("text",t.title)("contextInstanceId",t.module.id)("courseId",t.courseId),d.R7$(3),d.Y8G("disabled",null==t.activityComponent?null:t.activityComponent.showLoading),d.R7$(),d.FS9("pullingText",d.bMT(12,12,"core.pulltorefresh")),d.R7$(2),d.Y8G("module",t.module)("courseId",t.courseId)("group",t.selectedGroup)("selectedTab",t.selectedTab))},dependencies:[l.B,m.M,g.i,p.QW,p.W9,p.eU,p.To,p.Ki,p.BC,p.ai,p.el,r.AddonModFeedbackIndexComponent,u.D9],encapsulation:2}),AddonModFeedbackIndexPage})();var b=n(10467),k=n(83696),I=n(2401),F=n(25124),h=n(29492),A=n(89911),M=n(55554),P=n(99522),v=n(15221),T=n(4593),R=n(2538),G=n(19634);class AddonModFeedbackAttemptsSource extends P.F{constructor(e,t){super(),this.COURSE_ID=e,this.CM_ID=t}getItemPath(e){return e.id.toString()}getItemQueryParams(){return{groupId:this.selectedGroup}}getPagesLoaded(){if(!this.identifiable||!this.anonymous)return 0;const e=this.getPageLength();return Math.ceil(Math.max(this.anonymous.length,this.identifiable.length)/e)}isIdentifiableAttempt(e){return"fullname"in e}isAnonymousAttempt(e){return"number"in e}invalidateCache(){var e=this;return(0,b.A)((function*(){yield Promise.all([v.CoreGroups.invalidateActivityGroupInfo(e.CM_ID),e.feedback&&T.o.invalidateResponsesAnalysisData(e.feedback.id)])}))()}loadFeedback(){var e=this;return(0,b.A)((function*(){e.feedback=yield T.o.getFeedback(e.COURSE_ID,e.CM_ID),e.groupInfo=yield v.CoreGroups.getActivityGroupInfo(e.CM_ID),e.selectedGroup=v.CoreGroups.validateGroupId(e.selectedGroup,e.groupInfo)}))()}getPageLength(){return G.Mw}loadPageItems(e){var t=this;return(0,b.A)((function*(){if(!t.feedback)throw new Error("Can't load attempts without feeback");const n=yield R._.getResponsesAnalysis(t.feedback.id,{page:e,groupId:t.selectedGroup,cmId:t.CM_ID});0===e&&(t.identifiableTotal=n.totalattempts,t.anonymousTotal=n.totalanonattempts);const o=t.getPageLength()*(e+1);return{items:[...0===e||n.totalattempts>G.Mw?n.attempts:[],...0===e||n.totalanonattempts>G.Mw?n.anonattempts:[]],hasMoreItems:n.totalattempts>o||n.totalanonattempts>o}}))()}setItems(e,t){this.identifiable=e.filter(this.isIdentifiableAttempt),this.anonymous=e.filter(this.isAnonymousAttempt),super.setItems(this.identifiable.concat(this.anonymous),t)}}var y=n(24742),x=n(22693),$=n(60177),C=n(97818),N=n(66198),w=n(64422),E=n(16658),Y=n(59528);const _c0=e=>({$a:e});function AddonModFeedbackAttemptsPage_ng_container_17_ion_item_6_p_5_Template(e,t){if(1&e&&(d.j41(0,"p"),d.EFF(1),d.nI1(2,"coreFormatDate"),d.k0s()),2&e){const e=d.XpG().$implicit;d.R7$(),d.JRh(d.bMT(2,1,1e3*e.timemodified))}}function AddonModFeedbackAttemptsPage_ng_container_17_ion_item_6_Template(e,t){if(1&e){const e=d.RV6();d.j41(0,"ion-item",10),d.bIt("click",(function AddonModFeedbackAttemptsPage_ng_container_17_ion_item_6_Template_ion_item_click_0_listener(){const t=d.eBV(e).$implicit,n=d.XpG(2);return d.Njj(null==n.attempts?null:n.attempts.select(t))})),d.nrm(1,"core-user-avatar",11),d.j41(2,"ion-label")(3,"p",12),d.EFF(4),d.k0s(),d.DNE(5,AddonModFeedbackAttemptsPage_ng_container_17_ion_item_6_p_5_Template,3,3,"p",7),d.k0s()()}if(2&e){const e=t.$implicit,n=d.XpG(2);d.Y8G("detail",!0),d.BMQ("aria-current",null==n.attempts?null:n.attempts.getItemAriaCurrent(e)),d.R7$(),d.Y8G("user",e)("linkProfile",!1),d.R7$(3),d.JRh(e.fullname),d.R7$(),d.Y8G("ngIf",e.timemodified)}}function AddonModFeedbackAttemptsPage_ng_container_17_Template(e,t){if(1&e&&(d.qex(0),d.j41(1,"ion-item-divider")(2,"ion-label")(3,"h2"),d.EFF(4),d.nI1(5,"translate"),d.k0s()()(),d.DNE(6,AddonModFeedbackAttemptsPage_ng_container_17_ion_item_6_Template,6,6,"ion-item",9),d.bVm()),2&e){const e=d.XpG();d.R7$(4),d.JRh(d.i5U(5,2,"addon.mod_feedback.non_anonymous_entries",d.eq3(5,_c0,e.identifiableAttemptsTotal))),d.R7$(2),d.Y8G("ngForOf",e.identifiableAttempts)}}function AddonModFeedbackAttemptsPage_ng_container_18_ion_item_6_Template(e,t){if(1&e){const e=d.RV6();d.j41(0,"ion-item",10),d.bIt("click",(function AddonModFeedbackAttemptsPage_ng_container_18_ion_item_6_Template_ion_item_click_0_listener(){const t=d.eBV(e).$implicit,n=d.XpG(2);return d.Njj(null==n.attempts?null:n.attempts.select(t))})),d.nrm(1,"core-user-avatar",13),d.j41(2,"ion-label")(3,"p",12),d.EFF(4),d.nI1(5,"translate"),d.k0s(),d.j41(6,"p"),d.EFF(7),d.nI1(8,"translate"),d.k0s()()()}if(2&e){const e=t.$implicit,n=d.XpG(2);d.Y8G("detail",!0),d.BMQ("aria-current",null==n.attempts?null:n.attempts.getItemAriaCurrent(e)),d.R7$(),d.Y8G("linkProfile",!1),d.R7$(3),d.JRh(d.bMT(5,6,"addon.mod_feedback.anonymous_user")),d.R7$(3),d.Lme("",d.bMT(8,8,"addon.mod_feedback.response_nr"),": ",e.number,"")}}function AddonModFeedbackAttemptsPage_ng_container_18_Template(e,t){if(1&e&&(d.qex(0),d.j41(1,"ion-item-divider")(2,"ion-label")(3,"h2"),d.EFF(4),d.nI1(5,"translate"),d.k0s()()(),d.DNE(6,AddonModFeedbackAttemptsPage_ng_container_18_ion_item_6_Template,9,10,"ion-item",9),d.bVm()),2&e){const e=d.XpG();d.R7$(4),d.JRh(d.i5U(5,2,"addon.mod_feedback.anonymous_entries",d.eq3(5,_c0,e.anonymousAttemptsTotal))),d.R7$(2),d.Y8G("ngForOf",e.anonymousAttempts)}}let j=(()=>{var e;class AddonModFeedbackAttemptsPage{constructor(e){this.route=e,this.fetchFailed=!1,this.promisedAttempts=new F._,this.logView=y.j.once((()=>{var e;const t=null===(e=this.attempts)||void 0===e?void 0:e.getSource();t&&t.feedback&&x.OF.logEvent({type:x.qr.VIEW_ITEM_LIST,ws:"mod_feedback_get_responses_analysis",name:t.feedback.name,data:{feedbackid:t.feedback.id,category:"feedback"},url:`/mod/feedback/show_entries.php?id=${t.CM_ID}`})}))}get attempts(){return this.promisedAttempts.value}get groupInfo(){var e;return null===(e=this.attempts)||void 0===e?void 0:e.getSource().groupInfo}get selectedGroup(){var e;return null===(e=this.attempts)||void 0===e?void 0:e.getSource().selectedGroup}set selectedGroup(e){this.attempts&&(this.attempts.getSource().selectedGroup=e,this.attempts.getSource().setDirty(!0))}get identifiableAttempts(){var e,t;return null!==(e=null===(t=this.attempts)||void 0===t?void 0:t.getSource().identifiable)&&void 0!==e?e:[]}get identifiableAttemptsTotal(){var e,t;return null!==(e=null===(t=this.attempts)||void 0===t?void 0:t.getSource().identifiableTotal)&&void 0!==e?e:0}get anonymousAttempts(){var e,t;return null!==(e=null===(t=this.attempts)||void 0===t?void 0:t.getSource().anonymous)&&void 0!==e?e:[]}get anonymousAttemptsTotal(){var e,t;return null!==(e=null===(t=this.attempts)||void 0===t?void 0:t.getSource().anonymousTotal)&&void 0!==e?e:0}ngAfterViewInit(){var e=this;return(0,b.A)((function*(){try{e.courseId=s.CoreNavigator.getRequiredRouteNumberParam("courseId");const t=s.CoreNavigator.getRequiredRouteNumberParam("cmId"),n=k.u.getOrCreateSource(AddonModFeedbackAttemptsSource,[e.courseId,t]);n.selectedGroup=s.CoreNavigator.getRouteNumberParam("group")||0,e.promisedAttempts.resolve(new AddonModFeedbackAttemptsManager(n,e.route.component))}catch(e){return A.CoreDomUtils.showErrorModal(e),s.CoreNavigator.back(),void 0}const t=yield e.promisedAttempts;try{e.fetchFailed=!1,yield t.getSource().loadFeedback(),yield t.load(),e.logView()}catch(t){e.fetchFailed=!0,A.CoreDomUtils.showErrorModalDefault(t,"core.course.errorgetmodule",!0)}yield t.start(e.splitView)}))()}ngOnDestroy(){var e;null===(e=this.attempts)||void 0===e||e.destroy()}fetchMoreAttempts(e){var t=this;return(0,b.A)((function*(){const n=yield t.promisedAttempts;try{t.fetchFailed=!1,yield n.load()}catch(e){t.fetchFailed=!0,A.CoreDomUtils.showErrorModalDefault(e,"core.course.errorgetmodule",!0)}finally{e&&e()}}))()}refreshFeedback(e){var t=this;return(0,b.A)((function*(){const n=yield t.promisedAttempts;try{t.fetchFailed=!1,yield M.g.ignoreErrors(n.getSource().invalidateCache()),yield n.getSource().loadFeedback(),yield n.reload()}catch(e){t.fetchFailed=!0,A.CoreDomUtils.showErrorModalDefault(e,"core.course.errorgetmodule",!0)}finally{e.complete()}}))()}reloadAttempts(){var e=this;return(0,b.A)((function*(){const t=yield e.promisedAttempts;yield t.reload()}))()}}return(e=AddonModFeedbackAttemptsPage).ɵfac=function AddonModFeedbackAttemptsPage_Factory(t){return new(t||e)(d.rXU(o.nX))},e.ɵcmp=d.VBU({type:e,selectors:[["page-addon-mod-feedback-attempts"]],viewQuery:function AddonModFeedbackAttemptsPage_Query(e,t){if(1&e&&d.GBs(h.M,5),2&e){let e;d.mGM(e=d.lsd())&&(t.splitView=e.first)}},decls:20,vars:18,consts:[["slot","start"],[3,"text"],["slot","fixed",3,"ionRefresh","disabled"],[3,"pullingText"],[3,"hideUntil"],[1,"ion-no-margin"],[3,"selectedChange","groupInfo","selected","courseId"],[4,"ngIf"],[3,"action","enabled","error"],["class","ion-text-wrap","button","",3,"detail","click",4,"ngFor","ngForOf"],["button","",1,"ion-text-wrap",3,"click","detail"],["slot","start",3,"user","linkProfile"],[1,"item-heading"],["slot","start",3,"linkProfile"]],template:function AddonModFeedbackAttemptsPage_Template(e,t){1&e&&(d.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),d.nrm(3,"ion-back-button",1),d.nI1(4,"translate"),d.k0s(),d.j41(5,"ion-title")(6,"h1"),d.EFF(7),d.nI1(8,"translate"),d.k0s()()()(),d.j41(9,"ion-content")(10,"core-split-view")(11,"ion-refresher",2),d.bIt("ionRefresh",(function AddonModFeedbackAttemptsPage_Template_ion_refresher_ionRefresh_11_listener(e){return t.refreshFeedback(e.target)})),d.nrm(12,"ion-refresher-content",3),d.nI1(13,"translate"),d.k0s(),d.j41(14,"core-loading",4)(15,"ion-list",5)(16,"core-group-selector",6),d.mxI("selectedChange",(function AddonModFeedbackAttemptsPage_Template_core_group_selector_selectedChange_16_listener(e){return d.DH7(t.selectedGroup,e)||(t.selectedGroup=e),e})),d.bIt("selectedChange",(function AddonModFeedbackAttemptsPage_Template_core_group_selector_selectedChange_16_listener(){return t.reloadAttempts()})),d.k0s(),d.DNE(17,AddonModFeedbackAttemptsPage_ng_container_17_Template,7,7,"ng-container",7)(18,AddonModFeedbackAttemptsPage_ng_container_18_Template,7,7,"ng-container",7),d.j41(19,"core-infinite-loading",8),d.bIt("action",(function AddonModFeedbackAttemptsPage_Template_core_infinite_loading_action_19_listener(e){return t.fetchMoreAttempts(e)})),d.k0s()()()()()),2&e&&(d.R7$(3),d.Y8G("text",d.bMT(4,12,"core.back")),d.R7$(4),d.JRh(d.bMT(8,14,"addon.mod_feedback.responses")),d.R7$(4),d.Y8G("disabled",!t.attempts||!t.attempts.loaded),d.R7$(),d.FS9("pullingText",d.bMT(13,16,"core.pulltorefresh")),d.R7$(2),d.Y8G("hideUntil",t.attempts&&t.attempts.loaded),d.R7$(2),d.Y8G("groupInfo",t.groupInfo),d.R50("selected",t.selectedGroup),d.Y8G("courseId",t.courseId),d.R7$(),d.Y8G("ngIf",t.identifiableAttemptsTotal>0),d.R7$(),d.Y8G("ngIf",t.identifiableAttemptsTotal===t.identifiableAttempts.length&&t.anonymousAttemptsTotal>0),d.R7$(),d.Y8G("enabled",t.attempts&&t.attempts.loaded&&!t.attempts.completed)("error",t.fetchFailed))},dependencies:[$.Sq,$.bT,C.F,N.b,w.R,h.M,E.T,g.i,p.QW,p.W9,p.eU,p.uz,p.Dg,p.he,p.nf,p.To,p.Ki,p.BC,p.ai,p.el,Y.f,u.D9],encapsulation:2}),AddonModFeedbackAttemptsPage})();class AddonModFeedbackAttemptsManager extends I.R{}var D=n(94114),S=n(93417),V=n(52266),q=n(88436),O=n(17778),X=n(4060),B=n(37557),U=n(28988);function AddonModFeedbackAttemptPage_h1_6_Template(e,t){if(1&e&&(d.j41(0,"h1"),d.EFF(1),d.k0s()),2&e){const e=d.XpG();d.R7$(),d.JRh(e.attempt.fullname)}}function AddonModFeedbackAttemptPage_h1_7_Template(e,t){1&e&&(d.j41(0,"h1"),d.EFF(1),d.nI1(2,"translate"),d.k0s()),2&e&&(d.R7$(),d.JRh(d.bMT(2,1,"addon.mod_feedback.anonymous_user")))}function AddonModFeedbackAttemptPage_ion_list_10_ion_item_1_p_6_Template(e,t){if(1&e&&(d.j41(0,"p"),d.EFF(1),d.nI1(2,"coreFormatDate"),d.k0s()),2&e){const e=d.XpG(3);d.R7$(),d.JRh(d.bMT(2,1,1e3*e.attempt.timemodified))}}function AddonModFeedbackAttemptPage_ion_list_10_ion_item_1_Template(e,t){if(1&e&&(d.j41(0,"ion-item",9),d.nI1(1,"translate"),d.nrm(2,"core-user-avatar",10),d.j41(3,"ion-label")(4,"h2"),d.EFF(5),d.k0s(),d.DNE(6,AddonModFeedbackAttemptPage_ion_list_10_ion_item_1_p_6_Template,3,3,"p",2),d.k0s()()),2&e){const e=d.XpG(2);d.Y8G("userId",e.attempt.userid)("courseId",e.attempt.courseid),d.BMQ("aria-label",d.bMT(1,7,"core.user.viewprofile")),d.R7$(2),d.Y8G("user",e.attempt)("linkProfile",!1),d.R7$(3),d.JRh(e.attempt.fullname),d.R7$(),d.Y8G("ngIf",e.attempt.timemodified)}}function AddonModFeedbackAttemptPage_ion_list_10_ion_item_2_Template(e,t){if(1&e&&(d.j41(0,"ion-item",11),d.nrm(1,"core-user-avatar",12),d.j41(2,"ion-label")(3,"h2"),d.EFF(4),d.nI1(5,"translate"),d.k0s(),d.j41(6,"p"),d.EFF(7),d.nI1(8,"translate"),d.k0s()()()),2&e){const e=d.XpG(2);d.R7$(),d.Y8G("linkProfile",!1),d.R7$(3),d.JRh(d.bMT(5,4,"addon.mod_feedback.anonymous_user")),d.R7$(3),d.Lme("",d.bMT(8,6,"addon.mod_feedback.response_nr"),": ",e.anonAttempt.number,"")}}function AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_core_spacer_1_Template(e,t){1&e&&d.nrm(0,"core-spacer")}function AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_p_2_span_1_Template(e,t){if(1&e&&(d.j41(0,"span"),d.EFF(1),d.k0s()),2&e){const e=d.XpG(3).$implicit;d.R7$(),d.SpI("",e.itemnumber,". ")}}function AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_p_2_Template(e,t){if(1&e&&(d.j41(0,"p",17),d.DNE(1,AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_p_2_span_1_Template,2,1,"span",2),d.nrm(2,"core-format-text",18),d.k0s()),2&e){const e=d.XpG(2).$implicit,t=d.XpG(3);d.Y8G("core-mark-required",e.required),d.R7$(),d.Y8G("ngIf",t.feedback.autonumbering&&e.itemnumber),d.R7$(),d.Y8G("component",t.component)("componentId",t.cmId)("text",e.name)("contextInstanceId",t.cmId)("courseId",t.courseId)}}function AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_p_3_Template(e,t){if(1&e&&(d.j41(0,"p"),d.nrm(1,"core-format-text",18),d.k0s()),2&e){const e=d.XpG(2).$implicit,t=d.XpG(3);d.R7$(),d.Y8G("component",t.component)("componentId",t.cmId)("text",e.submittedValue)("contextInstanceId",t.cmId)("courseId",t.courseId)}}function AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_Template(e,t){if(1&e&&(d.j41(0,"ion-item",15)(1,"ion-label"),d.DNE(2,AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_p_2_Template,3,7,"p",16)(3,AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_p_3_Template,2,5,"p",2),d.k0s()()),2&e){const e=d.XpG().$implicit;d.Y8G("color",e.dependitem>0?"light":""),d.R7$(2),d.Y8G("ngIf",e.name),d.R7$(),d.Y8G("ngIf",e.submittedValue)}}function AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_Template(e,t){if(1&e&&(d.qex(0),d.DNE(1,AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_core_spacer_1_Template,1,0,"core-spacer",2)(2,AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_ion_item_2_Template,4,3,"ion-item",14),d.bVm()),2&e){const e=t.$implicit;d.R7$(),d.Y8G("ngIf","pagebreak"===e.typ),d.R7$(),d.Y8G("ngIf","pagebreak"!==e.typ)}}function AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_Template(e,t){if(1&e&&(d.qex(0),d.DNE(1,AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_ng_container_1_Template,3,2,"ng-container",13),d.bVm()),2&e){const e=d.XpG(2);d.R7$(),d.Y8G("ngForOf",e.items)}}function AddonModFeedbackAttemptPage_ion_list_10_Template(e,t){if(1&e&&(d.j41(0,"ion-list",6),d.DNE(1,AddonModFeedbackAttemptPage_ion_list_10_ion_item_1_Template,7,9,"ion-item",7)(2,AddonModFeedbackAttemptPage_ion_list_10_ion_item_2_Template,9,8,"ion-item",8)(3,AddonModFeedbackAttemptPage_ion_list_10_ng_container_3_Template,2,1,"ng-container",2),d.k0s()),2&e){const e=d.XpG();d.R7$(),d.Y8G("ngIf",e.attempt),d.R7$(),d.Y8G("ngIf",e.anonAttempt),d.R7$(),d.Y8G("ngIf",e.items&&e.items.length)}}let L=(()=>{var e;class AddonModFeedbackAttemptPage{constructor(){this.items=[],this.component=G.SK,this.loaded=!1,this.cmId=s.CoreNavigator.getRequiredRouteNumberParam("cmId"),this.courseId=s.CoreNavigator.getRequiredRouteNumberParam("courseId"),this.attemptId=s.CoreNavigator.getRequiredRouteNumberParam("attemptId"),this.groupId=s.CoreNavigator.getRouteNumberParam("groupId");const e=k.u.getOrCreateSource(AddonModFeedbackAttemptsSource,[this.courseId,this.cmId]);this.attempts=new AddonModFeedbackAttemptsSwipeManager(e),this.logView=y.j.once((()=>{this.feedback&&x.OF.logEvent({type:x.qr.VIEW_ITEM,ws:"mod_feedback_get_responses_analysis",name:this.feedback.name,data:{id:this.attemptId,feedbackid:this.feedback.id,category:"feedback"},url:`/mod/feedback/show_entries.php?id=${this.cmId}`+(this.attempt?`userid=${this.attempt.userid}`:"")+`&showcompleted=${this.attemptId}`})}))}ngOnInit(){var e=this;return(0,b.A)((function*(){try{yield e.attempts.start()}catch(e){return A.CoreDomUtils.showErrorModal(e),s.CoreNavigator.back(),void 0}e.fetchData()}))()}ngOnDestroy(){this.attempts.destroy()}fetchData(){var e=this;return(0,b.A)((function*(){try{e.feedback=yield T.o.getFeedback(e.courseId,e.cmId);const t=yield T.o.getAttempt(e.feedback.id,e.attemptId,{cmId:e.cmId,groupId:e.groupId});e.isAnonAttempt(t)?(e.anonAttempt=t,delete e.attempt):(e.attempt=(yield R._.addImageProfile([t]))[0],delete e.anonAttempt);const n=yield T.o.getItems(e.feedback.id,{cmId:e.cmId});e.items=n.items.map((e=>{const n=R._.getItemForm(e,!0);if(!n)return;const o=n;if("label"==e.typ)o.submittedValue=q.CoreFileHelper.replacePluginfileUrls(e.presentation,e.itemfiles);else for(const n in t.responses)if(t.responses[n].id==e.id){o.submittedValue=t.responses[n].printval;break}return o})).filter((e=>e)),e.logView()}catch(e){A.CoreDomUtils.showErrorModalDefault(e,"core.course.errorgetmodule",!0),s.CoreNavigator.back()}finally{e.loaded=!0}}))()}isAnonAttempt(e){return!("fullname"in e)}}return(e=AddonModFeedbackAttemptPage).ɵfac=function AddonModFeedbackAttemptPage_Factory(t){return new(t||e)},e.ɵcmp=d.VBU({type:e,selectors:[["page-addon-mod-feedback-attempt"]],decls:11,vars:8,consts:[["slot","start"],[3,"text"],[4,"ngIf"],[3,"core-swipe-navigation"],[3,"hideUntil"],["class","ion-no-margin",4,"ngIf"],[1,"ion-no-margin"],["class","ion-text-wrap","core-user-link","",3,"userId","courseId",4,"ngIf"],["class","ion-text-wrap",4,"ngIf"],["core-user-link","",1,"ion-text-wrap",3,"userId","courseId"],["slot","start",3,"user","linkProfile"],[1,"ion-text-wrap"],["slot","start",3,"linkProfile"],[4,"ngFor","ngForOf"],["class","ion-text-wrap",3,"color",4,"ngIf"],[1,"ion-text-wrap",3,"color"],["class","item-heading",3,"core-mark-required",4,"ngIf"],[1,"item-heading",3,"core-mark-required"],["contextLevel","module",3,"component","componentId","text","contextInstanceId","courseId"]],template:function AddonModFeedbackAttemptPage_Template(e,t){1&e&&(d.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),d.nrm(3,"ion-back-button",1),d.nI1(4,"translate"),d.k0s(),d.j41(5,"ion-title"),d.DNE(6,AddonModFeedbackAttemptPage_h1_6_Template,2,1,"h1",2)(7,AddonModFeedbackAttemptPage_h1_7_Template,3,3,"h1",2),d.k0s()()(),d.j41(8,"ion-content",3)(9,"core-loading",4),d.DNE(10,AddonModFeedbackAttemptPage_ion_list_10_Template,4,3,"ion-list",5),d.k0s()()),2&e&&(d.R7$(3),d.Y8G("text",d.bMT(4,6,"core.back")),d.R7$(3),d.Y8G("ngIf",t.attempt),d.R7$(),d.Y8G("ngIf",t.anonAttempt),d.R7$(),d.Y8G("core-swipe-navigation",t.attempts),d.R7$(),d.Y8G("hideUntil",t.loaded),d.R7$(),d.Y8G("ngIf",t.attempt||t.anonAttempt))},dependencies:[$.Sq,$.bT,w.R,O.j,E.T,X.f,l.B,B.O,U.n,g.i,p.QW,p.W9,p.eU,p.uz,p.he,p.nf,p.BC,p.ai,p.el,Y.f,u.D9],encapsulation:2}),AddonModFeedbackAttemptPage})();class AddonModFeedbackAttemptsSwipeManager extends V.Z{getSelectedItemPathFromRoute(e){return s.CoreNavigator.getRouteParams(e).attemptId}}var W=n(44682),J=n(94455),K=n(52749),Q=n(81690),z=n(79555),H=n(49882),Z=n(99073),ee=n(23780),te=n(75629),ne=n(43411),oe=n(58364),ae=n(62398),ie=n(86198),re=n(66731),de=n(43570),ce=n(89417);const form_c0=e=>({item:e}),_c1=e=>({header:e});function AddonModFeedbackFormPage_ng_container_10_p_7_Template(e,t){1&e&&(d.j41(0,"p"),d.EFF(1),d.nI1(2,"translate"),d.k0s()),2&e&&(d.R7$(),d.JRh(d.bMT(2,1,"addon.mod_feedback.anonymous")))}function AddonModFeedbackFormPage_ng_container_10_p_8_Template(e,t){1&e&&(d.j41(0,"p"),d.EFF(1),d.nI1(2,"translate"),d.k0s()),2&e&&(d.R7$(),d.JRh(d.bMT(2,1,"addon.mod_feedback.non_anonymous")))}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_core_spacer_1_Template(e,t){1&e&&d.nrm(0,"core-spacer")}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_label_2_ng_container_1_Template(e,t){1&e&&d.eu8(0)}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_label_2_p_2_Template(e,t){if(1&e&&(d.j41(0,"p"),d.nrm(1,"core-format-text",20),d.k0s()),2&e){const e=d.XpG(3).$implicit,t=d.XpG(2);d.R7$(),d.Y8G("component",t.component)("componentId",t.cmId)("text",e.presentation)("contextInstanceId",t.cmId)("wsNotFiltered",!0)("courseId",t.courseId)}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_label_2_Template(e,t){if(1&e&&(d.j41(0,"ion-label"),d.DNE(1,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_label_2_ng_container_1_Template,1,0,"ng-container",19)(2,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_label_2_p_2_Template,2,6,"p",6),d.k0s()),2&e){const e=d.XpG(2).$implicit;d.XpG(2);const t=d.sdS(14);d.R7$(),d.Y8G("ngTemplateOutlet",t)("ngTemplateOutletContext",d.eq3(3,form_c0,e)),d.R7$(),d.Y8G("ngIf","label"===e.templateName)}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_input_3_ng_container_1_Template(e,t){1&e&&d.eu8(0)}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_input_3_Template(e,t){if(1&e){const e=d.RV6();d.j41(0,"ion-input",21),d.mxI("ngModelChange",(function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_input_3_Template_ion_input_ngModelChange_0_listener(t){d.eBV(e);const n=d.XpG(2).$implicit;return d.DH7(n.value,t)||(n.value=t),d.Njj(t)})),d.DNE(1,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_input_3_ng_container_1_Template,1,0,"ng-container",19),d.k0s()}if(2&e){const e=d.XpG(2).$implicit;d.XpG(2);const t=d.sdS(14);d.FCK("name","",e.typ,"_",e.id,""),d.FS9("maxlength",e.length),d.R50("ngModel",e.value),d.Y8G("required",e.required),d.R7$(),d.Y8G("ngTemplateOutlet",t)("ngTemplateOutletContext",d.eq3(8,form_c0,e))}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_4_ng_container_2_Template(e,t){1&e&&d.eu8(0)}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_4_ion_text_3_span_3_Template(e,t){1&e&&(d.j41(0,"span"),d.EFF(1,", "),d.k0s())}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_4_ion_text_3_Template(e,t){if(1&e&&(d.j41(0,"ion-text",24),d.EFF(1),d.nI1(2,"translate"),d.DNE(3,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_4_ion_text_3_span_3_Template,2,0,"span",6),d.EFF(4),d.k0s()),2&e){const e=d.XpG(3).$implicit;d.R7$(),d.Lme(" ",d.bMT(2,4,"addon.mod_feedback.numberoutofrange")," [",e.rangefrom," "),d.R7$(2),d.Y8G("ngIf",e.rangefrom&&e.rangeto),d.R7$(),d.SpI("",e.rangeto,"] ")}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_4_Template(e,t){if(1&e){const e=d.RV6();d.qex(0),d.j41(1,"ion-input",22),d.mxI("ngModelChange",(function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_4_Template_ion_input_ngModelChange_1_listener(t){d.eBV(e);const n=d.XpG(2).$implicit;return d.DH7(n.value,t)||(n.value=t),d.Njj(t)})),d.DNE(2,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_4_ng_container_2_Template,1,0,"ng-container",19),d.k0s(),d.DNE(3,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_4_ion_text_3_Template,5,6,"ion-text",23),d.bVm()}if(2&e){const e=d.XpG(2).$implicit;d.XpG(2);const t=d.sdS(14);d.R7$(),d.FCK("name","",e.typ,"_",e.id,""),d.R50("ngModel",e.value),d.Y8G("required",e.required),d.R7$(),d.Y8G("ngTemplateOutlet",t)("ngTemplateOutletContext",d.eq3(8,form_c0,e)),d.R7$(),d.Y8G("ngIf",e.hasError)}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_textarea_5_ng_container_1_Template(e,t){1&e&&d.eu8(0)}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_textarea_5_Template(e,t){if(1&e){const e=d.RV6();d.j41(0,"ion-textarea",25),d.mxI("ngModelChange",(function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_textarea_5_Template_ion_textarea_ngModelChange_0_listener(t){d.eBV(e);const n=d.XpG(2).$implicit;return d.DH7(n.value,t)||(n.value=t),d.Njj(t)})),d.DNE(1,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_textarea_5_ng_container_1_Template,1,0,"ng-container",19),d.k0s()}if(2&e){const e=d.XpG(2).$implicit;d.XpG(2);const t=d.sdS(14);d.FCK("name","",e.typ,"_",e.id,""),d.Y8G("required",e.required),d.R50("ngModel",e.value),d.R7$(),d.Y8G("ngTemplateOutlet",t)("ngTemplateOutletContext",d.eq3(7,form_c0,e))}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_select_6_ng_container_2_Template(e,t){1&e&&d.eu8(0)}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_select_6_ion_select_option_3_Template(e,t){if(1&e&&(d.j41(0,"ion-select-option",28),d.nrm(1,"core-format-text",20),d.k0s()),2&e){const e=t.$implicit,n=d.XpG(5);d.Y8G("value",e.value),d.R7$(),d.Y8G("component",n.component)("componentId",n.cmId)("text",e.label)("contextInstanceId",n.cmId)("wsNotFiltered",!0)("courseId",n.courseId)}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_select_6_Template(e,t){if(1&e){const e=d.RV6();d.j41(0,"ion-select",26),d.nI1(1,"translate"),d.mxI("ngModelChange",(function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_select_6_Template_ion_select_ngModelChange_0_listener(t){d.eBV(e);const n=d.XpG(2).$implicit;return d.DH7(n.value,t)||(n.value=t),d.Njj(t)})),d.DNE(2,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_select_6_ng_container_2_Template,1,0,"ng-container",19)(3,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_select_6_ion_select_option_3_Template,2,7,"ion-select-option",27),d.k0s()}if(2&e){const e=d.XpG(2).$implicit;d.XpG(2);const t=d.sdS(14);d.FCK("name","",e.typ,"_",e.id,""),d.Y8G("required",e.required),d.R50("ngModel",e.value),d.Y8G("cancelText",d.bMT(1,10,"core.cancel"))("interfaceOptions",d.eq3(12,_c1,e.name)),d.R7$(2),d.Y8G("ngTemplateOutlet",t)("ngTemplateOutletContext",d.eq3(14,form_c0,e)),d.R7$(),d.Y8G("ngForOf",e.choices)}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_radio_group_7_ion_item_1_Template(e,t){if(1&e&&(d.j41(0,"ion-item",10)(1,"ion-radio",28),d.nrm(2,"core-format-text",20),d.k0s()()),2&e){const e=t.$implicit,n=d.XpG(5);d.R7$(),d.Y8G("value",e.value),d.R7$(),d.Y8G("component",n.component)("componentId",n.cmId)("text",e.label)("contextInstanceId",n.cmId)("wsNotFiltered",!0)("courseId",n.courseId)}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_radio_group_7_Template(e,t){if(1&e){const e=d.RV6();d.j41(0,"ion-radio-group",29),d.mxI("ngModelChange",(function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_radio_group_7_Template_ion_radio_group_ngModelChange_0_listener(t){d.eBV(e);const n=d.XpG(2).$implicit;return d.DH7(n.value,t)||(n.value=t),d.Njj(t)})),d.DNE(1,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_radio_group_7_ion_item_1_Template,3,7,"ion-item",30),d.k0s()}if(2&e){const e=d.XpG(2).$implicit;d.FCK("name","",e.typ,"_",e.id,""),d.R50("ngModel",e.value),d.Y8G("required",e.required),d.R7$(),d.Y8G("ngForOf",e.choices)}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_8_ion_item_1_Template(e,t){if(1&e){const e=d.RV6();d.j41(0,"ion-item")(1,"ion-checkbox",31),d.mxI("ngModelChange",(function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_8_ion_item_1_Template_ion_checkbox_ngModelChange_1_listener(t){const n=d.eBV(e).$implicit;return d.DH7(n.checked,t)||(n.checked=t),d.Njj(t)})),d.nrm(2,"core-format-text",20),d.k0s()()}if(2&e){const e=t.$implicit,n=d.XpG(3).$implicit,o=d.XpG(2);d.R7$(),d.FCK("name","",n.typ,"_",n.id,""),d.Y8G("required",n.required),d.R50("ngModel",e.checked),d.R7$(),d.Y8G("component",o.component)("componentId",o.cmId)("text",e.label)("contextInstanceId",o.cmId)("wsNotFiltered",!0)("courseId",o.courseId)}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_8_Template(e,t){if(1&e&&(d.qex(0),d.DNE(1,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_8_ion_item_1_Template,3,11,"ion-item",12),d.bVm()),2&e){const e=d.XpG(2).$implicit;d.R7$(),d.Y8G("ngForOf",e.choices)}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_9_core_recaptcha_1_Template(e,t){if(1&e&&d.nrm(0,"core-recaptcha",34),2&e){const e=d.XpG(3).$implicit;d.Y8G("publicKey",e.captcha.recaptchapublickey)("model",e)}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_9_div_2_Template(e,t){1&e&&(d.j41(0,"div",35)(1,"ion-item"),d.nrm(2,"ion-icon",36),d.j41(3,"ion-label"),d.EFF(4),d.nI1(5,"translate"),d.k0s()()()),2&e&&(d.R7$(4),d.JRh(d.bMT(5,1,"addon.mod_feedback.captchaofflinewarning")))}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_9_Template(e,t){if(1&e&&(d.qex(0),d.DNE(1,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_9_core_recaptcha_1_Template,1,2,"core-recaptcha",32)(2,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_9_div_2_Template,6,3,"div",33),d.bVm()),2&e){const e=d.XpG(2).$implicit,t=d.XpG(2);d.R7$(),d.Y8G("ngIf",!t.preview&&!t.offline),d.R7$(),d.Y8G("ngIf",!t.preview&&(!e.captcha||t.offline))}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_Template(e,t){if(1&e&&(d.qex(0),d.j41(1,"ion-item",14),d.DNE(2,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_label_2_Template,3,5,"ion-label",6)(3,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_input_3_Template,2,10,"ion-input",15)(4,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_4_Template,4,10,"ng-container",6)(5,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_textarea_5_Template,2,9,"ion-textarea",16)(6,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_select_6_Template,4,16,"ion-select",17),d.k0s(),d.DNE(7,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_radio_group_7_Template,2,6,"ion-radio-group",18)(8,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_8_Template,2,1,"ng-container",6)(9,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_9_Template,3,2,"ng-container",6),d.bVm()),2&e){const e=d.XpG().$implicit;d.R7$(),d.AVh("core-danger-item",e.isEmpty||e.hasError),d.Y8G("color",e.dependitem>0?"light":""),d.R7$(),d.Y8G("ngIf",!e.slottedLabel),d.R7$(),d.Y8G("ngIf","textfield"===e.templateName),d.R7$(),d.Y8G("ngIf","numeric"===e.templateName),d.R7$(),d.Y8G("ngIf","textarea"===e.templateName),d.R7$(),d.Y8G("ngIf","multichoice-d"===e.templateName),d.R7$(),d.Y8G("ngIf","multichoice-r"===e.templateName),d.R7$(),d.Y8G("ngIf","multichoice-c"===e.templateName),d.R7$(),d.Y8G("ngIf","captcha"===e.templateName)}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_Template(e,t){if(1&e&&(d.qex(0),d.DNE(1,AddonModFeedbackFormPage_ng_container_10_ng_container_9_core_spacer_1_Template,1,0,"core-spacer",6)(2,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_Template,10,11,"ng-container",6),d.bVm()),2&e){const e=t.$implicit;d.R7$(),d.Y8G("ngIf","pagebreak"===e.typ),d.R7$(),d.Y8G("ngIf","pagebreak"!==e.typ)}}function AddonModFeedbackFormPage_ng_container_10_ion_row_10_ion_col_1_Template(e,t){if(1&e){const e=d.RV6();d.j41(0,"ion-col")(1,"ion-button",38),d.bIt("click",(function AddonModFeedbackFormPage_ng_container_10_ion_row_10_ion_col_1_Template_ion_button_click_1_listener(){d.eBV(e);const t=d.XpG(3);return d.Njj(t.gotoPage(!0))})),d.nrm(2,"ion-icon",39),d.EFF(3),d.nI1(4,"translate"),d.k0s()()}2&e&&(d.R7$(3),d.SpI(" ",d.bMT(4,1,"core.previous")," "))}function AddonModFeedbackFormPage_ng_container_10_ion_row_10_ion_col_2_Template(e,t){if(1&e){const e=d.RV6();d.j41(0,"ion-col")(1,"ion-button",40),d.bIt("click",(function AddonModFeedbackFormPage_ng_container_10_ion_row_10_ion_col_2_Template_ion_button_click_1_listener(){d.eBV(e);const t=d.XpG(3);return d.Njj(t.gotoPage(!1))})),d.EFF(2),d.nI1(3,"translate"),d.nrm(4,"ion-icon",41),d.k0s()()}2&e&&(d.R7$(2),d.SpI(" ",d.bMT(3,1,"core.next")," "))}function AddonModFeedbackFormPage_ng_container_10_ion_row_10_ion_col_3_Template(e,t){if(1&e){const e=d.RV6();d.j41(0,"ion-col")(1,"ion-button",40),d.bIt("click",(function AddonModFeedbackFormPage_ng_container_10_ion_row_10_ion_col_3_Template_ion_button_click_1_listener(){d.eBV(e);const t=d.XpG(3);return d.Njj(t.gotoPage(!1))})),d.EFF(2),d.nI1(3,"translate"),d.k0s()()}2&e&&(d.R7$(2),d.SpI(" ",d.bMT(3,1,"core.submit")," "))}function AddonModFeedbackFormPage_ng_container_10_ion_row_10_Template(e,t){if(1&e&&(d.j41(0,"ion-row",37),d.DNE(1,AddonModFeedbackFormPage_ng_container_10_ion_row_10_ion_col_1_Template,5,3,"ion-col",6)(2,AddonModFeedbackFormPage_ng_container_10_ion_row_10_ion_col_2_Template,5,3,"ion-col",6)(3,AddonModFeedbackFormPage_ng_container_10_ion_row_10_ion_col_3_Template,4,3,"ion-col",6),d.k0s()),2&e){const e=d.XpG(2);d.R7$(),d.Y8G("ngIf",e.hasPrevPage),d.R7$(),d.Y8G("ngIf",e.hasNextPage),d.R7$(),d.Y8G("ngIf",!e.hasNextPage)}}function AddonModFeedbackFormPage_ng_container_10_Template(e,t){if(1&e&&(d.qex(0),d.j41(1,"ion-list",9)(2,"ion-item",10)(3,"ion-label")(4,"p",11),d.EFF(5),d.nI1(6,"translate"),d.k0s(),d.DNE(7,AddonModFeedbackFormPage_ng_container_10_p_7_Template,3,3,"p",6)(8,AddonModFeedbackFormPage_ng_container_10_p_8_Template,3,3,"p",6),d.k0s()(),d.DNE(9,AddonModFeedbackFormPage_ng_container_10_ng_container_9_Template,3,2,"ng-container",12)(10,AddonModFeedbackFormPage_ng_container_10_ion_row_10_Template,4,3,"ion-row",13),d.k0s(),d.bVm()),2&e){const e=d.XpG();d.R7$(5),d.JRh(d.bMT(6,5,"addon.mod_feedback.mode")),d.R7$(2),d.Y8G("ngIf",e.access.isanonymous),d.R7$(),d.Y8G("ngIf",!e.access.isanonymous),d.R7$(),d.Y8G("ngForOf",e.items),d.R7$(),d.Y8G("ngIf",!e.preview)}}function AddonModFeedbackFormPage_ion_card_11_p_4_Template(e,t){1&e&&(d.j41(0,"p"),d.EFF(1),d.nI1(2,"translate"),d.k0s()),2&e&&(d.R7$(),d.SpI(" ",d.bMT(2,1,"addon.mod_feedback.this_feedback_is_already_submitted")," "))}function AddonModFeedbackFormPage_ion_card_11_p_5_Template(e,t){1&e&&(d.j41(0,"p"),d.EFF(1),d.nI1(2,"translate"),d.k0s()),2&e&&(d.R7$(),d.SpI(" ",d.bMT(2,1,"addon.mod_feedback.feedback_submitted_offline")," "))}function AddonModFeedbackFormPage_ion_card_11_core_format_text_6_Template(e,t){if(1&e&&d.nrm(0,"core-format-text",45),2&e){const e=d.XpG(2);d.Y8G("component",e.component)("text",e.completionPageContents)("contextInstanceId",e.cmId)("courseId",e.courseId)}}function AddonModFeedbackFormPage_ion_card_11_Template(e,t){if(1&e&&(d.j41(0,"ion-card",42)(1,"ion-item",10),d.nrm(2,"ion-icon",43),d.j41(3,"ion-label"),d.DNE(4,AddonModFeedbackFormPage_ion_card_11_p_4_Template,3,3,"p",6)(5,AddonModFeedbackFormPage_ion_card_11_p_5_Template,3,3,"p",6)(6,AddonModFeedbackFormPage_ion_card_11_core_format_text_6_Template,1,4,"core-format-text",44),d.k0s()()()),2&e){const e=d.XpG();d.R7$(4),d.Y8G("ngIf",!e.completionPageContents&&!e.completedOffline),d.R7$(),d.Y8G("ngIf",!e.completionPageContents&&e.completedOffline),d.R7$(),d.Y8G("ngIf",e.completionPageContents)}}function AddonModFeedbackFormPage_div_12_ion_button_2_Template(e,t){if(1&e){const e=d.RV6();d.j41(0,"ion-button",50),d.bIt("click",(function AddonModFeedbackFormPage_div_12_ion_button_2_Template_ion_button_click_0_listener(){d.eBV(e);const t=d.XpG(2);return d.Njj(t.showAnalysis())})),d.nrm(1,"ion-icon",51),d.EFF(2),d.nI1(3,"translate"),d.k0s()}2&e&&(d.R7$(2),d.SpI(" ",d.bMT(3,1,"addon.mod_feedback.completed_feedbacks")," "))}function AddonModFeedbackFormPage_div_12_ng_container_4_Template(e,t){1&e&&(d.qex(0),d.EFF(1),d.nI1(2,"translate"),d.bVm()),2&e&&(d.R7$(),d.JRh(d.bMT(2,1,"core.continue")))}function AddonModFeedbackFormPage_div_12_ng_container_5_Template(e,t){1&e&&(d.qex(0),d.EFF(1),d.nI1(2,"translate"),d.bVm()),2&e&&(d.R7$(),d.JRh(d.bMT(2,1,"core.course.nextactivity")))}function AddonModFeedbackFormPage_div_12_Template(e,t){if(1&e){const e=d.RV6();d.j41(0,"div",46)(1,"div",47),d.DNE(2,AddonModFeedbackFormPage_div_12_ion_button_2_Template,4,3,"ion-button",48),d.j41(3,"ion-button",49),d.bIt("click",(function AddonModFeedbackFormPage_div_12_Template_ion_button_click_3_listener(){d.eBV(e);const t=d.XpG();return d.Njj(t.continue())})),d.DNE(4,AddonModFeedbackFormPage_div_12_ng_container_4_Template,3,3,"ng-container",6)(5,AddonModFeedbackFormPage_div_12_ng_container_5_Template,3,3,"ng-container",6),d.k0s()()()}if(2&e){const e=d.XpG();d.R7$(2),d.Y8G("ngIf",e.access.canviewanalysis),d.R7$(2),d.Y8G("ngIf",!e.siteAfterSubmit),d.R7$(),d.Y8G("ngIf",e.siteAfterSubmit)}}function AddonModFeedbackFormPage_ng_template_13_p_0_span_1_Template(e,t){if(1&e&&(d.j41(0,"span"),d.EFF(1),d.k0s()),2&e){const e=d.XpG(2).item;d.R7$(),d.SpI("",e.itemnumber,". ")}}function AddonModFeedbackFormPage_ng_template_13_p_0_span_3_Template(e,t){if(1&e&&(d.j41(0,"span",56),d.EFF(1),d.k0s()),2&e){const e=d.XpG(2).item;d.R7$(),d.JRh(e.postfix)}}function AddonModFeedbackFormPage_ng_template_13_p_0_Template(e,t){if(1&e&&(d.j41(0,"p",53),d.DNE(1,AddonModFeedbackFormPage_ng_template_13_p_0_span_1_Template,2,1,"span",6),d.nrm(2,"core-format-text",54),d.DNE(3,AddonModFeedbackFormPage_ng_template_13_p_0_span_3_Template,2,1,"span",55),d.k0s()),2&e){const e=d.XpG().item,t=d.XpG();d.Y8G("core-mark-required",e.required),d.BMQ("slot",e.slottedLabel?"label":void 0),d.R7$(),d.Y8G("ngIf",t.feedback.autonumbering&&e.itemnumber),d.R7$(),d.Y8G("component",t.component)("componentId",t.cmId)("text",e.name)("contextInstanceId",t.cmId)("courseId",t.courseId)("wsNotFiltered",!0),d.R7$(),d.Y8G("ngIf",e.postfix)}}function AddonModFeedbackFormPage_ng_template_13_Template(e,t){if(1&e&&d.DNE(0,AddonModFeedbackFormPage_ng_template_13_p_0_Template,4,10,"p",52),2&e){d.Y8G("ngIf",t.item.name)}}let _e=(()=>{var e;class AddonModFeedbackFormPage{constructor(){this.forceLeave=!1,this.preview=!1,this.fromIndex=!1,this.component=G.SK,this.offline=!1,this.feedbackLoaded=!1,this.items=[],this.hasPrevPage=!1,this.hasNextPage=!1,this.completed=!1,this.completedOffline=!1,this.currentSite=K.CoreSites.getRequiredCurrentSite(),this.onlineObserver=J.WE.onChange().subscribe((()=>{z.SK.run((()=>{this.offline=!J.WE.isOnline()}))}))}ngOnInit(){var e=this;return(0,b.A)((function*(){try{e.cmId=s.CoreNavigator.getRequiredRouteNumberParam("cmId"),e.courseId=s.CoreNavigator.getRequiredRouteNumberParam("courseId"),e.currentPage=s.CoreNavigator.getRouteNumberParam("page"),e.title=s.CoreNavigator.getRouteParam("title"),e.preview=!!s.CoreNavigator.getRouteBooleanParam("preview"),e.fromIndex=!!s.CoreNavigator.getRouteBooleanParam("fromIndex")}catch(e){return A.CoreDomUtils.showErrorModal(e),s.CoreNavigator.back(),void 0}if(yield e.fetchData(),!e.access||e.access.isempty&&!e.access.canedititems&&!e.access.canviewreports)return A.CoreDomUtils.showErrorModal(z.HT.instant("core.nopermissiontoaccesspage")),s.CoreNavigator.back(),void 0;if(e.feedback&&e.module)try{yield T.o.logView(e.feedback.id,!0),W.CoreCourse.checkModuleCompletion(e.courseId,e.module.completiondata)}catch{}}))()}ionViewDidEnter(){this.forceLeave=!1}canLeave(){var e=this;return(0,b.A)((function*(){if(e.forceLeave)return!0;if(!e.preview){const t=R._.getPageItemsResponses(e.items);e.items&&!e.completed&&e.originalData&&(oe.T.basicLeftCompare(t,e.originalData,3)||(yield A.CoreDomUtils.showConfirm(z.HT.instant("core.confirmcanceledit"))))}return!0}))()}fetchData(){var e=this;return(0,b.A)((function*(){try{var t,n;e.module=yield W.CoreCourse.getModule(e.cmId,e.courseId,void 0,!0,!1,e.currentSite.getId()),e.offline=!J.WE.isOnline();const a={cmId:e.cmId,readingStrategy:e.offline?1:2,siteId:e.currentSite.getId()};e.feedback=yield T.o.getFeedback(e.courseId,e.cmId),e.title=e.feedback.name||e.title,yield e.fetchAccessData(a);let i=0;var o;if(e.preview||null===(t=e.access)||void 0===t||!t.cansubmit||null!==(n=e.access)&&void 0!==n&&n.isempty)e.preview=!0;else i=null!==(o=e.currentPage)&&void 0!==o?o:yield e.fetchResumePage(a);yield e.fetchFeedbackPageData(i)}catch(t){A.CoreDomUtils.showErrorModalDefault(t,"core.course.errorgetmodule",!0),e.forceLeave=!0,s.CoreNavigator.back()}finally{e.feedbackLoaded=!0}}))()}fetchAccessData(e){var t=this;return(0,b.A)((function*(){if(t.feedback)try{t.access=yield T.o.getFeedbackAccessInformation(t.feedback.id,e)}catch(n){if(t.offline||ne.CoreWSError.isWebServiceError(n))throw n;t.offline=!0,e.readingStrategy=1,t.access=yield T.o.getFeedbackAccessInformation(t.feedback.id,e)}}))()}fetchResumePage(e){var t=this;return(0,b.A)((function*(){if(!t.feedback)throw new te.CoreError("Cannot fetch resume page: missing feedback");try{return yield T.o.getResumePage(t.feedback.id,e)}catch(n){if(t.offline||ne.CoreWSError.isWebServiceError(n))throw n;return t.offline=!0,e.readingStrategy=1,T.o.getResumePage(t.feedback.id,e)}}))()}fetchFeedbackPageData(e=0){var t=this;return(0,b.A)((function*(){t.items=[];const n=yield t.fetchPageItems(e);if(t.items=n.items.map((e=>R._.getItemForm(e,t.preview))).filter((e=>e)),!t.preview){const e=Q.j.clone(t.items);t.originalData=R._.getPageItemsResponses(e)}t.analyticsLogEvent()}))()}fetchPageItems(e){var t=this;return(0,b.A)((function*(){if(!t.feedback)throw new te.CoreError("Cannot fetch page items: missing feedback");const n={cmId:t.cmId,readingStrategy:t.offline?1:2,siteId:t.currentSite.getId()};if(t.preview){const e=yield T.o.getItems(t.feedback.id,n);return{items:e.items,warnings:e.warnings,hasnextpage:!1,hasprevpage:!1}}let o;t.currentPage=e;try{o=yield T.o.getPageItemsWithValues(t.feedback.id,e,n)}catch(a){if(t.offline||ne.CoreWSError.isWebServiceError(a))throw a;t.offline=!0,n.readingStrategy=1,o=yield T.o.getPageItemsWithValues(t.feedback.id,e,n)}return t.hasPrevPage=!!o.hasprevpage,t.hasNextPage=!!o.hasnextpage,o}))()}gotoPage(e){var t=this;return(0,b.A)((function*(){var n;if(!t.feedback||void 0===t.currentPage)return;null===(n=t.content)||void 0===n||n.scrollToTop(),t.feedbackLoaded=!1;const o=R._.getPageItemsResponses(t.items),a=t.items.some((e=>e.isEmpty||e.hasError));try{yield M.g.ignoreErrors(Z.V.syncFeedback(t.feedback.id));const n=yield T.o.processPage(t.feedback.id,t.currentPage,o,{goPrevious:e,formHasErrors:a,courseId:t.courseId,cmId:t.cmId});n.completed?(t.items=[],t.completed=!0,t.completedOffline=!!n.offline,t.completionPageContents=n.completionpagecontents,t.siteAfterSubmit=n.siteaftersubmit,H.z.trigger(H.z.ACTIVITY_DATA_SENT,{module:"feedback"}),yield Promise.all([T.o.invalidateFeedbackAccessInformationData(t.feedback.id),T.o.invalidateResumePageData(t.feedback.id)]),H.z.trigger(G.bN,{feedbackId:t.feedback.id,tab:G.sT.OVERVIEW,offline:t.completedOffline}),yield t.fetchAccessData({cmId:t.cmId,readingStrategy:t.offline?1:2,siteId:t.currentSite.getId()})):"number"!=typeof n.jumpto||n.jumpto==t.currentPage||(yield T.o.invalidateResumePageData(t.feedback.id),H.z.trigger(G.bN,{feedbackId:t.feedback.id,tab:G.sT.OVERVIEW,offline:t.completedOffline}),yield t.fetchFeedbackPageData(n.jumpto))}catch(e){A.CoreDomUtils.showErrorModalDefault(e,"core.course.errorgetmodule",!0)}finally{t.feedbackLoaded=!0}}))()}showAnalysis(){if(this.feedback)return this.fromIndex?(H.z.trigger(G.bN,{feedbackId:this.feedback.id,tab:G.sT.ANALYSIS,offline:this.completedOffline}),s.CoreNavigator.back(),void 0):(s.CoreNavigator.navigateToSitePath(G.qY+`/${this.courseId}/${this.cmId}`,{params:{module:this.module,tab:G.sT.ANALYSIS}}),void 0)}continue(){var e=this;return(0,b.A)((function*(){if(!e.siteAfterSubmit)return s.CoreNavigator.back();const t=yield ee.CoreLoadings.show();try{yield K.CoreSites.visitLink(e.siteAfterSubmit,{siteId:e.currentSite.id})}finally{t.dismiss()}}))()}analyticsLogEvent(){if(!this.feedback)return;if(this.preview)return x.OF.logEvent({type:x.qr.VIEW_ITEM,ws:"mod_feedback_get_items",name:this.feedback.name,data:{id:this.feedback.id,category:"feedback"},url:`/mod/feedback/print.php?id=${this.cmId}&courseid=${this.courseId}`}),void 0;let e="/mod/feedback/complete.php";this.completed||(e+=`?id=${this.cmId}`+(this.currentPage?`&gopage=${this.currentPage}`:"")+`&courseid=${this.courseId}`),x.OF.logEvent({type:x.qr.VIEW_ITEM,ws:this.completed?"mod_feedback_get_feedback_access_information":"mod_feedback_get_page_items",name:this.feedback.name,data:{id:this.feedback.id,category:"feedback",page:this.currentPage},url:e})}ngOnDestroy(){this.onlineObserver.unsubscribe()}}return(e=AddonModFeedbackFormPage).ɵfac=function AddonModFeedbackFormPage_Factory(t){return new(t||e)},e.ɵcmp=d.VBU({type:e,selectors:[["page-addon-mod-feedback-form"]],viewQuery:function AddonModFeedbackFormPage_Query(e,t){if(1&e&&d.GBs(p.W9,5),2&e){let e;d.mGM(e=d.lsd())&&(t.content=e.first)}},decls:15,vars:10,consts:[["label",""],["slot","start"],[3,"text"],["contextLevel","module",3,"text","contextInstanceId","courseId"],[1,"limited-width"],[1,"has-spacer",3,"hideUntil"],[4,"ngIf"],["class","core-success-card",4,"ngIf"],["collapsible-footer","","slot","fixed","appearOnBottom","",4,"ngIf"],[1,"ion-no-margin","has-spacer"],[1,"ion-text-wrap"],[1,"item-heading"],[4,"ngFor","ngForOf"],["class","ion-align-items-center spacer-top",4,"ngIf"],[1,"ion-text-wrap","addon-mod_feedback-item",3,"color"],["labelPlacement","stacked","type","text","autocorrect","off",3,"ngModel","name","maxlength","required","ngModelChange",4,"ngIf"],["labelPlacement","stacked",3,"required","name","ngModel","ngModelChange",4,"ngIf"],["labelPlacement","stacked","interface","action-sheet",3,"required","name","ngModel","cancelText","interfaceOptions","ngModelChange",4,"ngIf"],[3,"ngModel","required","name","ngModelChange",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["contextLevel","module",3,"component","componentId","text","contextInstanceId","wsNotFiltered","courseId"],["labelPlacement","stacked","type","text","autocorrect","off",3,"ngModelChange","ngModel","name","maxlength","required"],["labelPlacement","stacked","type","number",3,"ngModelChange","ngModel","name","required"],["color","danger","class","addon-mod_feedback-item-error",4,"ngIf"],["color","danger",1,"addon-mod_feedback-item-error"],["labelPlacement","stacked",3,"ngModelChange","required","name","ngModel"],["labelPlacement","stacked","interface","action-sheet",3,"ngModelChange","required","name","ngModel","cancelText","interfaceOptions"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[3,"ngModelChange","ngModel","required","name"],["class","ion-text-wrap",4,"ngFor","ngForOf"],["value","option.value",3,"ngModelChange","required","name","ngModel"],["modelValueName","value",3,"publicKey","model",4,"ngIf"],["class","core-warning-card",4,"ngIf"],["modelValueName","value",3,"publicKey","model"],[1,"core-warning-card"],["name","fas-triangle-exclamation","slot","start","aria-hidden","true"],[1,"ion-align-items-center","spacer-top"],["expand","block","fill","outline",1,"ion-text-wrap",3,"click"],["name","fas-chevron-left","slot","start","aria-hidden","true"],["expand","block",1,"ion-text-wrap",3,"click"],["name","fas-chevron-right","slot","end","aria-hidden","true"],[1,"core-success-card"],["name","fas-check","slot","start","aria-hidden","true"],["componentId","componentId","contextLevel","module",3,"component","text","contextInstanceId","courseId",4,"ngIf"],["componentId","componentId","contextLevel","module",3,"component","text","contextInstanceId","courseId"],["collapsible-footer","","slot","fixed","appearOnBottom",""],[1,"list-item-limited-width","adaptable-buttons-row"],["expand","block","fill","outline","class","ion-text-wrap ion-margin",3,"click",4,"ngIf"],["expand","block",1,"ion-text-wrap","ion-margin",3,"click"],["expand","block","fill","outline",1,"ion-text-wrap","ion-margin",3,"click"],["name","fas-chart-bar","slot","start","aria-hidden","true"],["class","ion-text-wrap",3,"core-mark-required",4,"ngIf"],[1,"ion-text-wrap",3,"core-mark-required"],["contextLevel","module",3,"component","componentId","text","contextInstanceId","courseId","wsNotFiltered"],["class","addon-mod_feedback-postfix",4,"ngIf"],[1,"addon-mod_feedback-postfix"]],template:function AddonModFeedbackFormPage_Template(e,t){1&e&&(d.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",1),d.nrm(3,"ion-back-button",2),d.nI1(4,"translate"),d.k0s(),d.j41(5,"ion-title")(6,"h1"),d.nrm(7,"core-format-text",3),d.k0s()()()(),d.j41(8,"ion-content",4)(9,"core-loading",5),d.DNE(10,AddonModFeedbackFormPage_ng_container_10_Template,11,7,"ng-container",6)(11,AddonModFeedbackFormPage_ion_card_11_Template,7,3,"ion-card",7)(12,AddonModFeedbackFormPage_div_12_Template,6,3,"div",8),d.k0s()(),d.DNE(13,AddonModFeedbackFormPage_ng_template_13_Template,1,1,"ng-template",null,0,d.C5r)),2&e&&(d.R7$(3),d.Y8G("text",d.bMT(4,8,"core.back")),d.R7$(4),d.Y8G("text",t.title)("contextInstanceId",t.cmId)("courseId",t.courseId),d.R7$(2),d.Y8G("hideUntil",t.feedbackLoaded),d.R7$(),d.Y8G("ngIf",t.items&&t.items.length),d.R7$(),d.Y8G("ngIf",t.completed),d.R7$(),d.Y8G("ngIf",t.feedbackLoaded&&t.completed))},dependencies:[$.Sq,$.bT,$.T3,w.R,O.j,ae.i,X.f,ie.t,l.B,re.i,g.i,de.T,ce.BC,ce.YS,ce.tU,ce.vS,p.Jm,p.QW,p.b_,p.eY,p.hU,p.W9,p.eU,p.iq,p.$w,p.uz,p.he,p.nf,p.KO,p.f0,p.ln,p.Nm,p.Ip,p.IO,p.nc,p.BC,p.ai,p.hB,p.su,p.Je,p.Gw,p.el,u.D9],styles:["[_nghost-%COMP%]   .addon-mod_feedback-item[_ngcontent-%COMP%]   ion-label.label-stacked[_ngcontent-%COMP%]{margin:11px 0 10px;transform:none}[_nghost-%COMP%]   .addon-mod_feedback-item-error[_ngcontent-%COMP%]{padding-top:5px;padding-bottom:8px}"]}),AddonModFeedbackFormPage})();var se=n(6007);const nonrespondents_c0=e=>({$a:e});function AddonModFeedbackNonRespondentsPage_ng_container_21_ion_item_1_ion_badge_6_Template(e,t){1&e&&(d.j41(0,"ion-badge",15),d.EFF(1),d.nI1(2,"translate"),d.k0s()),2&e&&(d.R7$(),d.SpI(" ",d.bMT(2,1,"addon.mod_feedback.started")," "))}function AddonModFeedbackNonRespondentsPage_ng_container_21_ion_item_1_ion_badge_7_Template(e,t){1&e&&(d.j41(0,"ion-badge",16),d.EFF(1),d.nI1(2,"translate"),d.k0s()),2&e&&(d.R7$(),d.SpI(" ",d.bMT(2,1,"addon.mod_feedback.not_started")," "))}function AddonModFeedbackNonRespondentsPage_ng_container_21_ion_item_1_Template(e,t){if(1&e&&(d.j41(0,"ion-item",10),d.nrm(1,"core-user-avatar",11),d.j41(2,"ion-label")(3,"p",12),d.EFF(4),d.k0s(),d.j41(5,"p"),d.DNE(6,AddonModFeedbackNonRespondentsPage_ng_container_21_ion_item_1_ion_badge_6_Template,3,3,"ion-badge",13)(7,AddonModFeedbackNonRespondentsPage_ng_container_21_ion_item_1_ion_badge_7_Template,3,3,"ion-badge",14),d.k0s()()()),2&e){const e=t.$implicit;d.R7$(),d.Y8G("user",e),d.R7$(3),d.JRh(e.fullname),d.R7$(2),d.Y8G("ngIf",e.started),d.R7$(),d.Y8G("ngIf",!e.started)}}function AddonModFeedbackNonRespondentsPage_ng_container_21_Template(e,t){if(1&e&&(d.qex(0),d.DNE(1,AddonModFeedbackNonRespondentsPage_ng_container_21_ion_item_1_Template,8,4,"ion-item",9),d.bVm()),2&e){const e=d.XpG();d.R7$(),d.Y8G("ngForOf",e.users)}}let le=(()=>{var e;class AddonModFeedbackNonRespondentsPage{constructor(){this.page=0,this.users=[],this.total=0,this.canLoadMore=!1,this.loaded=!1,this.loadMoreError=!1,this.logView=y.j.once((()=>{this.feedback&&x.OF.logEvent({type:x.qr.VIEW_ITEM_LIST,ws:"mod_feedback_get_non_respondents",name:this.feedback.name,data:{feedbackid:this.feedback.id,category:"feedback"},url:`/mod/feedback/show_nonrespondents.php?id=${this.cmId}&courseid=${this.courseId}`})}))}ngOnInit(){try{this.cmId=s.CoreNavigator.getRequiredRouteNumberParam("cmId"),this.courseId=s.CoreNavigator.getRequiredRouteNumberParam("courseId"),this.selectedGroup=s.CoreNavigator.getRouteNumberParam("group")||0}catch(e){return A.CoreDomUtils.showErrorModal(e),s.CoreNavigator.back(),void 0}this.fetchData()}fetchData(e=!1){var t=this;return(0,b.A)((function*(){t.page=0,t.total=0,t.users=[];try{t.feedback=yield T.o.getFeedback(t.courseId,t.cmId),t.groupInfo=yield v.CoreGroups.getActivityGroupInfo(t.cmId),t.selectedGroup=v.CoreGroups.validateGroupId(t.selectedGroup,t.groupInfo),yield t.loadGroupUsers(t.selectedGroup),t.logView()}catch(t){A.CoreDomUtils.showErrorModalDefault(t,"core.course.errorgetmodule",!0),e||s.CoreNavigator.back()}}))()}loadGroupUsers(e){var t=this;return(0,b.A)((function*(){t.loadMoreError=!1,void 0===e?t.page++:(t.selectedGroup=e,t.page=0,t.total=0,t.users=[],t.loaded=!1);try{const e=yield R._.getNonRespondents(t.feedback.id,{groupId:t.selectedGroup,page:t.page,cmId:t.cmId});t.total=e.total,t.users.length<e.total&&(t.users=t.users.concat(e.users)),t.canLoadMore=t.users.length<e.total}catch(e){throw t.loadMoreError=!0,e}finally{t.loaded=!0}}))()}loadAttempts(e,t){var n=this;return(0,b.A)((function*(){try{yield n.loadGroupUsers(e)}catch(e){A.CoreDomUtils.showErrorModalDefault(e,"core.course.errorgetmodule",!0)}finally{t&&t()}}))()}refreshFeedback(e){var t=this;return(0,b.A)((function*(){try{const e=[];e.push(v.CoreGroups.invalidateActivityGroupInfo(t.cmId)),t.feedback&&e.push(T.o.invalidateNonRespondentsData(t.feedback.id)),yield M.g.ignoreErrors(Promise.all(e)),yield t.fetchData(!0)}finally{e.complete()}}))()}}return(e=AddonModFeedbackNonRespondentsPage).ɵfac=function AddonModFeedbackNonRespondentsPage_Factory(t){return new(t||e)},e.ɵcmp=d.VBU({type:e,selectors:[["page-addon-mod-feedback-nonrespondents"]],decls:23,vars:23,consts:[["slot","start"],[3,"text"],["slot","fixed",3,"ionRefresh","disabled"],[3,"pullingText"],[3,"hideUntil"],[1,"ion-no-margin"],[3,"selectedChange","groupInfo","selected","courseId"],[4,"ngIf"],[3,"action","enabled","error"],["class","ion-text-wrap",4,"ngFor","ngForOf"],[1,"ion-text-wrap"],["slot","start",3,"user"],[1,"item-heading"],["color","success",4,"ngIf"],["color","danger",4,"ngIf"],["color","success"],["color","danger"]],template:function AddonModFeedbackNonRespondentsPage_Template(e,t){1&e&&(d.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),d.nrm(3,"ion-back-button",1),d.nI1(4,"translate"),d.k0s(),d.j41(5,"ion-title")(6,"h1"),d.EFF(7),d.nI1(8,"translate"),d.k0s()()()(),d.j41(9,"ion-content")(10,"ion-refresher",2),d.bIt("ionRefresh",(function AddonModFeedbackNonRespondentsPage_Template_ion_refresher_ionRefresh_10_listener(e){return t.refreshFeedback(e.target)})),d.nrm(11,"ion-refresher-content",3),d.nI1(12,"translate"),d.k0s(),d.j41(13,"core-loading",4)(14,"ion-list",5)(15,"core-group-selector",6),d.mxI("selectedChange",(function AddonModFeedbackNonRespondentsPage_Template_core_group_selector_selectedChange_15_listener(e){return d.DH7(t.selectedGroup,e)||(t.selectedGroup=e),e})),d.bIt("selectedChange",(function AddonModFeedbackNonRespondentsPage_Template_core_group_selector_selectedChange_15_listener(){return t.loadAttempts(t.selectedGroup)})),d.k0s(),d.j41(16,"ion-item-divider")(17,"ion-label")(18,"h2"),d.EFF(19),d.nI1(20,"translate"),d.k0s()()(),d.DNE(21,AddonModFeedbackNonRespondentsPage_ng_container_21_Template,2,1,"ng-container",7),d.j41(22,"core-infinite-loading",8),d.bIt("action",(function AddonModFeedbackNonRespondentsPage_Template_core_infinite_loading_action_22_listener(e){return t.loadAttempts(void 0,e)})),d.k0s()()()()),2&e&&(d.R7$(3),d.Y8G("text",d.bMT(4,12,"core.back")),d.R7$(4),d.JRh(d.bMT(8,14,"addon.mod_feedback.responses")),d.R7$(3),d.Y8G("disabled",!t.loaded),d.R7$(),d.FS9("pullingText",d.bMT(12,16,"core.pulltorefresh")),d.R7$(2),d.Y8G("hideUntil",t.loaded),d.R7$(2),d.Y8G("groupInfo",t.groupInfo),d.R50("selected",t.selectedGroup),d.Y8G("courseId",t.courseId),d.R7$(4),d.JRh(d.i5U(20,18,"addon.mod_feedback.non_respondents_students",d.eq3(21,nonrespondents_c0,t.total))),d.R7$(2),d.Y8G("ngIf",t.total>0),d.R7$(),d.Y8G("enabled",t.canLoadMore)("error",t.loadMoreError))},dependencies:[$.Sq,$.bT,C.F,N.b,w.R,E.T,g.i,p.In,p.QW,p.W9,p.eU,p.uz,p.Dg,p.he,p.nf,p.To,p.Ki,p.BC,p.ai,p.el,u.D9],encapsulation:2}),AddonModFeedbackNonRespondentsPage})();const me=[{path:":courseId/:cmId",component:f},{path:":courseId/:cmId/form",component:_e,canDeactivate:[se.V]},{path:":courseId/:cmId/nonrespondents",component:le}],ge=[...me,{path:":courseId/:cmId/attempts",component:j},{path:":courseId/:cmId/attempts/:attemptId",component:L}],pe=[...me,{path:":courseId/:cmId/attempts",component:j,children:[{path:":attemptId",component:L}]}],ue=[...(0,D.VI)(ge,(()=>S.CoreScreen.isMobile)),...(0,D.VI)(pe,(()=>S.CoreScreen.isTablet))];let fe=(()=>{var e;class AddonModFeedbackLazyModule{}return(e=AddonModFeedbackLazyModule).ɵfac=function AddonModFeedbackLazyModule_Factory(t){return new(t||e)},e.ɵmod=d.$C({type:e}),e.ɵinj=d.G2t({imports:[o.iI.forChild(ue),a.n,c]}),AddonModFeedbackLazyModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&d.Obh(fe,{declarations:[j,_e,f,le,L],imports:[o.iI,a.n,c]}))},52266:(e,t,n)=>{n.d(t,{Z:()=>CoreSwipeNavigationItemsManager});var o=n(10467),a=n(15324),i=n(95990);class CoreSwipeNavigationItemsManager extends i.u{start(){var e=this;return(0,o.A)((function*(){e.updateSelectedItem()}))()}navigateToNextItem(){var e=this;return(0,o.A)((function*(){yield e.navigateToItemBy(1,"forward")}))()}navigateToPreviousItem(){var e=this;return(0,o.A)((function*(){yield e.navigateToItemBy(-1,"back")}))()}hasNextItem(){var e=this;return(0,o.A)((function*(){return!!(yield e.getItemBy(1))}))()}hasPreviousItem(){var e=this;return(0,o.A)((function*(){return!!(yield e.getItemBy(-1))}))()}getCurrentPageRoute(){return a.CoreNavigator.getCurrentRoute()}getSelectedItemPathFromRoute(e){const t=[];for(;e&&(t.push(...a.CoreNavigator.getRouteUrl(e)),e.firstChild);)e=e.firstChild;return t.map((e=>e.path)).join("/").replace(/\/+/,"/").trim()||null}navigateToItemBy(e,t){var n=this;return(0,o.A)((function*(){const o=yield n.getItemBy(e);o&&(yield n.navigateToItem(o,{animationDirection:t,replace:!0}))}))()}getItemBy(e){var t=this;return(0,o.A)((function*(){var n;const o=t.getSource().getItems(),a=null!==(n=t.selectedItem&&(null==o?void 0:o.indexOf(t.selectedItem)))&&void 0!==n?n:-1;if(-1===a||null===o)return null;const i=e>0?1:-1;let r=a,d=0;for(;d!==e;){if(r+=i,r<0)return null;if(r>=o.length)break;t.skipItemInSwipe(o[r])||(d+=i)}return d===e?o[r]:t.getSource().isCompleted()?null:(yield t.getSource().load(),t.getItemBy(e))}))()}skipItemInSwipe(e){return!1}}}}]);