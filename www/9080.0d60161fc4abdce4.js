"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9080],{79080:(n,o,e)=>{e.r(o),e.d(o,{AddonModScormIndexComponent:()=>N});var t=e(10467),i=e(74431),d=e(75629),r=e(69006),a=e(44682),_=e(15324),c=e(48966),s=e(89911),m=e(58364),l=e(79555),p=e(49882),u=e(60438),g=e(1717),f=e(8214),I=e(98045),v=e(50891),h=e(53794),A=e(55554),M=e(54438),x=e(73465),S=e(51024),T=e(60177),C=e(69502),R=e(17388),b=e(64422),G=e(13988),k=e(49234),$=e(86198),w=e(58197),y=e(23007),F=e(66731),E=e(43570),D=e(89417),j=e(6736),O=e(30864),Y=e(73955);const _c0=n=>({header:n}),_c1=n=>({number:n});function AddonModScormIndexComponent_Conditional_1_Template(n,o){if(1&n){const n=M.RV6();M.j41(0,"ion-button",7),M.nI1(1,"translate"),M.bIt("click",(function AddonModScormIndexComponent_Conditional_1_Template_ion_button_click_0_listener(){M.eBV(n);const o=M.XpG();return M.Njj(o.openModuleSummary())})),M.nrm(2,"ion-icon",8),M.k0s()}2&n&&M.Y8G("ariaLabel",M.bMT(1,1,"core.info"))}function AddonModScormIndexComponent_Conditional_2_Template(n,o){if(1&n){const n=M.RV6();M.j41(0,"core-context-menu")(1,"core-context-menu-item",9),M.nI1(2,"translate"),M.bIt("action",(function AddonModScormIndexComponent_Conditional_2_Template_core_context_menu_item_action_1_listener(){M.eBV(n);const o=M.XpG();return M.Njj(o.openModuleSummary())})),M.k0s()()}2&n&&(M.R7$(),M.Y8G("priority",5e3)("content",M.bMT(2,2,"core.info")))}function AddonModScormIndexComponent_ion_card_5_Template(n,o){if(1&n&&(M.j41(0,"ion-card",10)(1,"ion-item"),M.nrm(2,"ion-icon",11),M.j41(3,"ion-label"),M.EFF(4),M.k0s()()()),2&n){const n=M.XpG();M.R7$(4),M.JRh(n.scorm.warningMessage)}}function AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ion_item_1_span_6_Template(n,o){1&n&&(M.j41(0,"span"),M.EFF(1),M.nI1(2,"translate"),M.k0s()),2&n&&(M.R7$(),M.JRh(M.bMT(2,1,"core.unlimited")))}function AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ion_item_1_span_7_Template(n,o){if(1&n&&(M.j41(0,"span"),M.EFF(1),M.k0s()),2&n){const n=M.XpG(5);M.R7$(),M.JRh(n.scorm.maxattempt)}}function AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ion_item_1_Template(n,o){if(1&n&&(M.j41(0,"ion-item",13)(1,"ion-label")(2,"p",18),M.EFF(3),M.nI1(4,"translate"),M.k0s()(),M.j41(5,"p",0),M.DNE(6,AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ion_item_1_span_6_Template,3,3,"span",5)(7,AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ion_item_1_span_7_Template,2,1,"span",5),M.k0s()()),2&n){const n=M.XpG(4);M.R7$(3),M.JRh(M.bMT(4,3,"addon.mod_scorm.noattemptsallowed")),M.R7$(3),M.Y8G("ngIf",0===n.scorm.maxattempt),M.R7$(),M.Y8G("ngIf",n.scorm.maxattempt>0)}}function AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ion_item_2_Template(n,o){if(1&n&&(M.j41(0,"ion-item",13)(1,"ion-label")(2,"p",18),M.EFF(3),M.nI1(4,"translate"),M.k0s()(),M.j41(5,"p",0),M.EFF(6),M.k0s()()),2&n){const n=M.XpG(4);M.R7$(3),M.JRh(M.bMT(4,2,"addon.mod_scorm.noattemptsmade")),M.R7$(3),M.JRh(n.numAttempts)}}function AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ion_item_3_Template(n,o){if(1&n){const n=M.RV6();M.j41(0,"ion-item",19),M.nI1(1,"translate"),M.bIt("click",(function AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ion_item_3_Template_ion_item_click_0_listener(){M.eBV(n);const o=M.XpG(4);return M.Njj(o.toggleGrades())})),M.nrm(2,"ion-icon",20),M.j41(3,"ion-label")(4,"h3",18),M.EFF(5),M.nI1(6,"translate"),M.k0s()()()}if(2&n){const n=M.XpG(4);M.Y8G("detail",!1),M.BMQ("aria-label",M.bMT(1,5,n.gradesExpanded?"core.collapse":"core.expand")),M.R7$(2),M.AVh("expandable-status-icon-expanded",n.gradesExpanded),M.R7$(3),M.JRh(M.bMT(6,7,"core.grades.grades"))}}function AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ng_container_4_ion_item_1_span_6_Template(n,o){if(1&n&&(M.j41(0,"span"),M.EFF(1),M.k0s()),2&n){const n=M.XpG().$implicit;M.R7$(),M.JRh(n.gradeFormatted)}}function AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ng_container_4_ion_item_1_span_7_Template(n,o){1&n&&(M.j41(0,"span"),M.EFF(1),M.nI1(2,"translate"),M.k0s()),2&n&&(M.R7$(),M.JRh(M.bMT(2,1,"addon.mod_scorm.cannotcalculategrade")))}function AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ng_container_4_ion_item_1_Template(n,o){if(1&n&&(M.j41(0,"ion-item",13)(1,"ion-label")(2,"p",18),M.EFF(3),M.nI1(4,"translate"),M.k0s()(),M.j41(5,"p",0),M.DNE(6,AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ng_container_4_ion_item_1_span_6_Template,2,1,"span",5)(7,AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ng_container_4_ion_item_1_span_7_Template,3,3,"span",5),M.k0s()()),2&n){const n=o.$implicit;M.R7$(3),M.Lme("",M.bMT(4,4,"addon.mod_scorm.gradeforattempt")," ",n.num,""),M.R7$(3),M.Y8G("ngIf",-1!==n.grade),M.R7$(),M.Y8G("ngIf",-1===n.grade)}}function AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ng_container_4_Template(n,o){if(1&n&&(M.qex(0),M.DNE(1,AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ng_container_4_ion_item_1_Template,8,6,"ion-item",15),M.bVm()),2&n){const n=M.XpG(4);M.R7$(),M.Y8G("ngForOf",n.onlineAttempts)}}function AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_Template(n,o){if(1&n&&(M.qex(0),M.DNE(1,AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ion_item_1_Template,8,5,"ion-item",16)(2,AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ion_item_2_Template,7,4,"ion-item",16)(3,AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ion_item_3_Template,7,9,"ion-item",17)(4,AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_ng_container_4_Template,2,1,"ng-container",5),M.bVm()),2&n){const n=M.XpG(3);M.R7$(),M.Y8G("ngIf",n.scorm.maxattempt>=0),M.R7$(),M.Y8G("ngIf",n.numAttempts>=0),M.R7$(),M.Y8G("ngIf",n.onlineAttempts.length>0),M.R7$(),M.Y8G("ngIf",n.gradesExpanded&&n.onlineAttempts.length>0)}}function AddonModScormIndexComponent_div_6_ion_card_1_ion_item_7_p_5_Template(n,o){1&n&&(M.j41(0,"p"),M.EFF(1),M.nI1(2,"translate"),M.k0s()),2&n&&(M.R7$(),M.SpI(" ",M.bMT(2,1,"addon.mod_scorm.offlineattemptnote")," "))}function AddonModScormIndexComponent_div_6_ion_card_1_ion_item_7_p_6_Template(n,o){1&n&&(M.j41(0,"p"),M.EFF(1),M.nI1(2,"translate"),M.k0s()),2&n&&(M.R7$(),M.SpI(" ",M.bMT(2,1,"addon.mod_scorm.offlineattemptovermax")," "))}function AddonModScormIndexComponent_div_6_ion_card_1_ion_item_7_span_8_Template(n,o){if(1&n&&(M.j41(0,"span"),M.EFF(1),M.k0s()),2&n){const n=M.XpG().$implicit;M.R7$(),M.JRh(n.gradeFormatted)}}function AddonModScormIndexComponent_div_6_ion_card_1_ion_item_7_span_9_Template(n,o){1&n&&(M.j41(0,"span"),M.EFF(1),M.nI1(2,"translate"),M.k0s()),2&n&&(M.R7$(),M.JRh(M.bMT(2,1,"addon.mod_scorm.cannotcalculategrade")))}function AddonModScormIndexComponent_div_6_ion_card_1_ion_item_7_Template(n,o){if(1&n&&(M.j41(0,"ion-item",13)(1,"ion-label")(2,"p",18),M.EFF(3),M.nI1(4,"translate"),M.k0s(),M.DNE(5,AddonModScormIndexComponent_div_6_ion_card_1_ion_item_7_p_5_Template,3,3,"p",5)(6,AddonModScormIndexComponent_div_6_ion_card_1_ion_item_7_p_6_Template,3,3,"p",5),M.k0s(),M.j41(7,"p",0),M.DNE(8,AddonModScormIndexComponent_div_6_ion_card_1_ion_item_7_span_8_Template,2,1,"span",5)(9,AddonModScormIndexComponent_div_6_ion_card_1_ion_item_7_span_9_Template,3,3,"span",5),M.k0s()()),2&n){const n=o.$implicit,e=M.XpG(3);M.R7$(3),M.Lme("",M.bMT(4,6,"addon.mod_scorm.gradeforattempt")," ",n.num,""),M.R7$(2),M.Y8G("ngIf",!e.scorm.maxattempt||n.num<=e.scorm.maxattempt),M.R7$(),M.Y8G("ngIf",e.scorm.maxattempt&&n.num>e.scorm.maxattempt),M.R7$(2),M.Y8G("ngIf",-1!==n.grade),M.R7$(),M.Y8G("ngIf",-1===n.grade)}}function AddonModScormIndexComponent_div_6_ion_card_1_ion_item_8_Template(n,o){if(1&n&&(M.j41(0,"ion-item",13)(1,"ion-label")(2,"p",18),M.EFF(3),M.nI1(4,"translate"),M.k0s()(),M.j41(5,"p",0),M.EFF(6),M.k0s()()),2&n){const n=M.XpG(3);M.R7$(3),M.JRh(M.bMT(4,2,"addon.mod_scorm.grademethod")),M.R7$(3),M.JRh(n.gradeMethodReadable)}}function AddonModScormIndexComponent_div_6_ion_card_1_ion_item_9_span_6_Template(n,o){if(1&n&&(M.j41(0,"span"),M.EFF(1),M.k0s()),2&n){const n=M.XpG(4);M.R7$(),M.JRh(n.gradeFormatted)}}function AddonModScormIndexComponent_div_6_ion_card_1_ion_item_9_span_7_Template(n,o){1&n&&(M.j41(0,"span"),M.EFF(1),M.nI1(2,"translate"),M.k0s()),2&n&&(M.R7$(),M.JRh(M.bMT(2,1,"addon.mod_scorm.cannotcalculategrade")))}function AddonModScormIndexComponent_div_6_ion_card_1_ion_item_9_Template(n,o){if(1&n&&(M.j41(0,"ion-item",13)(1,"ion-label")(2,"p",18),M.EFF(3),M.nI1(4,"translate"),M.k0s()(),M.j41(5,"p",0),M.DNE(6,AddonModScormIndexComponent_div_6_ion_card_1_ion_item_9_span_6_Template,2,1,"span",5)(7,AddonModScormIndexComponent_div_6_ion_card_1_ion_item_9_span_7_Template,3,3,"span",5),M.k0s()()),2&n){const n=M.XpG(3);M.R7$(3),M.JRh(M.bMT(4,3,"addon.mod_scorm.gradereported")),M.R7$(3),M.Y8G("ngIf",-1!==n.grade),M.R7$(),M.Y8G("ngIf",-1===n.grade)}}function AddonModScormIndexComponent_div_6_ion_card_1_ion_item_10_Template(n,o){if(1&n&&(M.j41(0,"ion-item",13)(1,"ion-label")(2,"p",18),M.EFF(3),M.nI1(4,"translate"),M.k0s(),M.j41(5,"p"),M.EFF(6),M.k0s()()()),2&n){const n=M.XpG(3);M.R7$(3),M.JRh(M.bMT(4,2,"core.lastsync")),M.R7$(3),M.JRh(n.syncTime)}}function AddonModScormIndexComponent_div_6_ion_card_1_Template(n,o){if(1&n&&(M.j41(0,"ion-card")(1,"ion-card-header",13)(2,"ion-card-title"),M.EFF(3),M.nI1(4,"translate"),M.k0s()(),M.j41(5,"ion-list",14),M.DNE(6,AddonModScormIndexComponent_div_6_ion_card_1_ng_container_6_Template,5,4,"ng-container",5)(7,AddonModScormIndexComponent_div_6_ion_card_1_ion_item_7_Template,10,8,"ion-item",15)(8,AddonModScormIndexComponent_div_6_ion_card_1_ion_item_8_Template,7,4,"ion-item",16)(9,AddonModScormIndexComponent_div_6_ion_card_1_ion_item_9_Template,8,5,"ion-item",16)(10,AddonModScormIndexComponent_div_6_ion_card_1_ion_item_10_Template,7,4,"ion-item",16),M.k0s()()),2&n){const n=M.XpG(2);M.R7$(3),M.JRh(M.bMT(4,6,"addon.mod_scorm.attempts")),M.R7$(3),M.Y8G("ngIf",n.scorm.displayattemptstatus),M.R7$(),M.Y8G("ngForOf",n.offlineAttempts),M.R7$(),M.Y8G("ngIf",n.scorm.displayattemptstatus&&n.gradeMethodReadable),M.R7$(),M.Y8G("ngIf",n.scorm.displayattemptstatus&&n.gradeFormatted),M.R7$(),M.Y8G("ngIf",n.syncTime)}}function AddonModScormIndexComponent_div_6_ion_card_2_ion_item_6_ion_select_option_7_Template(n,o){if(1&n&&(M.j41(0,"ion-select-option",26),M.EFF(1),M.k0s()),2&n){const n=o.$implicit;M.Y8G("value",n.identifier),M.R7$(),M.SpI(" ",n.title," ")}}function AddonModScormIndexComponent_div_6_ion_card_2_ion_item_6_Template(n,o){if(1&n){const n=M.RV6();M.j41(0,"ion-item",13)(1,"ion-select",23),M.nI1(2,"translate"),M.nI1(3,"translate"),M.mxI("ngModelChange",(function AddonModScormIndexComponent_div_6_ion_card_2_ion_item_6_Template_ion_select_ngModelChange_1_listener(o){M.eBV(n);const e=M.XpG(3);return M.DH7(e.currentOrganization.identifier,o)||(e.currentOrganization.identifier=o),M.Njj(o)})),M.bIt("ionChange",(function AddonModScormIndexComponent_div_6_ion_card_2_ion_item_6_Template_ion_select_ionChange_1_listener(){M.eBV(n);const o=M.XpG(3);return M.Njj(o.loadOrganization())})),M.j41(4,"p",24),M.EFF(5),M.nI1(6,"translate"),M.k0s(),M.DNE(7,AddonModScormIndexComponent_div_6_ion_card_2_ion_item_6_ion_select_option_7_Template,2,2,"ion-select-option",25),M.k0s()()}if(2&n){const n=M.XpG(3);M.R7$(),M.R50("ngModel",n.currentOrganization.identifier),M.Y8G("cancelText",M.bMT(2,5,"core.cancel"))("interfaceOptions",M.eq3(11,_c0,M.bMT(3,7,"addon.mod_scorm.organizations"))),M.R7$(4),M.JRh(M.bMT(6,9,"addon.mod_scorm.organizations")),M.R7$(2),M.Y8G("ngForOf",n.organizations)}}function AddonModScormIndexComponent_div_6_ion_card_2_ion_item_7_Template(n,o){1&n&&(M.j41(0,"ion-item",27)(1,"ion-label"),M.nrm(2,"ion-spinner"),M.nI1(3,"translate"),M.k0s()()),2&n&&(M.R7$(2),M.BMQ("aria-label",M.bMT(3,1,"core.loading")))}function AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_p_2_Template(n,o){if(1&n&&(M.j41(0,"p"),M.EFF(1),M.nI1(2,"translate"),M.k0s()),2&n){const n=M.XpG(4);M.R7$(),M.SpI(" ",M.i5U(2,1,"addon.mod_scorm.dataattemptshown",M.eq3(4,_c1,n.attemptToContinue))," ")}}function AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_div_5_p_1_ion_icon_1_Template(n,o){if(1&n&&M.nrm(0,"ion-icon",31),2&n){const n=M.XpG(2).$implicit;M.Y8G("name",n.icon.icon),M.BMQ("aria-label",n.icon.description)}}function AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_div_5_p_1_button_2_Template(n,o){if(1&n){const n=M.RV6();M.j41(0,"button",32),M.bIt("click",(function AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_div_5_p_1_button_2_Template_button_click_0_listener(o){M.eBV(n);const e=M.XpG(2).$implicit,t=M.XpG(4);return M.Njj(t.open(o,!1,e.id))})),M.nrm(1,"core-format-text",33),M.k0s()}if(2&n){const n=M.XpG(2).$implicit,o=M.XpG(4);M.R7$(),M.Y8G("text",n.title)("contextInstanceId",o.module.id)("courseId",o.courseId)}}function AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_div_5_p_1_span_3_Template(n,o){if(1&n&&(M.j41(0,"span"),M.nrm(1,"core-format-text",33),M.k0s()),2&n){const n=M.XpG(2).$implicit,o=M.XpG(4);M.R7$(),M.Y8G("text",n.title)("contextInstanceId",o.module.id)("courseId",o.courseId)}}function AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_div_5_p_1_span_4_Template(n,o){if(1&n&&(M.j41(0,"span"),M.EFF(1),M.nI1(2,"translate"),M.k0s()),2&n){const n=M.XpG(2).$implicit;M.R7$(),M.Lme(" (",M.bMT(2,2,"addon.mod_scorm.score"),": ",n.scoreraw,") ")}}function AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_div_5_p_1_Template(n,o){if(1&n&&(M.j41(0,"p"),M.DNE(1,AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_div_5_p_1_ion_icon_1_Template,1,2,"ion-icon",29)(2,AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_div_5_p_1_button_2_Template,2,3,"button",30)(3,AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_div_5_p_1_span_3_Template,2,3,"span",5)(4,AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_div_5_p_1_span_4_Template,3,4,"span",5),M.k0s()),2&n){const n=M.XpG().$implicit,o=M.XpG(4);M.R7$(),M.Y8G("ngIf",n.icon),M.R7$(),M.Y8G("ngIf",n.prereq&&n.launch),M.R7$(),M.Y8G("ngIf",!n.prereq||!n.launch),M.R7$(),M.Y8G("ngIf",o.accessInfo&&o.accessInfo.canviewscores&&n.scoreraw)}}function AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_div_5_Template(n,o){if(1&n&&(M.j41(0,"div"),M.DNE(1,AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_div_5_p_1_Template,5,4,"p",5),M.k0s()),2&n){const n=o.$implicit;M.STu("core-padding-",n.level," addon-mod_scorm-type-",n.scormtype,""),M.R7$(),M.Y8G("ngIf",n.isvisible)}}function AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_Template(n,o){if(1&n&&(M.j41(0,"ion-item",13)(1,"ion-label"),M.DNE(2,AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_p_2_Template,3,6,"p",5),M.j41(3,"p"),M.EFF(4),M.k0s(),M.DNE(5,AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_div_5_Template,2,5,"div",28),M.k0s()()),2&n){const n=M.XpG(3);M.R7$(2),M.Y8G("ngIf",n.attemptToContinue),M.R7$(2),M.JRh(n.currentOrganization.title),M.R7$(),M.Y8G("ngForOf",n.toc)}}function AddonModScormIndexComponent_div_6_ion_card_2_Template(n,o){if(1&n&&(M.j41(0,"ion-card",21)(1,"ion-card-header",13)(2,"ion-card-title"),M.EFF(3),M.nI1(4,"translate"),M.k0s()(),M.j41(5,"ion-list"),M.DNE(6,AddonModScormIndexComponent_div_6_ion_card_2_ion_item_6_Template,8,13,"ion-item",16)(7,AddonModScormIndexComponent_div_6_ion_card_2_ion_item_7_Template,4,3,"ion-item",22)(8,AddonModScormIndexComponent_div_6_ion_card_2_ion_item_8_Template,6,3,"ion-item",16),M.k0s()()),2&n){const n=M.XpG(2);M.R7$(3),M.JRh(M.bMT(4,4,"addon.mod_scorm.contents")),M.R7$(3),M.Y8G("ngIf",n.organizations.length>1),M.R7$(),M.Y8G("ngIf",n.scorm.displaycoursestructure&&n.loadingToc),M.R7$(),M.Y8G("ngIf",n.scorm.displaycoursestructure&&!n.loadingToc)}}function AddonModScormIndexComponent_div_6_Template(n,o){if(1&n&&(M.j41(0,"div"),M.DNE(1,AddonModScormIndexComponent_div_6_ion_card_1_Template,11,8,"ion-card",5)(2,AddonModScormIndexComponent_div_6_ion_card_2_Template,9,6,"ion-card",12),M.k0s()),2&n){const n=M.XpG();M.R7$(),M.Y8G("ngIf",(n.scorm.displayattemptstatus||n.offlineAttempts.length)&&!n.skip),M.R7$(),M.Y8G("ngIf",n.scorm&&n.organizations&&!n.skip&&(n.scorm.displaycoursestructure&&n.organizations.length||n.organizations.length>1))}}function AddonModScormIndexComponent_div_7_div_1_ng_container_1_Template(n,o){if(1&n&&(M.qex(0),M.j41(1,"ion-item",13)(2,"ion-label")(3,"p",39),M.EFF(4),M.nI1(5,"translate"),M.k0s()()(),M.j41(6,"ion-button",40),M.EFF(7),M.nI1(8,"translate"),M.nrm(9,"ion-icon",41),M.k0s(),M.bVm()),2&n){const n=M.XpG(3);M.R7$(4),M.JRh(M.bMT(5,4,n.errorMessage)),M.R7$(2),M.Y8G("href",n.module.url)("showBrowserWarning",!1),M.R7$(),M.SpI(" ",M.bMT(8,6,"core.openinbrowser")," ")}}function AddonModScormIndexComponent_div_7_div_1_ion_card_2_Template(n,o){1&n&&(M.j41(0,"ion-card",42)(1,"ion-item",13)(2,"ion-label")(3,"p"),M.EFF(4),M.nI1(5,"translate"),M.k0s()()()()),2&n&&(M.R7$(4),M.JRh(M.bMT(5,1,"addon.mod_scorm.exceededmaxattempts")))}function AddonModScormIndexComponent_div_7_div_1_ng_container_3_ng_container_1_ion_item_1_Template(n,o){if(1&n){const n=M.RV6();M.j41(0,"ion-item",13)(1,"ion-checkbox",46),M.mxI("ngModelChange",(function AddonModScormIndexComponent_div_7_div_1_ng_container_3_ng_container_1_ion_item_1_Template_ion_checkbox_ngModelChange_1_listener(o){M.eBV(n);const e=M.XpG(5);return M.DH7(e.startNewAttempt,o)||(e.startNewAttempt=o),M.Njj(o)})),M.EFF(2),M.nI1(3,"translate"),M.k0s()()}if(2&n){const n=M.XpG(5);M.R7$(),M.R50("ngModel",n.startNewAttempt),M.R7$(),M.SpI(" ",M.bMT(3,2,"addon.mod_scorm.newattempt")," ")}}function AddonModScormIndexComponent_div_7_div_1_ng_container_3_ng_container_1_ion_item_2_Template(n,o){if(1&n&&(M.j41(0,"ion-item")(1,"ion-label",47)(2,"p"),M.EFF(3),M.nI1(4,"translate"),M.k0s()()()),2&n){const n=M.XpG(5);M.R7$(3),M.JRh(M.bMT(4,1,n.statusMessage))}}function AddonModScormIndexComponent_div_7_div_1_ng_container_3_ng_container_1_ion_button_4_Template(n,o){if(1&n){const n=M.RV6();M.j41(0,"ion-button",48),M.bIt("click",(function AddonModScormIndexComponent_div_7_div_1_ng_container_3_ng_container_1_ion_button_4_Template_ion_button_click_0_listener(o){M.eBV(n);const e=M.XpG(5);return M.Njj(e.open(o,!0))})),M.nrm(1,"ion-icon",49),M.EFF(2),M.nI1(3,"translate"),M.k0s()}2&n&&(M.R7$(2),M.SpI(" ",M.bMT(3,1,"addon.mod_scorm.browse")," "))}function AddonModScormIndexComponent_div_7_div_1_ng_container_3_ng_container_1_Template(n,o){if(1&n){const n=M.RV6();M.qex(0),M.DNE(1,AddonModScormIndexComponent_div_7_div_1_ng_container_3_ng_container_1_ion_item_1_Template,4,4,"ion-item",16)(2,AddonModScormIndexComponent_div_7_div_1_ng_container_3_ng_container_1_ion_item_2_Template,5,3,"ion-item",5),M.j41(3,"div",43),M.DNE(4,AddonModScormIndexComponent_div_7_div_1_ng_container_3_ng_container_1_ion_button_4_Template,4,3,"ion-button",44),M.j41(5,"ion-button",45),M.bIt("click",(function AddonModScormIndexComponent_div_7_div_1_ng_container_3_ng_container_1_Template_ion_button_click_5_listener(o){M.eBV(n);const e=M.XpG(4);return M.Njj(e.open(o))})),M.EFF(6),M.nI1(7,"translate"),M.k0s()(),M.bVm()}if(2&n){const n=M.XpG(4);M.R7$(),M.Y8G("ngIf",!n.scorm.forcenewattempt&&n.numAttempts>0&&!n.incomplete&&n.attemptsLeft>0),M.R7$(),M.Y8G("ngIf",n.statusMessage),M.R7$(2),M.Y8G("ngIf",!n.scorm.hidebrowse),M.R7$(2),M.SpI(" ",M.bMT(7,4,"addon.mod_scorm.enter")," ")}}function AddonModScormIndexComponent_div_7_div_1_ng_container_3_ion_item_2_p_4_Template(n,o){if(1&n&&(M.j41(0,"p",18),M.EFF(1),M.nI1(2,"translate"),M.k0s()),2&n){const n=M.XpG(5);M.R7$(),M.JRh(M.bMT(2,1,n.progressMessage))}}function AddonModScormIndexComponent_div_7_div_1_ng_container_3_ion_item_2_core_progress_bar_5_Template(n,o){if(1&n&&M.nrm(0,"core-progress-bar",52),2&n){const n=M.XpG(5);M.Y8G("progress",n.percentage)("a11yText",n.progressMessage)}}function AddonModScormIndexComponent_div_7_div_1_ng_container_3_ion_item_2_Template(n,o){if(1&n&&(M.j41(0,"ion-item",27)(1,"ion-label"),M.nrm(2,"ion-spinner"),M.nI1(3,"translate"),M.DNE(4,AddonModScormIndexComponent_div_7_div_1_ng_container_3_ion_item_2_p_4_Template,3,3,"p",50)(5,AddonModScormIndexComponent_div_7_div_1_ng_container_3_ion_item_2_core_progress_bar_5_Template,1,2,"core-progress-bar",51),M.k0s()()),2&n){const n=M.XpG(4);M.R7$(2),M.BMQ("aria-label",M.bMT(3,3,"core.loading")),M.R7$(2),M.Y8G("ngIf",n.progressMessage),M.R7$(),M.Y8G("ngIf",n.showPercentage)}}function AddonModScormIndexComponent_div_7_div_1_ng_container_3_Template(n,o){if(1&n&&(M.qex(0),M.DNE(1,AddonModScormIndexComponent_div_7_div_1_ng_container_3_ng_container_1_Template,8,6,"ng-container",5)(2,AddonModScormIndexComponent_div_7_div_1_ng_container_3_ion_item_2_Template,6,5,"ion-item",22),M.bVm()),2&n){const n=M.XpG(3);M.R7$(),M.Y8G("ngIf",!n.downloading&&!n.skip),M.R7$(),M.Y8G("ngIf",n.downloading)}}function AddonModScormIndexComponent_div_7_div_1_Template(n,o){if(1&n&&(M.j41(0,"div",37),M.DNE(1,AddonModScormIndexComponent_div_7_div_1_ng_container_1_Template,10,8,"ng-container",5)(2,AddonModScormIndexComponent_div_7_div_1_ion_card_2_Template,6,3,"ion-card",38)(3,AddonModScormIndexComponent_div_7_div_1_ng_container_3_Template,3,2,"ng-container",5),M.k0s()),2&n){const n=M.XpG(2);M.R7$(),M.Y8G("ngIf",n.errorMessage),M.R7$(),M.Y8G("ngIf",!n.errorMessage&&0===n.attemptsLeft),M.R7$(),M.Y8G("ngIf",!n.errorMessage&&(!n.scorm.lastattemptlock||n.attemptsLeft>0))}}function AddonModScormIndexComponent_div_7_Template(n,o){if(1&n&&(M.j41(0,"div",34),M.DNE(1,AddonModScormIndexComponent_div_7_div_1_Template,4,3,"div",35),M.nrm(2,"core-course-module-navigation",36),M.k0s()),2&n){const n=M.XpG();M.R7$(),M.Y8G("ngIf",n.scorm&&!n.scorm.warningMessage),M.R7$(),M.Y8G("courseId",n.courseId)("currentModuleId",n.module.id)}}let N=(()=>{var n;class AddonModScormIndexComponent extends r.y{constructor(n,o){super("AddonModScormIndexComponent",n,o),this.content=n,this.component=v.Rz,this.pluginName="scorm",this.currentOrganization={identifier:""},this.startNewAttempt=!1,this.hasOffline=!1,this.downloading=!1,this.showPercentage=!1,this.organizations=[],this.loadingToc=!1,this.incomplete=!1,this.numAttempts=-1,this.attemptsLeft=-1,this.onlineAttempts=[],this.offlineAttempts=[],this.gradesExpanded=!1,this.fetchContentDefaultError="addon.mod_scorm.errorgetscorm",this.syncEventName=v.xg,this.lastIsOffline=!1,this.hasPlayed=!1,this.dataSent=!1}ngOnInit(){var _superprop_getNgOnInit=()=>super.ngOnInit,n=this;return(0,t.A)((function*(){_superprop_getNgOnInit().call(n),yield n.loadContent(!1,!0),n.scorm&&n.skip&&n.open()}))()}downloadScormPackage(){var n=this;return(0,t.A)((function*(){n.downloading=!0;try{yield u._.download(n.module,n.courseId,void 0,(o=>{if(o&&n.scorm)if(n.percentage=void 0,n.showPercentage=!1,o.downloading){if(n.scorm.packagesize&&o.progress){const e=100*Number(o.progress.loaded/n.scorm.packagesize);n.percentage=e.toFixed(1),n.showPercentage=e>=0&&e<=100}}else if(o.message)n.progressMessage=o.message;else if(o.progress&&o.progress.loaded&&o.progress.total){const e=100*Number(o.progress.loaded/o.progress.total);n.percentage=e.toFixed(1),n.showPercentage=e>=0&&e<=100}}))}finally{n.progressMessage=void 0,n.percentage=void 0,n.downloading=!1}}))()}fetchContent(n,o=!1,e=!1){var i=this;return(0,t.A)((function*(){if(i.scorm=yield g.v.getScorm(i.courseId,i.module.id,{moduleUrl:i.module.url}),i.dataRetrieved.emit(i.scorm),i.description=i.scorm.intro||i.description,i.errorMessage=g.v.isScormUnsupported(i.scorm),i.scorm.warningMessage)return;o&&(yield A.g.ignoreErrors(i.syncActivity(e)));const[n,t]=yield Promise.all([I.S.getReadableSyncTime(i.scorm.id),g.v.getAccessInformation(i.scorm.id,{cmId:i.module.id}),i.fetchAttemptData(i.scorm)]);var d;(i.syncTime=n,i.accessInfo=t,void 0===i.skip)&&(i.skip=!i.hasOffline&&!i.errorMessage&&(!i.scorm.lastattemptlock||i.attemptsLeft>0)&&(!!i.autoPlayData||i.accessInfo.canskipview&&!i.accessInfo.canviewreport&&(null!==(d=i.scorm.skipview)&&void 0!==d?d:0)>=1&&(2===i.scorm.skipview||0===i.lastAttempt)))}))()}fetchAttemptData(n){var o=this;return(0,t.A)((function*(){o.attempts=yield g.v.getAttemptCount(n.id,{cmId:o.module.id}),o.hasOffline=!!o.attempts.offline.length;const e=yield f.V.determineAttemptToContinue(n,o.attempts);o.lastAttempt=e.num,o.lastIsOffline=e.offline,o.attemptToContinue=o.lastAttempt!==o.attempts.lastAttempt.num?o.lastAttempt:void 0,o.incomplete=yield g.v.isAttemptIncomplete(n.id,o.lastAttempt,{offline:o.lastIsOffline,cmId:o.module.id}),o.numAttempts=o.attempts.total,o.gradeMethodReadable=g.v.getScormGradeMethod(n),o.attemptsLeft=g.v.countAttemptsLeft(n,o.attempts.lastAttempt.num),(2===n.forcenewattempt||n.forcenewattempt&&!o.incomplete)&&(o.startNewAttempt=!0),yield Promise.all([o.getReportedGrades(n,o.attempts),o.fetchStructure(n),o.loadPackageSize(n),o.setStatusListener()])}))()}loadPackageSize(n){var o=this;return(0,t.A)((function*(){n.packagesize||o.errorMessage||(n.packagesize=yield g.v.calculateScormSize(n))}))()}fetchStructure(n){var o=this;return(0,t.A)((function*(){var e;return o.organizations=yield g.v.getOrganizations(n.id,{cmId:o.module.id}),""===o.currentOrganization.identifier&&null!==(e=o.organizations[0])&&void 0!==e&&e.identifier&&(o.currentOrganization.identifier=o.organizations[0].identifier),o.loadOrganizationToc(n,o.currentOrganization.identifier)}))()}getAttemptGrade(n,o,e){var i=this;return(0,t.A)((function*(){i.scorm&&(e[n]=yield g.v.getAttemptGrade(i.scorm,n,o))}))()}getReportedGrades(n,o){var e=this;return(0,t.A)((function*(){const t=[],i={},d={};o.online.forEach((n=>{-1==o.offline.indexOf(n)&&t.push(e.getAttemptGrade(n,!1,i))})),o.offline.forEach((n=>{t.push(e.getAttemptGrade(n,!0,d))})),yield Promise.all(t),e.grade=g.v.calculateScormGrade(n,i),e.onlineAttempts=m.T.toArray(i),e.offlineAttempts=m.T.toArray(d),e.onlineAttempts.sort(((n,o)=>n.num-o.num)),e.offlineAttempts.sort(((n,o)=>n.num-o.num)),e.onlineAttempts.forEach((o=>{o.gradeFormatted=g.v.formatGrade(n,o.score)})),e.offlineAttempts.forEach((o=>{o.gradeFormatted=g.v.formatGrade(n,o.score)})),e.gradeFormatted=g.v.formatGrade(n,e.grade)}))()}logActivity(){var n=this;return(0,t.A)((function*(){n.scorm&&(yield A.g.ignoreErrors(g.v.logView(n.scorm.id)),n.analyticsLogEvent("mod_scorm_view_scorm"))}))()}hasSyncSucceed(n){return(n.updated||this.dataSent)&&this.checkCompletion(),this.dataSent=!1,n.updated}ionViewDidEnter(){super.ionViewDidEnter(),this.hasPlayed&&(this.hasPlayed=!1,this.startNewAttempt=!1,setTimeout((()=>{var n;null===(n=this.dataSentObserver)||void 0===n||n.off(),this.dataSentObserver=void 0,this.showLoadingAndRefresh(!0,!1)}),500))}invalidateContent(){var n=this;return(0,t.A)((function*(){const o=[];o.push(g.v.invalidateScormData(n.courseId)),n.scorm&&o.push(g.v.invalidateAllScormData(n.scorm.id)),yield Promise.all(o)}))()}isRefreshSyncNeeded(n){return!(!n.updated||!this.scorm||n.scormId!=this.scorm.id)&&(this.checkCompletion(),!0)}loadOrganization(){var n=this;return(0,t.A)((function*(){if(n.scorm)try{yield n.loadOrganizationToc(n.scorm,n.currentOrganization.identifier)}catch(o){s.CoreDomUtils.showErrorModalDefault(o,n.fetchContentDefaultError,!0)}}))()}loadOrganizationToc(n,o){var e=this;return(0,t.A)((function*(){if(n.displaycoursestructure&&void 0!==e.lastAttempt){e.loadingToc=!0;try{e.toc=yield f.V.getToc(n.id,e.lastAttempt,e.incomplete,{organization:o,offline:e.lastIsOffline,cmId:e.module.id});const t=e.organizations.find((n=>n.identifier===o));t&&(e.currentOrganization.title=t.title)}finally{e.loadingToc=!1}}}))()}open(n,o=!1,e){var d=this;return(0,t.A)((function*(){if(null==n||n.preventDefault(),null==n||n.stopPropagation(),d.downloading||!d.scorm)return;const t=d.currentStatus===i.DownloadStatus.OUTDATED,r=d.scorm;if(!t&&d.currentStatus!==i.DownloadStatus.DOWNLOADABLE_NOT_DOWNLOADED)return d.openScorm(e,o),void 0;yield f.V.confirmDownload(r,t),t&&(yield A.g.ignoreErrors(g.v.invalidateAllScormData(r.id)));try{yield d.downloadScormPackage(),d.isDestroyed||d.openScorm(e,o)}catch(n){d.isDestroyed||s.CoreDomUtils.showErrorModalDefault(n,l.HT.instant("addon.mod_scorm.errordownloadscorm",{name:r.name}))}}))()}toggleGrades(){this.gradesExpanded=!this.gradesExpanded}openScorm(n,o=!1){var e,t,i,d,r;const c=this.autoPlayData;this.autoPlayData=void 0,this.skip=!1,this.hasPlayed=!0,null===(e=this.dataSentObserver)||void 0===e||e.off(),this.dataSentObserver=p.z.on(v.OI,(n=>{var o;n.scormId===(null===(o=this.scorm)||void 0===o?void 0:o.id)&&(this.dataSent=!0,this.module.completiondata&&a.CoreCourse.isIncompleteAutomaticCompletion(this.module.completiondata)&&a.CoreCourse.invalidateSections(this.courseId))}),this.siteId),_.CoreNavigator.navigateToSitePath(`${v.T2}/${this.courseId}/${this.module.id}/player`,{params:{mode:null!==(t=null==c?void 0:c.mode)&&void 0!==t?t:o?"browse":"normal",moduleUrl:this.module.url,newAttempt:null!==(i=null==c?void 0:c.newAttempt)&&void 0!==i?i:this.startNewAttempt,organizationId:null!==(d=null==c?void 0:c.organizationId)&&void 0!==d?d:this.currentOrganization.identifier,scoId:null!==(r=null==c?void 0:c.scoId)&&void 0!==r?r:n}})}showStatus(n){var o=this;return(0,t.A)((function*(){if(n===i.DownloadStatus.OUTDATED&&o.scorm){const n=yield g.v.shouldDownloadMainFile(o.scorm,!0);o.statusMessage=n?"addon.mod_scorm.scormstatusoutdated":""}else n===i.DownloadStatus.DOWNLOADABLE_NOT_DOWNLOADED?o.statusMessage="addon.mod_scorm.scormstatusnotdownloaded":n===i.DownloadStatus.DOWNLOADING?o.downloading||o.downloadScormPackage():o.statusMessage=""}))()}sync(n=0){var o=this;return(0,t.A)((function*(){if(!o.scorm)throw new d.CoreError("Cannot sync without a scorm.");if(c.CoreSync.isBlocked(v.Rz,o.scorm.id)&&n<5)return yield h.H.wait(400),o.sync(n+1);const e=yield I.S.syncScorm(o.scorm);return!e.updated&&o.dataSent&&(yield A.g.ignoreErrors(I.S.prefetchAfterUpdate(u._.instance,o.module,o.courseId))),e}))()}}return(n=AddonModScormIndexComponent).ɵfac=function AddonModScormIndexComponent_Factory(o){return new(o||n)(M.rXU(x.W9),M.rXU(S.k,8))},n.ɵcmp=M.VBU({type:n,selectors:[["addon-mod-scorm-index"]],inputs:{autoPlayData:"autoPlayData"},features:[M.Vt3],decls:8,vars:11,consts:[["slot","end"],["fill","clear","aria-haspopup","true",3,"ariaLabel"],[3,"hideUntil"],[3,"completionChanged","module","description","component","componentId","courseId","hasDataToSync"],["class","core-info-card",4,"ngIf"],[4,"ngIf"],["collapsible-footer","","slot","fixed",4,"ngIf"],["fill","clear","aria-haspopup","true",3,"click","ariaLabel"],["name","fas-circle-info","slot","icon-only","aria-hidden","true"],["iconAction","fas-circle-info",3,"action","priority","content"],[1,"core-info-card"],["name","fas-circle-info","slot","start","aria-hidden","true"],["class","addon-mod_scorm-toc",4,"ngIf"],[1,"ion-text-wrap"],[1,"addon-mod_scorm-attempt-summary"],["class","ion-text-wrap",4,"ngFor","ngForOf"],["class","ion-text-wrap",4,"ngIf"],["button","","class","divider ion-text-wrap",3,"detail","click",4,"ngIf"],[1,"item-heading"],["button","",1,"divider","ion-text-wrap",3,"click","detail"],["name","fas-chevron-right","flip-rtl","","slot","start","aria-hidden","true",1,"expandable-status-icon"],[1,"addon-mod_scorm-toc"],["class","ion-text-center",4,"ngIf"],["interface","action-sheet",3,"ngModelChange","ionChange","ngModel","cancelText","interfaceOptions"],["slot","label",1,"item-heading"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"ion-text-center"],[3,"class",4,"ngFor","ngForOf"],[3,"name",4,"ngIf"],["class","as-link",3,"click",4,"ngIf"],[3,"name"],[1,"as-link",3,"click"],["contextLevel","module",3,"text","contextInstanceId","courseId"],["collapsible-footer","","slot","fixed"],["class","list-item-limited-width",4,"ngIf"],[3,"courseId","currentModuleId"],[1,"list-item-limited-width"],["class","core-danger-card",4,"ngIf"],[1,"text-danger"],["expand","block","core-link","",1,"ion-margin","ion-text-wrap",3,"href","showBrowserWarning"],["name","fas-up-right-from-square","slot","end","aria-hidden","true"],[1,"core-danger-card"],[1,"adaptable-buttons-row"],["expand","block","fill","outline","class","ion-text-wrap ion-margin",3,"click",4,"ngIf"],["expand","block",1,"ion-text-wrap","ion-margin",3,"click"],["name","newAttempt",3,"ngModelChange","ngModel"],[1,"ion-text-wrap","ion-no-margin","ion-margin-top"],["expand","block","fill","outline",1,"ion-text-wrap","ion-margin",3,"click"],["name","fas-magnifying-glass","slot","start","aria-hidden","true"],["class","item-heading",4,"ngIf"],[3,"progress","a11yText",4,"ngIf"],[3,"progress","a11yText"]],template:function AddonModScormIndexComponent_Template(n,o){1&n&&(M.j41(0,"core-navbar-buttons",0),M.DNE(1,AddonModScormIndexComponent_Conditional_1_Template,3,3,"ion-button",1)(2,AddonModScormIndexComponent_Conditional_2_Template,3,4),M.k0s(),M.j41(3,"core-loading",2)(4,"core-course-module-info",3),M.bIt("completionChanged",(function AddonModScormIndexComponent_Template_core_course_module_info_completionChanged_4_listener(){return o.onCompletionChange()})),M.k0s(),M.DNE(5,AddonModScormIndexComponent_ion_card_5_Template,5,1,"ion-card",4)(6,AddonModScormIndexComponent_div_6_Template,3,2,"div",5)(7,AddonModScormIndexComponent_div_7_Template,3,3,"div",6),M.k0s()),2&n&&(M.R7$(),M.vxM(1,o.courseContentsPage?2:1),M.R7$(2),M.Y8G("hideUntil",!o.showLoading),M.R7$(),M.Y8G("module",o.module)("description",o.description)("component",o.component)("componentId",o.componentId)("courseId",o.courseId)("hasDataToSync",!o.errorMessage&&o.hasOffline),M.R7$(),M.Y8G("ngIf",o.scorm&&o.scorm.warningMessage),M.R7$(),M.Y8G("ngIf",o.scorm&&!o.showLoading&&!o.scorm.warningMessage),M.R7$(),M.Y8G("ngIf",!o.showLoading))},dependencies:[T.Sq,T.bT,C.B,R.Q,b.R,G.c,k.z,$.t,w.B,y.j,F.i,E.T,D.BC,D.vS,x.Jm,x.b_,x.ME,x.tN,x.eY,x.iq,x.uz,x.he,x.nf,x.Nm,x.Ip,x.w2,x.hB,x.Je,j.Y,O.Q,Y.D9],styles:["[_nghost-%COMP%]   .addon-mod_scorm-attempt-summary[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]{font-size:var(--text-size)}[_nghost-%COMP%]   .addon-mod_scorm-toc[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-inline-end:8px;margin-top:4px}"]}),AddonModScormIndexComponent})()},8214:(n,o,e)=>{e.d(o,{V:()=>g});var t=e(10467),i=e(75629),d=e(52749),r=e(89911),a=e(81690),_=e(79555),c=e(1717),s=e(85387),m=e(55554),l=e(54438);const p=["status","score_raw","total_time","session_time","student_id","student_name","credit","mode","entry"];let u=(()=>{var n;class AddonModScormHelperProvider{confirmDownload(n,o){return(0,t.A)((function*(){if(!(yield c.v.shouldDownloadMainFile(n,o)))return;let e=n.packagesize;return e||(e=yield c.v.calculateScormSize(n),n.packagesize=e),r.CoreDomUtils.confirmDownloadSize({size:e,total:!0})}))()}convertAttemptToOffline(n,o,e){return(0,t.A)((function*(){e=e||d.CoreSites.getCurrentSiteId();const t=yield m.g.ignoreErrors(c.v.getScormUserData(n.id,o,{cmId:n.coursemodule,siteId:e}));if(!t)throw new i.CoreError(_.HT.instant("addon.mod_scorm.errorcreateofflineattempt"));const r=yield m.g.ignoreErrors(s.o.getScormUserData(n.id,o,void 0,e)),l=a.j.clone(t);for(const n in l){const o=l[n];if(p.forEach((n=>{delete o.userdata[n]})),r&&r[o.scoid]&&r[o.scoid].userdata){const n={};for(const e in o.userdata)r[o.scoid].userdata[e]||(n[e]=o.userdata[e]);o.userdata=n}}yield s.o.createNewAttempt(n,o,l,t,e)}))()}createOfflineAttempt(n,o,e,r){var a=this;return(0,t.A)((function*(){r=r||d.CoreSites.getCurrentSiteId();const t=yield m.g.ignoreErrors(a.searchOnlineAttemptUserData(n.id,e,{cmId:n.coursemodule,siteId:r}));if(!t)throw new i.CoreError(_.HT.instant("addon.mod_scorm.errorcreateofflineattempt"));for(const n in t){const o=t[n],e={};for(const n in o.userdata)-1==n.indexOf(".")&&-1==p.indexOf(n)&&(e[n]=o.userdata[n]);o.userdata=e}return s.o.createNewAttempt(n,o,t,void 0,r)}))()}determineAttemptToContinue(n,o,e){var i=this;return(0,t.A)((function*(){let t;if(o.online.length&&(t=Math.max.apply(Math,o.online)),!t)return i.getLastBeforeMax(n,o);const d=o.offline.indexOf(t)>-1;return(yield c.v.isAttemptIncomplete(n.id,t,{offline:d,cmId:n.coursemodule,siteId:e}))?{num:t,offline:d}:i.getLastBeforeMax(n,o)}))()}getFirstSco(n,o,e={}){return(0,t.A)((function*(){const t="normal"===(e.mode||"normal");let i=e.toc;i&&i.length||(i=yield c.v.getScosWithData(n,o,e));return i.find((n=>n.isvisible&&n.launch&&n.prereq&&(!t||c.v.isStatusIncomplete(n.status))))||i[0]}))()}getLastBeforeMax(n,o){return n.maxattempt&&o.lastAttempt.num>n.maxattempt?{num:n.maxattempt,offline:o.offline.indexOf(n.maxattempt)>-1}:{num:o.lastAttempt.num,offline:o.lastAttempt.offline}}getNextScoFromToc(n,o){for(let e=n.findIndex((n=>n.id==o))+1;e<n.length;e++)if(n[e].isvisible&&n[e].prereq&&n[e].launch)return n[e]}getPreviousScoFromToc(n,o){for(let e=n.findIndex((n=>n.id==o))-1;e>=0;e--)if(n[e].isvisible&&n[e].prereq&&n[e].launch)return n[e]}getScoFromToc(n,o){return n.find((n=>n.id==o))}getToc(n,o,e,i={}){return(0,t.A)((function*(){const t=yield c.v.getOrganizationToc(n,o,i),d=c.v.formatTocToArray(t);return d.forEach((n=>{n.icon=c.v.getScoStatusIcon(n,e)})),d}))()}searchOnlineAttemptUserData(n,o,e={}){var i=this;return(0,t.A)((function*(){e.siteId=e.siteId||d.CoreSites.getCurrentSiteId();try{return yield c.v.getScormUserData(n,o,e)}catch(t){if(o<=0)throw t;try{return yield i.searchOnlineAttemptUserData(n,o-1,e)}catch{throw t}}}))()}}return(n=AddonModScormHelperProvider).ɵfac=function AddonModScormHelperProvider_Factory(o){return new(o||n)},n.ɵprov=l.jDH({token:n,factory:n.ɵfac,providedIn:"root"}),AddonModScormHelperProvider})();const g=(0,_.Qd)(u)}}]);