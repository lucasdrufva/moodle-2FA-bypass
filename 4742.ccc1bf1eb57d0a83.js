"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4742],{64742:(e,t,o)=>{o.r(t),o.d(t,{default:()=>X});var r=o(3353),n=o(21182),i=o(91416),a=o(54438),l=o(42176),p=o(60177),s=o(86198),_=o(58197),c=o(73465),d=o(73955);function CoreReportBuilderReportColumnComponent_p_3_Template(e,t){if(1&e&&(a.j41(0,"p",5),a.EFF(1),a.k0s()),2&e){const e=a.XpG();a.R7$(),a.SpI(" ",e.header," ")}}function CoreReportBuilderReportColumnComponent_h2_4_core_format_text_1_Template(e,t){if(1&e&&a.nrm(0,"core-format-text",7),2&e){const e=a.XpG(2);a.Y8G("text",e.column)("contextLevel",e.source)("contextInstanceId",e.contextId)}}function CoreReportBuilderReportColumnComponent_h2_4_ng_template_2_Template(e,t){if(1&e&&a.EFF(0),2&e){const e=a.XpG(2);a.JRh(e.column)}}function CoreReportBuilderReportColumnComponent_h2_4_Template(e,t){if(1&e&&(a.j41(0,"h2"),a.DNE(1,CoreReportBuilderReportColumnComponent_h2_4_core_format_text_1_Template,1,3,"core-format-text",6)(2,CoreReportBuilderReportColumnComponent_h2_4_ng_template_2_Template,1,1,"ng-template",null,0,a.C5r),a.k0s()),2&e){const e=a.sdS(3),t=a.XpG();a.R7$(),a.Y8G("ngIf",t.isString(t.column))("ngIfElse",e)}}function CoreReportBuilderReportColumnComponent_ng_container_5_core_format_text_1_Template(e,t){if(1&e&&a.nrm(0,"core-format-text",7),2&e){const e=a.XpG(2);a.Y8G("text",e.column)("contextLevel",e.source)("contextInstanceId",e.contextId)}}function CoreReportBuilderReportColumnComponent_ng_container_5_ng_template_2_Template(e,t){if(1&e&&a.EFF(0),2&e){const e=a.XpG(2);a.JRh(e.column)}}function CoreReportBuilderReportColumnComponent_ng_container_5_Template(e,t){if(1&e&&(a.qex(0),a.DNE(1,CoreReportBuilderReportColumnComponent_ng_container_5_core_format_text_1_Template,1,3,"core-format-text",6)(2,CoreReportBuilderReportColumnComponent_ng_container_5_ng_template_2_Template,1,1,"ng-template",null,0,a.C5r),a.bVm()),2&e){const e=a.sdS(3),t=a.XpG();a.R7$(),a.Y8G("ngIf",t.isString(t.column))("ngIfElse",e)}}function CoreReportBuilderReportColumnComponent_ion_icon_6_Template(e,t){if(1&e&&a.nrm(0,"ion-icon",8),2&e){const e=a.XpG();a.AVh("expandable-status-icon-expanded",!e.isExpanded)}}let u=(()=>{var e;class CoreReportBuilderReportColumnComponent{constructor(){this.isExpanded=!1,this.isExpandable=!1,this.showFirstTitle=!1,this.onToggleRow=new a.bkB,this.isString=e=>l.Zn.isString(e)}toggleRow(){this.onToggleRow.emit(this.rowIndex)}}return(e=CoreReportBuilderReportColumnComponent).ɵfac=function CoreReportBuilderReportColumnComponent_Factory(t){return new(t||e)},e.ɵcmp=a.VBU({type:e,selectors:[["core-report-builder-report-column"]],inputs:{isExpanded:[a.Mj6.HasDecoratorInputTransform,"isExpanded","isExpanded",i.G],isExpandable:[a.Mj6.HasDecoratorInputTransform,"isExpandable","isExpandable",i.G],showFirstTitle:[a.Mj6.HasDecoratorInputTransform,"showFirstTitle","showFirstTitle",i.G],columnIndex:"columnIndex",rowIndex:"rowIndex",column:"column",contextId:"contextId",header:"header",source:"source"},outputs:{onToggleRow:"onToggleRow"},features:[a.GFd],decls:7,vars:11,consts:[["notText",""],["lines","inset",1,"ion-text-wrap",3,"click","detail","button"],["class","item-heading",4,"ngIf"],[4,"ngIf"],["slot","end","aria-hidden","true","name","fas-chevron-up","class","expandable-status-icon","flip-rtl","",3,"expandable-status-icon-expanded",4,"ngIf"],[1,"item-heading"],[3,"text","contextLevel","contextInstanceId",4,"ngIf","ngIfElse"],[3,"text","contextLevel","contextInstanceId"],["slot","end","aria-hidden","true","name","fas-chevron-up","flip-rtl","",1,"expandable-status-icon"]],template:function CoreReportBuilderReportColumnComponent_Template(e,t){1&e&&(a.j41(0,"ion-item",1),a.nI1(1,"translate"),a.bIt("click",(function CoreReportBuilderReportColumnComponent_Template_ion_item_click_0_listener(){return t.toggleRow()})),a.j41(2,"ion-label"),a.DNE(3,CoreReportBuilderReportColumnComponent_p_3_Template,2,1,"p",2)(4,CoreReportBuilderReportColumnComponent_h2_4_Template,4,2,"h2",3)(5,CoreReportBuilderReportColumnComponent_ng_container_5_Template,4,2,"ng-container",3),a.k0s(),a.DNE(6,CoreReportBuilderReportColumnComponent_ion_icon_6_Template,1,2,"ion-icon",4),a.k0s()),2&e&&(a.Y8G("detail",!1)("button",t.isExpandable),a.BMQ("aria-expanded",t.isExpanded)("aria-controls","core-report-builder-column-"+t.rowIndex)("aria-label",a.bMT(1,9,t.isExpanded?"core.hidecolumns":"core.showcolumns")),a.R7$(3),a.Y8G("ngIf",0!==t.columnIndex||0===t.columnIndex&&t.showFirstTitle),a.R7$(),a.Y8G("ngIf",0===t.columnIndex),a.R7$(),a.Y8G("ngIf",0!==t.columnIndex),a.R7$(),a.Y8G("ngIf",t.isExpandable))},dependencies:[p.bT,s.t,_.B,c.iq,c.uz,c.he,d.D9],styles:["[_nghost-%COMP%]{--rotate-expandable: rotate(180deg)}[_nghost-%COMP%]   .expandable-status-icon[_ngcontent-%COMP%]{font-size:var(--text-size);margin-inline-start:0;margin-inline-end:2px;transition:transform .2s ease-in-out}"]}),CoreReportBuilderReportColumnComponent})();var g=o(10467),m=o(75629),R=o(22693),f=o(15324),C=o(93417),h=o(52749),I=o(89911),b=o(86552),x=o(79555),T=o(24742),B=o(84412),w=o(96354),v=o(55554),E=o(16986),G=o(66198),y=o(64422);function CoreReportBuilderReportDetailComponent_ng_container_0_ng_container_5_ng_container_1_ion_card_1_core_report_builder_report_column_2_Template(e,t){if(1&e){const e=a.RV6();a.j41(0,"core-report-builder-report-column",12),a.nI1(1,"async"),a.bIt("onToggleRow",(function CoreReportBuilderReportDetailComponent_ng_container_0_ng_container_5_ng_container_1_ion_card_1_core_report_builder_report_column_2_Template_core_report_builder_report_column_onToggleRow_0_listener(){a.eBV(e);const t=a.XpG().index,o=a.XpG(4);return a.Njj(o.toggleRow(t))})),a.k0s()}if(2&e){const e=t.$implicit,o=t.index,r=a.XpG(),n=r.$implicit,i=r.index,l=a.XpG(3).ngIf,p=a.XpG();a.Y8G("columnIndex",o)("rowIndex",i)("isExpandable",0===o&&n.columns.length>l.cardVisibleColumns)("isExpanded",n.isExpanded)("showFirstTitle",l.cardviewShowFirstTitle)("source",a.bMT(1,9,p.source$))("contextId",l.report.details.contextid)("header",l.report.data.headers[o])("column",e)}}function CoreReportBuilderReportDetailComponent_ng_container_0_ng_container_5_ng_container_1_ion_card_1_Template(e,t){if(1&e&&(a.j41(0,"ion-card")(1,"ion-list",10),a.DNE(2,CoreReportBuilderReportDetailComponent_ng_container_0_ng_container_5_ng_container_1_ion_card_1_core_report_builder_report_column_2_Template,2,11,"core-report-builder-report-column",11),a.nI1(3,"slice"),a.k0s()()),2&e){const e=t.$implicit,o=a.XpG(3).ngIf;a.R7$(2),a.Y8G("ngForOf",a.brH(3,1,e.columns,0,e.isExpanded?e.columns.length:o.cardVisibleColumns))}}function CoreReportBuilderReportDetailComponent_ng_container_0_ng_container_5_ng_container_1_Template(e,t){if(1&e&&(a.qex(0),a.DNE(1,CoreReportBuilderReportDetailComponent_ng_container_0_ng_container_5_ng_container_1_ion_card_1_Template,4,5,"ion-card",9),a.bVm()),2&e){const e=a.XpG(2).ngIf;a.R7$(),a.Y8G("ngForOf",e.report.data.rows)}}function CoreReportBuilderReportDetailComponent_ng_container_0_ng_container_5_div_2_th_4_Template(e,t){if(1&e&&(a.j41(0,"th"),a.EFF(1),a.k0s()),2&e){const e=t.$implicit;a.R7$(),a.SpI(" ",e," ")}}function CoreReportBuilderReportDetailComponent_ng_container_0_ng_container_5_div_2_tr_6_td_1_core_format_text_1_Template(e,t){if(1&e&&(a.nrm(0,"core-format-text",17),a.nI1(1,"async")),2&e){const e=a.XpG().$implicit,t=a.XpG(4).ngIf,o=a.XpG();a.Y8G("text",e)("contextLevel",a.bMT(1,3,o.source$))("contextInstanceId",t.report.details.contextid)}}function CoreReportBuilderReportDetailComponent_ng_container_0_ng_container_5_div_2_tr_6_td_1_ng_template_2_Template(e,t){if(1&e&&a.EFF(0),2&e){const e=a.XpG().$implicit;a.SpI(" ",e," ")}}function CoreReportBuilderReportDetailComponent_ng_container_0_ng_container_5_div_2_tr_6_td_1_Template(e,t){if(1&e&&(a.j41(0,"td"),a.DNE(1,CoreReportBuilderReportDetailComponent_ng_container_0_ng_container_5_div_2_tr_6_td_1_core_format_text_1_Template,2,5,"core-format-text",16)(2,CoreReportBuilderReportDetailComponent_ng_container_0_ng_container_5_div_2_tr_6_td_1_ng_template_2_Template,1,1,"ng-template",null,1,a.C5r),a.k0s()),2&e){const e=t.$implicit,o=a.sdS(3),r=a.XpG(5);a.R7$(),a.Y8G("ngIf",r.isString(e))("ngIfElse",o)}}function CoreReportBuilderReportDetailComponent_ng_container_0_ng_container_5_div_2_tr_6_Template(e,t){if(1&e&&(a.j41(0,"tr"),a.DNE(1,CoreReportBuilderReportDetailComponent_ng_container_0_ng_container_5_div_2_tr_6_td_1_Template,4,2,"td",9),a.k0s()),2&e){const e=t.$implicit;a.R7$(),a.Y8G("ngForOf",e.columns)}}function CoreReportBuilderReportDetailComponent_ng_container_0_ng_container_5_div_2_Template(e,t){if(1&e&&(a.j41(0,"div",13)(1,"table",14)(2,"thead")(3,"tr"),a.DNE(4,CoreReportBuilderReportDetailComponent_ng_container_0_ng_container_5_div_2_th_4_Template,2,1,"th",9),a.k0s()(),a.j41(5,"tbody",15),a.DNE(6,CoreReportBuilderReportDetailComponent_ng_container_0_ng_container_5_div_2_tr_6_Template,2,1,"tr",9),a.k0s()()()),2&e){const e=a.XpG(2).ngIf;a.R7$(4),a.Y8G("ngForOf",e.report.data.headers),a.R7$(2),a.Y8G("ngForOf",e.report.data.rows)}}function CoreReportBuilderReportDetailComponent_ng_container_0_ng_container_5_Template(e,t){if(1&e&&(a.qex(0),a.DNE(1,CoreReportBuilderReportDetailComponent_ng_container_0_ng_container_5_ng_container_1_Template,2,1,"ng-container",2)(2,CoreReportBuilderReportDetailComponent_ng_container_0_ng_container_5_div_2_Template,7,2,"div",8),a.bVm()),2&e){const e=a.XpG(2);a.R7$(),a.Y8G("ngIf",e.isCardLayout),a.R7$(),a.Y8G("ngIf",!e.isCardLayout)}}function CoreReportBuilderReportDetailComponent_ng_container_0_ng_template_6_Template(e,t){1&e&&(a.j41(0,"core-empty-box",18)(1,"p"),a.EFF(2),a.nI1(3,"translate"),a.k0s()()),2&e&&(a.R7$(2),a.SpI(" ",a.bMT(3,1,"core.course.nocontentavailable")," "))}function CoreReportBuilderReportDetailComponent_ng_container_0_core_infinite_loading_8_Template(e,t){if(1&e){const e=a.RV6();a.j41(0,"core-infinite-loading",19),a.bIt("action",(function CoreReportBuilderReportDetailComponent_ng_container_0_core_infinite_loading_8_Template_core_infinite_loading_action_0_listener(t){a.eBV(e);const o=a.XpG(2);return a.Njj(o.fetchMoreInfo(t))})),a.k0s()}if(2&e){const e=a.XpG().ngIf;a.Y8G("enabled",e.canLoadMoreRows)("error",e.errorLoadingRows)}}function CoreReportBuilderReportDetailComponent_ng_container_0_Template(e,t){if(1&e){const e=a.RV6();a.qex(0),a.j41(1,"core-loading",3)(2,"ion-refresher",4),a.bIt("ionRefresh",(function CoreReportBuilderReportDetailComponent_ng_container_0_Template_ion_refresher_ionRefresh_2_listener(t){a.eBV(e);const o=a.XpG();return a.Njj(o.refreshReport(t.target))})),a.nrm(3,"ion-refresher-content",5),a.nI1(4,"translate"),a.k0s(),a.DNE(5,CoreReportBuilderReportDetailComponent_ng_container_0_ng_container_5_Template,3,2,"ng-container",6)(6,CoreReportBuilderReportDetailComponent_ng_container_0_ng_template_6_Template,4,3,"ng-template",null,0,a.C5r)(8,CoreReportBuilderReportDetailComponent_ng_container_0_core_infinite_loading_8_Template,1,2,"core-infinite-loading",7),a.k0s(),a.bVm()}if(2&e){const e=t.ngIf,o=a.sdS(7),r=a.XpG();a.R7$(),a.Y8G("hideUntil",e.loaded),a.R7$(),a.Y8G("disabled",!e.loaded),a.R7$(),a.FS9("pullingText",a.bMT(4,6,"core.pulltorefresh")),a.R7$(2),a.Y8G("ngIf",(null==e.report||null==e.report.data||null==e.report.data.rows?null:e.report.data.rows.length)&&(null==e.report||null==e.report.data?null:e.report.data.headers)&&(null==e.report?null:e.report.details))("ngIfElse",o),a.R7$(3),a.Y8G("ngIf",!r.isBlock&&(null==e.report||null==e.report.data||null==e.report.data.rows?null:e.report.data.rows.length)&&(null==e.report||null==e.report.data?null:e.report.data.headers)&&(null==e.report?null:e.report.details))}}let D=(()=>{var e;class CoreReportBuilderReportDetailComponent{get isCardLayout(){return"card"===this.layout||C.CoreScreen.isMobile&&"adaptative"===this.layout}constructor(){var e=this;this.isBlock=!0,this.layout="adaptative",this.onReportLoaded=new a.bkB,this.state$=new B.t({report:null,loaded:!1,canLoadMoreRows:!1,errorLoadingRows:!1,cardviewShowFirstTitle:!1,cardVisibleColumns:1,page:0}),this.isString=e=>l.Zn.isString(e),this.source$=this.state$.pipe((0,w.T)((e=>{var t;const o=null===(t=e.report)||void 0===t?void 0:t.details.source.split("\\"),r=null==o?void 0:o[(null==o?void 0:o.length)-1];return null!=r?r:"system"}))),this.logView=T.j.once(function(){var t=(0,g.A)((function*(t){yield v.g.ignoreErrors(l.Zn.viewReport(e.reportId)),R.OF.logEvent({type:R.qr.VIEW_ITEM,ws:"core_reportbuilder_view_report",name:t.details.name,data:{id:e.reportId,category:"reportbuilder"},url:`/reportbuilder/view.php?id=${e.reportId}`})}));return function(e){return t.apply(this,arguments)}}())}ngOnInit(){var e=this;return(0,g.A)((function*(){yield e.getReport(),e.updateState({loaded:!0})}))()}getReport(){var e=this;return(0,g.A)((function*(){try{var t;if(!e.reportId)return I.CoreDomUtils.showErrorModal(new m.CoreError("No report found")),f.CoreNavigator.back(),void 0;const{page:o}=e.state$.getValue(),r=yield l.Zn.loadReport(parseInt(e.reportId),o,null!==(t=e.perPage)&&void 0!==t?t:l.RW);if(!r)return I.CoreDomUtils.showErrorModal(new m.CoreError("No report found")),f.CoreNavigator.back(),void 0;e.updateState({report:r,cardVisibleColumns:r.details.settingsdata.cardviewVisibleColumns,cardviewShowFirstTitle:r.details.settingsdata.cardviewShowFirstTitle,canLoadMoreRows:r.data.totalrowcount>r.data.rows.length}),e.logView(r),e.onReportLoaded.emit(r.details)}catch{const t={title:x.HT.instant("core.error"),body:`\n                    <p>${x.HT.instant("addon.mod_page.errorwhileloadingthepage")}</p>\n                    <p>${x.HT.instant("core.course.useactivityonbrowser")}</p>\n                `,buttons:[{text:x.HT.instant("core.cancel"),role:"cancel",handler:(r=(0,g.A)((function*(){return yield f.CoreNavigator.back()})),function handler(){return r.apply(this,arguments)})},{text:x.HT.instant("core.openinbrowser"),role:"confirm",handler:(o=(0,g.A)((function*(){const t=`${h.CoreSites.getRequiredCurrentSite().getURL()}/reportbuilder/view.php?id=${e.reportId}`;yield b.j.openInBrowser(t,{showBrowserWarning:!1}),yield f.CoreNavigator.back()})),function handler(){return o.apply(this,arguments)})}]};yield I.CoreDomUtils.showErrorModal(t)}var o,r}))()}updateState(e){const t=this.state$.getValue();this.state$.next({...t,...e})}refreshReport(e){var t=this;return(0,g.A)((function*(){yield v.g.ignoreErrors(l.Zn.invalidateReport()),t.updateState({page:0,canLoadMoreRows:!1}),yield v.g.ignoreErrors(t.getReport()),yield null==e?void 0:e.complete()}))()}incrementPage(){const{page:e}=this.state$.getValue();this.updateState({page:e+1})}fetchMoreInfo(e){var t=this;return(0,g.A)((function*(){const{canLoadMoreRows:o,report:r}=t.state$.getValue();if(!o)return e(),void 0;try{t.incrementPage();const{page:o}=t.state$.getValue(),n=yield l.Zn.loadReport(parseInt(t.reportId),o,l.RW);if(!r||!n||0===n.data.rows.length)return t.updateState({canLoadMoreRows:!1}),e(),void 0;t.updateState({report:{...r,data:{...r.data,rows:[...r.data.rows,...n.data.rows]}},canLoadMoreRows:n.data.totalrowcount>r.data.rows.length+n.data.rows.length})}catch(e){I.CoreDomUtils.showErrorModalDefault(e,"Error loading more reports"),t.updateState({canLoadMoreRows:!1,errorLoadingRows:!0})}e()}))()}toggleRow(e){var t;const{report:o}=this.state$.getValue();null!=o&&null!==(t=o.data)&&void 0!==t&&t.rows[e]&&(o.data.rows[e].isExpanded=!o.data.rows[e].isExpanded,this.updateState({report:o}))}}return(e=CoreReportBuilderReportDetailComponent).ɵfac=function CoreReportBuilderReportDetailComponent_Factory(t){return new(t||e)},e.ɵcmp=a.VBU({type:e,selectors:[["core-report-builder-report-detail"]],inputs:{reportId:"reportId",isBlock:[a.Mj6.HasDecoratorInputTransform,"isBlock","isBlock",i.G],perPage:"perPage",layout:"layout"},outputs:{onReportLoaded:"onReportLoaded"},features:[a.GFd],decls:2,vars:3,consts:[["empty",""],["notText",""],[4,"ngIf"],[3,"hideUntil"],["slot","fixed",3,"ionRefresh","disabled"],[3,"pullingText"],[4,"ngIf","ngIfElse"],[3,"enabled","error","action",4,"ngIf"],["class","x-scrollable",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"ion-text-wrap"],[3,"columnIndex","rowIndex","isExpandable","isExpanded","showFirstTitle","source","contextId","header","column","onToggleRow",4,"ngFor","ngForOf"],[3,"onToggleRow","columnIndex","rowIndex","isExpandable","isExpanded","showFirstTitle","source","contextId","header","column"],[1,"x-scrollable"],[1,"core-table"],[1,"auto-striped"],[3,"text","contextLevel","contextInstanceId",4,"ngIf","ngIfElse"],[3,"text","contextLevel","contextInstanceId"],["icon","fas-rectangle-list"],[3,"action","enabled","error"]],template:function CoreReportBuilderReportDetailComponent_Template(e,t){1&e&&(a.DNE(0,CoreReportBuilderReportDetailComponent_ng_container_0_Template,9,8,"ng-container",2),a.nI1(1,"async")),2&e&&a.Y8G("ngIf",a.bMT(1,1,t.state$))},dependencies:[p.Sq,p.bT,E.h,G.b,y.R,_.B,c.b_,c.nf,c.To,c.Ki,u,p.Jj,p.P9,d.D9],styles:["[_nghost-%COMP%]   .report-title[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], [_nghost-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{min-width:200px}[_nghost-%COMP%]   core-empty-box[_ngcontent-%COMP%]{color:var(--gray-500)}[_nghost-%COMP%]   core-empty-box[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--gray-900)}"]}),CoreReportBuilderReportDetailComponent})(),M=(()=>{var e;class CoreReportBuilderComponentsModule{}return(e=CoreReportBuilderComponentsModule).ɵfac=function CoreReportBuilderComponentsModule_Factory(t){return new(t||e)},e.ɵmod=a.$C({type:e}),e.ɵinj=a.G2t({imports:[r.n]}),CoreReportBuilderComponentsModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&a.Obh(M,{declarations:[D,u],imports:[r.n],exports:[D,u]}));var $=o(2401),L=o(83696),k=o(99522);class CoreReportBuilderReportsSource extends k.F{getItemPath(e){return e.id.toString()}loadPageItems(e){var t=this;return(0,g.A)((function*(){const o=yield l.Zn.getReports(e,t.getPageLength());return{items:o,hasMoreItems:o.length>0}}))()}setItems(e,t){const o=e.slice(0);o.sort(((e,t)=>e.timemodified<t.timemodified?1:-1)),super.setItems(o,t)}getPageLength(){return l.Pd}}var P=o(88246);function CoreReportBuilderListPage_ion_content_9_ion_list_5_ion_item_1_Template(e,t){if(1&e){const e=a.RV6();a.j41(0,"ion-item",10),a.bIt("click",(function CoreReportBuilderListPage_ion_content_9_ion_list_5_ion_item_1_Template_ion_item_click_0_listener(){const t=a.eBV(e).$implicit,o=a.XpG(3);return a.Njj(o.reports.select(t))})),a.j41(1,"ion-label")(2,"p",11),a.nrm(3,"core-format-text",12),a.k0s(),a.j41(4,"p"),a.EFF(5),a.k0s()()()}if(2&e){const e=t.$implicit,o=a.XpG(3);a.Y8G("detail",!0)("button",!0),a.BMQ("aria-current",o.reports.getItemAriaCurrent(e)),a.R7$(3),a.Y8G("clean",!0)("text",e.name)("filter",!1),a.R7$(2),a.JRh(e.sourcename)}}function CoreReportBuilderListPage_ion_content_9_ion_list_5_Template(e,t){if(1&e&&(a.j41(0,"ion-list"),a.DNE(1,CoreReportBuilderListPage_ion_content_9_ion_list_5_ion_item_1_Template,6,7,"ion-item",9),a.k0s()),2&e){const e=a.XpG(2);a.R7$(),a.Y8G("ngForOf",e.reports.items)}}function CoreReportBuilderListPage_ion_content_9_ng_template_6_core_empty_box_0_Template(e,t){1&e&&(a.nrm(0,"core-empty-box",14),a.nI1(1,"translate")),2&e&&a.Y8G("message",a.bMT(1,1,"core.course.nocontentavailable"))}function CoreReportBuilderListPage_ion_content_9_ng_template_6_Template(e,t){if(1&e&&a.DNE(0,CoreReportBuilderListPage_ion_content_9_ng_template_6_core_empty_box_0_Template,2,3,"core-empty-box",13),2&e){const e=a.XpG(2);a.Y8G("ngIf",!(null!=e.reports.items&&e.reports.items.length))}}function CoreReportBuilderListPage_ion_content_9_core_infinite_loading_8_Template(e,t){if(1&e){const e=a.RV6();a.j41(0,"core-infinite-loading",15),a.bIt("action",(function CoreReportBuilderListPage_ion_content_9_core_infinite_loading_8_Template_core_infinite_loading_action_0_listener(t){a.eBV(e);const o=a.XpG(2);return a.Njj(o.fetchMoreReports(t))})),a.k0s()}if(2&e){const e=a.XpG().ngIf,t=a.XpG();a.Y8G("enabled",t.reports.loaded&&!t.reports.completed)("error",e.loadMoreError)}}function CoreReportBuilderListPage_ion_content_9_Template(e,t){if(1&e){const e=a.RV6();a.j41(0,"ion-content")(1,"ion-refresher",4),a.bIt("ionRefresh",(function CoreReportBuilderListPage_ion_content_9_Template_ion_refresher_ionRefresh_1_listener(t){a.eBV(e);const o=a.XpG();return a.Njj(o.refreshReports(t.target))})),a.nrm(2,"ion-refresher-content",5),a.nI1(3,"translate"),a.k0s(),a.j41(4,"core-loading",6),a.DNE(5,CoreReportBuilderListPage_ion_content_9_ion_list_5_Template,2,1,"ion-list",7)(6,CoreReportBuilderListPage_ion_content_9_ng_template_6_Template,1,1,"ng-template",null,0,a.C5r)(8,CoreReportBuilderListPage_ion_content_9_core_infinite_loading_8_Template,1,2,"core-infinite-loading",8),a.k0s()()}if(2&e){const e=t.ngIf,o=a.sdS(7),r=a.XpG();a.R7$(),a.Y8G("disabled",!e.loaded),a.R7$(),a.FS9("pullingText",a.bMT(3,6,"core.pulltorefresh")),a.R7$(2),a.Y8G("hideUntil",e.loaded),a.R7$(),a.Y8G("ngIf",null==r.reports.items?null:r.reports.items.length)("ngIfElse",o),a.R7$(3),a.Y8G("ngIf",null==r.reports.items?null:r.reports.items.length)}}let F=(()=>{var e;class CoreReportBuilderListPage{constructor(){this.state$=new B.t({page:1,perpage:l.Pd,loaded:!1,loadMoreError:!1}),this.logView=T.j.once((()=>this.performLogView()));try{const e=L.u.getOrCreateSource(CoreReportBuilderReportsSource,[]);this.reports=new $.R(e,CoreReportBuilderListPage)}catch(e){I.CoreDomUtils.showErrorModal(e),f.CoreNavigator.back()}}ngAfterViewInit(){var e=this;return(0,g.A)((function*(){try{yield e.fetchReports(!0),e.updateState({loaded:!0})}catch(t){I.CoreDomUtils.showErrorModalDefault(t,"Error loading reports"),e.reports.reset()}}))()}fetchReports(e){var t=this;return(0,g.A)((function*(){e?yield t.reports.reload():yield t.reports.load(),t.updateState({loadMoreError:!1}),t.logView()}))()}updateState(e){const t=this.state$.getValue();this.state$.next({...t,...e})}fetchMoreReports(e){var t=this;return(0,g.A)((function*(){try{yield t.fetchReports(!1)}catch(e){I.CoreDomUtils.showErrorModalDefault(e,"Error loading more reports"),t.updateState({loadMoreError:!0})}e()}))()}refreshReports(e){var t=this;return(0,g.A)((function*(){yield v.g.ignoreErrors(l.Zn.invalidateReportsList()),yield v.g.ignoreErrors(t.fetchReports(!0)),yield null==e?void 0:e.complete()}))()}performLogView(){R.OF.logEvent({type:R.qr.VIEW_ITEM_LIST,ws:"core_reportbuilder_list_reports",name:x.HT.instant("core.reportbuilder.reports"),data:{category:"reportbuilder"},url:"/reportbuilder/index.php"})}ngOnDestroy(){this.reports.destroy()}}return(e=CoreReportBuilderListPage).ɵfac=function CoreReportBuilderListPage_Factory(t){return new(t||e)},e.ɵcmp=a.VBU({type:e,selectors:[["core-report-builder-list"]],decls:11,vars:9,consts:[["empty",""],["slot","start"],[3,"text"],[4,"ngIf"],["slot","fixed",3,"ionRefresh","disabled"],[3,"pullingText"],[3,"hideUntil"],[4,"ngIf","ngIfElse"],[3,"enabled","error","action",4,"ngIf"],["class","ion-text-wrap",3,"detail","button","click",4,"ngFor","ngForOf"],[1,"ion-text-wrap",3,"click","detail","button"],[1,"item-heading"],[3,"clean","text","filter"],["icon","fas-rectangle-list",3,"message",4,"ngIf"],["icon","fas-rectangle-list",3,"message"],[3,"action","enabled","error"]],template:function CoreReportBuilderListPage_Template(e,t){1&e&&(a.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",1),a.nrm(3,"ion-back-button",2),a.nI1(4,"translate"),a.k0s(),a.j41(5,"ion-title")(6,"h1"),a.EFF(7),a.nI1(8,"translate"),a.k0s()()()(),a.DNE(9,CoreReportBuilderListPage_ion_content_9_Template,9,8,"ion-content",3),a.nI1(10,"async")),2&e&&(a.R7$(3),a.Y8G("text",a.bMT(4,3,"core.back")),a.R7$(4),a.JRh(a.bMT(8,5,"core.reportbuilder.reports")),a.R7$(2),a.Y8G("ngIf",a.bMT(10,7,t.state$)))},dependencies:[p.Sq,p.bT,E.h,G.b,y.R,_.B,P.i,c.QW,c.W9,c.eU,c.uz,c.he,c.nf,c.To,c.Ki,c.BC,c.ai,c.el,p.Jj,d.D9],encapsulation:2,changeDetection:0}),CoreReportBuilderListPage})();var j=o(6319),S=o(43570);function CoreReportBuilderReportPage_ion_title_9_Template(e,t){if(1&e&&(a.j41(0,"ion-title")(1,"h1"),a.nrm(2,"core-format-text",7),a.k0s(),a.j41(3,"p",8),a.EFF(4),a.k0s()()),2&e){const e=a.XpG();a.R7$(2),a.Y8G("clean",!0)("text",e.reportDetail.name)("filter",!1),a.R7$(2),a.SpI(" ",e.reportDetail.sourcename," ")}}let V=(()=>{var e;class CoreReportBuilderReportPage{ngOnInit(){this.reportId=f.CoreNavigator.getRequiredRouteParam("id")}loadReportDetail(e){this.reportDetail=e}openInfo(){var e=this;return(0,g.A)((function*(){const{CoreReportBuilderReportSummaryComponent:t}=yield o.e(8818).then(o.bind(o,98818));j.I.openSideModal({component:t,componentProps:{reportDetail:e.reportDetail}})}))()}}return(e=CoreReportBuilderReportPage).ɵfac=function CoreReportBuilderReportPage_Factory(t){return new(t||e)},e.ɵcmp=a.VBU({type:e,selectors:[["core-report-builder-report"]],decls:12,vars:9,consts:[["slot","start"],[3,"text"],["slot","end"],["fill","clear",3,"click","ariaLabel"],["slot","icon-only","name","fas-circle-info","aria-hidden","true"],[4,"ngIf"],[3,"onReportLoaded","isBlock","reportId"],[3,"clean","text","filter"],[1,"subheading"]],template:function CoreReportBuilderReportPage_Template(e,t){1&e&&(a.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),a.nrm(3,"ion-back-button",1),a.nI1(4,"translate"),a.k0s(),a.j41(5,"ion-buttons",2)(6,"ion-button",3),a.nI1(7,"translate"),a.bIt("click",(function CoreReportBuilderReportPage_Template_ion_button_click_6_listener(){return t.openInfo()})),a.nrm(8,"ion-icon",4),a.k0s()(),a.DNE(9,CoreReportBuilderReportPage_ion_title_9_Template,5,4,"ion-title",5),a.k0s()(),a.j41(10,"ion-content")(11,"core-report-builder-report-detail",6),a.bIt("onReportLoaded",(function CoreReportBuilderReportPage_Template_core_report_builder_report_detail_onReportLoaded_11_listener(e){return t.loadReportDetail(e)})),a.k0s()()),2&e&&(a.R7$(3),a.Y8G("text",a.bMT(4,5,"core.back")),a.R7$(3),a.Y8G("ariaLabel",a.bMT(7,7,"core.close")),a.R7$(3),a.Y8G("ngIf",t.reportDetail),a.R7$(2),a.Y8G("isBlock",!1)("reportId",t.reportId))},dependencies:[p.bT,s.t,_.B,P.i,S.T,c.Jm,c.QW,c.W9,c.eU,c.iq,c.BC,c.ai,c.el,D,d.D9],encapsulation:2}),CoreReportBuilderReportPage})();const Y=[{path:"",component:F},{path:":id",component:V}];let X=(()=>{var e;class CoreReportBuilderLazyModule{}return(e=CoreReportBuilderLazyModule).ɵfac=function CoreReportBuilderLazyModule_Factory(t){return new(t||e)},e.ɵmod=a.$C({type:e}),e.ɵinj=a.G2t({imports:[r.n,M,n.iI.forChild(Y)]}),CoreReportBuilderLazyModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&a.Obh(X,{declarations:[F,V],imports:[r.n,M,n.iI]}))}}]);