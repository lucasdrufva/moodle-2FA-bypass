"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4368],{84368:(e,o,s)=>{s.r(o),s.d(o,{default:()=>M});var a=s(21182),r=s(3353),n=s(78463),t=s(10467),i=s(66110),l=s(49882),c=s(52749),d=s(50572),u=s(89911),b=s(44666),h=s(15324),C=s(63114),_=s(24742),g=s(22693),p=s(79555),f=s(55554),m=s(54438),k=s(60177),D=s(16986),I=s(64422),y=s(13988),v=s(86198),T=s(88246),B=s(43570),S=s(73465),w=s(42922),P=s(73955);function CoreCoursesDashboardPage_ion_button_1_Template(e,o){if(1&e){const e=m.RV6();m.j41(0,"ion-button",8),m.nI1(1,"translate"),m.bIt("click",(function CoreCoursesDashboardPage_ion_button_1_Template_ion_button_click_0_listener(){m.eBV(e);const o=m.XpG();return m.Njj(o.openSearch())})),m.nrm(2,"ion-icon",9),m.k0s()}2&e&&m.Y8G("ariaLabel",m.bMT(1,1,"core.courses.searchcourses"))}function CoreCoursesDashboardPage_ion_list_7_ng_container_1_core_block_1_Template(e,o){if(1&e&&m.nrm(0,"core-block",13),2&e){const e=m.XpG().$implicit,o=m.XpG(2);m.Y8G("block",e)("instanceId",o.userId)}}function CoreCoursesDashboardPage_ion_list_7_ng_container_1_Template(e,o){if(1&e&&(m.qex(0),m.DNE(1,CoreCoursesDashboardPage_ion_list_7_ng_container_1_core_block_1_Template,1,2,"core-block",12),m.bVm()),2&e){const e=o.$implicit;m.R7$(),m.Y8G("ngIf",e.visible)}}function CoreCoursesDashboardPage_ion_list_7_Template(e,o){if(1&e&&(m.j41(0,"ion-list",10),m.DNE(1,CoreCoursesDashboardPage_ion_list_7_ng_container_1_Template,2,1,"ng-container",11),m.k0s()),2&e){const e=m.XpG();m.R7$(),m.Y8G("ngForOf",e.blocks)}}function CoreCoursesDashboardPage_core_block_side_blocks_button_8_Template(e,o){if(1&e&&m.nrm(0,"core-block-side-blocks-button",14),2&e){const e=m.XpG();m.Y8G("instanceId",e.userId)}}function CoreCoursesDashboardPage_core_empty_box_9_Template(e,o){1&e&&(m.nrm(0,"core-empty-box",15),m.nI1(1,"translate")),2&e&&m.Y8G("message",m.bMT(1,1,"core.course.nocontentavailable"))}let E=(()=>{var e;class CoreCoursesDashboardPage{constructor(){this.hasMainBlocks=!1,this.hasSideBlocks=!1,this.searchEnabled=!1,this.downloadCourseEnabled=!1,this.downloadCoursesEnabled=!1,this.blocks=[],this.loaded=!1,this.updateSiteObserver=l.z.on(l.z.SITE_UPDATED,(()=>{this.searchEnabled=!i.CoreCourses.isSearchCoursesDisabledInSite(),this.downloadCourseEnabled=!i.CoreCourses.isDownloadCourseDisabledInSite(),this.downloadCoursesEnabled=!i.CoreCourses.isDownloadCoursesDisabledInSite()}),c.CoreSites.getCurrentSiteId()),this.logView=_.j.once((0,t.A)((function*(){yield f.g.ignoreErrors(i.CoreCourses.logView("dashboard")),g.OF.logEvent({type:g.qr.VIEW_ITEM,ws:"core_my_view_page",name:p.HT.instant("core.courses.mymoodle"),data:{category:"course",page:"dashboard"},url:"/my/"})})))}ngOnInit(){this.searchEnabled=!i.CoreCourses.isSearchCoursesDisabledInSite(),this.downloadCourseEnabled=!i.CoreCourses.isDownloadCourseDisabledInSite(),this.downloadCoursesEnabled=!i.CoreCourses.isDownloadCoursesDisabledInSite(),this.loadContent()}loadContent(){var e=this;return(0,t.A)((function*(){const o=yield d.CoreCoursesDashboard.isAvailable(),s=yield d.CoreCoursesDashboard.isDisabled();if(o&&!s){e.userId=c.CoreSites.getCurrentSiteUserId();try{const o=yield d.CoreCoursesDashboard.getDashboardBlocks();e.blocks=o.mainBlocks,e.hasMainBlocks=C.CoreBlockDelegate.hasSupportedBlock(o.mainBlocks),e.hasSideBlocks=C.CoreBlockDelegate.hasSupportedBlock(o.sideBlocks)}catch(o){u.CoreDomUtils.showErrorModal(o),e.loadFallbackBlocks()}}else o?e.blocks=[]:e.loadFallbackBlocks();e.loaded=!0,e.logView()}))()}loadFallbackBlocks(){this.blocks=[{name:"myoverview",visible:!0},{name:"timeline",visible:!0}],this.hasMainBlocks=C.CoreBlockDelegate.isBlockSupported("myoverview")||C.CoreBlockDelegate.isBlockSupported("timeline")}refreshDashboard(e){var o;const s=[];s.push(d.CoreCoursesDashboard.invalidateDashboardBlocks()),null===(o=this.blocksComponents)||void 0===o||o.forEach((e=>{s.push(e.invalidate().catch((()=>{})))})),Promise.all(s).finally((()=>{this.loadContent().finally((()=>{null==e||e.complete()}))}))}openSearch(){return(0,t.A)((function*(){h.CoreNavigator.navigateToSitePath("/courses/list",{params:{mode:"search"}})}))()}ngOnDestroy(){this.updateSiteObserver.off()}}return(e=CoreCoursesDashboardPage).ɵfac=function CoreCoursesDashboardPage_Factory(o){return new(o||e)},e.ɵcmp=m.VBU({type:e,selectors:[["page-core-courses-dashboard"]],viewQuery:function CoreCoursesDashboardPage_Query(e,o){if(1&e&&m.GBs(b.A,5),2&e){let e;m.mGM(e=m.lsd())&&(o.blocksComponents=e)}},decls:10,vars:9,consts:[["slot","end","prepend",""],[3,"ariaLabel","click",4,"ngIf"],["slot","fixed",3,"ionRefresh","disabled"],[3,"pullingText"],[3,"hideUntil"],["class","list-item-limited-width",4,"ngIf"],["slot","fixed","contextLevel","user",3,"instanceId",4,"ngIf"],["icon","fas-cubes",3,"message",4,"ngIf"],[3,"click","ariaLabel"],["name","fas-magnifying-glass","slot","icon-only","aria-hidden","true"],[1,"list-item-limited-width"],[4,"ngFor","ngForOf"],["contextLevel","user",3,"block","instanceId",4,"ngIf"],["contextLevel","user",3,"block","instanceId"],["slot","fixed","contextLevel","user",3,"instanceId"],["icon","fas-cubes",3,"message"]],template:function CoreCoursesDashboardPage_Template(e,o){1&e&&(m.j41(0,"core-navbar-buttons",0),m.DNE(1,CoreCoursesDashboardPage_ion_button_1_Template,3,3,"ion-button",1),m.k0s(),m.j41(2,"ion-content")(3,"ion-refresher",2),m.bIt("ionRefresh",(function CoreCoursesDashboardPage_Template_ion_refresher_ionRefresh_3_listener(e){return o.refreshDashboard(e.target)})),m.nrm(4,"ion-refresher-content",3),m.nI1(5,"translate"),m.k0s(),m.j41(6,"core-loading",4),m.DNE(7,CoreCoursesDashboardPage_ion_list_7_Template,2,1,"ion-list",5)(8,CoreCoursesDashboardPage_core_block_side_blocks_button_8_Template,1,1,"core-block-side-blocks-button",6)(9,CoreCoursesDashboardPage_core_empty_box_9_Template,2,3,"core-empty-box",7),m.k0s()()),2&e&&(m.R7$(),m.Y8G("ngIf",o.searchEnabled),m.R7$(2),m.Y8G("disabled",!o.loaded),m.R7$(),m.FS9("pullingText",m.bMT(5,7,"core.pulltorefresh")),m.R7$(2),m.Y8G("hideUntil",o.loaded),m.R7$(),m.Y8G("ngIf",o.hasMainBlocks),m.R7$(),m.Y8G("ngIf",o.hasSideBlocks),m.R7$(),m.Y8G("ngIf",!o.hasMainBlocks))},dependencies:[k.Sq,k.bT,D.h,I.R,y.c,v.t,T.i,B.T,S.Jm,S.W9,S.iq,S.nf,S.To,S.Ki,b.A,w.n,P.D9],encapsulation:2}),CoreCoursesDashboardPage})();const G=[{path:"",component:E}];let M=(()=>{var e;class CoreCoursesDashboardLazyModule{}return(e=CoreCoursesDashboardLazyModule).ɵfac=function CoreCoursesDashboardLazyModule_Factory(o){return new(o||e)},e.ɵmod=m.$C({type:e}),e.ɵinj=m.G2t({imports:[a.iI.forChild(G),r.n,n.R]}),CoreCoursesDashboardLazyModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&m.Obh(M,{declarations:[E],imports:[a.iI,r.n,n.R]}))}}]);