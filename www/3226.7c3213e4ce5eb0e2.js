"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3226],{43226:(e,n,o)=>{o.r(n),o.d(n,{AddonModResourceIndexComponent:()=>N});var t=o(10467),i=o(74431),d=o(75629),r=o(23063),a=o(44682),s=o(8979),c=o(94455),l=o(88436),_=o(52749),m=o(89911),u=o(37775),p=o(75383),f=o(79555),g=o(85105),I=o(34890),R=o(18022),x=o(37057),C=o(55554),M=o(86552),T=o(54438),h=o(51024),b=o(60177),v=o(69502),A=o(17388),y=o(7476),k=o(64422),F=o(13988),w=o(86198),G=o(58197),j=o(66731),E=o(43570),$=o(73465),O=o(6736),S=o(30864),D=o(59528),Y=o(73955);function AddonModResourceIndexComponent_Conditional_1_Template(e,n){if(1&e){const e=T.RV6();T.j41(0,"ion-button",9),T.nI1(1,"translate"),T.bIt("click",(function AddonModResourceIndexComponent_Conditional_1_Template_ion_button_click_0_listener(){T.eBV(e);const n=T.XpG();return T.Njj(n.openModuleSummary())})),T.nrm(2,"ion-icon",10),T.k0s()}2&e&&T.Y8G("ariaLabel",T.bMT(1,1,"core.info"))}function AddonModResourceIndexComponent_Conditional_2_Template(e,n){if(1&e){const e=T.RV6();T.j41(0,"core-context-menu")(1,"core-context-menu-item",11),T.nI1(2,"translate"),T.bIt("action",(function AddonModResourceIndexComponent_Conditional_2_Template_core_context_menu_item_action_1_listener(){T.eBV(e);const n=T.XpG();return T.Njj(n.openModuleSummary())})),T.k0s()()}2&e&&(T.R7$(),T.Y8G("priority",5e3)("content",T.bMT(2,2,"core.info")))}function AddonModResourceIndexComponent_div_5_Template(e,n){if(1&e&&(T.j41(0,"div",12),T.nrm(1,"core-format-text",13),T.k0s()),2&e){const e=T.XpG();T.R7$(),T.Y8G("text",e.module.afterlink)("contextInstanceId",e.module.id)("courseId",e.courseId)}}function AddonModResourceIndexComponent_ion_card_6_Template(e,n){if(1&e&&(T.j41(0,"ion-card",14)(1,"ion-item"),T.nrm(2,"ion-icon",15),T.j41(3,"ion-label"),T.nrm(4,"span",16),T.k0s()()()),2&e){const e=T.XpG();T.R7$(4),T.Y8G("innerHTML",e.warning,T.npT)}}function AddonModResourceIndexComponent_ng_container_7_Template(e,n){if(1&e&&(T.qex(0),T.nrm(1,"core-iframe",17),T.bVm()),2&e){const e=T.XpG();T.R7$(),T.Y8G("src",e.src)}}function AddonModResourceIndexComponent_div_8_Template(e,n){if(1&e&&(T.j41(0,"div",18),T.nrm(1,"core-format-text",19),T.k0s()),2&e){const e=T.XpG();T.R7$(),T.Y8G("text",e.contentText)("filter",!1)}}function AddonModResourceIndexComponent_ng_container_9_ion_item_2_Template(e,n){if(1&e&&(T.j41(0,"ion-item",21)(1,"ion-label")(2,"p",22),T.EFF(3),T.nI1(4,"translate"),T.k0s(),T.j41(5,"p"),T.EFF(6),T.k0s()()()),2&e){const e=T.XpG(2);T.R7$(3),T.JRh(T.bMT(4,2,"core.type")),T.R7$(3),T.JRh(e.type)}}function AddonModResourceIndexComponent_ng_container_9_ng_container_3_ion_item_1_Template(e,n){if(1&e&&(T.j41(0,"ion-item",21)(1,"ion-label")(2,"p",22),T.EFF(3),T.nI1(4,"translate"),T.k0s(),T.j41(5,"p"),T.EFF(6),T.k0s()()()),2&e){const e=T.XpG(3);T.R7$(3),T.JRh(T.bMT(4,2,"core.size")),T.R7$(3),T.JRh(e.readableSize)}}function AddonModResourceIndexComponent_ng_container_9_ng_container_3_ion_item_2_Template(e,n){if(1&e&&(T.j41(0,"ion-item",21)(1,"ion-label")(2,"p",22),T.EFF(3),T.nI1(4,"translate"),T.k0s(),T.j41(5,"p"),T.EFF(6),T.nI1(7,"coreFormatDate"),T.k0s()()()),2&e){const e=T.XpG(3);T.R7$(3),T.JRh(T.bMT(4,2,"core.datecreated")),T.R7$(3),T.JRh(T.bMT(7,4,e.timecreated))}}function AddonModResourceIndexComponent_ng_container_9_ng_container_3_ion_item_3_Template(e,n){if(1&e&&(T.j41(0,"ion-item",21)(1,"ion-label")(2,"p",22),T.EFF(3),T.nI1(4,"translate"),T.k0s(),T.j41(5,"p"),T.EFF(6),T.nI1(7,"coreFormatDate"),T.k0s()()()),2&e){const e=T.XpG(3);T.R7$(3),T.JRh(T.bMT(4,2,"core.lastmodified")),T.R7$(3),T.JRh(T.bMT(7,4,e.timemodified))}}function AddonModResourceIndexComponent_ng_container_9_ng_container_3_ion_item_4_ion_grid_7_Template(e,n){1&e&&(T.j41(0,"ion-grid",24)(1,"ion-row",25)(2,"ion-col",26),T.nrm(3,"ion-icon",27),T.k0s(),T.j41(4,"ion-col")(5,"p")(6,"strong"),T.EFF(7),T.nI1(8,"translate"),T.k0s()()()()()),2&e&&(T.R7$(7),T.JRh(T.bMT(8,1,"addon.mod_resource.resourcestatusoutdated")))}function AddonModResourceIndexComponent_ng_container_9_ng_container_3_ion_item_4_Template(e,n){if(1&e&&(T.j41(0,"ion-item",21)(1,"ion-label")(2,"p",22),T.EFF(3),T.nI1(4,"translate"),T.k0s(),T.j41(5,"p"),T.EFF(6),T.k0s(),T.DNE(7,AddonModResourceIndexComponent_ng_container_9_ng_container_3_ion_item_4_ion_grid_7_Template,9,3,"ion-grid",23),T.k0s()()),2&e){const e=T.XpG(3);T.R7$(3),T.JRh(T.bMT(4,3,"core.lastdownloaded")),T.R7$(3),T.JRh(e.downloadTimeReadable),T.R7$(),T.Y8G("ngIf",e.currentStatus===e.outdatedStatus)}}function AddonModResourceIndexComponent_ng_container_9_ng_container_3_Template(e,n){if(1&e&&(T.qex(0),T.DNE(1,AddonModResourceIndexComponent_ng_container_9_ng_container_3_ion_item_1_Template,7,4,"ion-item",20)(2,AddonModResourceIndexComponent_ng_container_9_ng_container_3_ion_item_2_Template,8,6,"ion-item",20)(3,AddonModResourceIndexComponent_ng_container_9_ng_container_3_ion_item_3_Template,8,6,"ion-item",20)(4,AddonModResourceIndexComponent_ng_container_9_ng_container_3_ion_item_4_Template,8,5,"ion-item",20),T.bVm()),2&e){const e=T.XpG(2);T.R7$(),T.Y8G("ngIf",e.readableSize),T.R7$(),T.Y8G("ngIf",e.timecreated>0),T.R7$(),T.Y8G("ngIf",e.timemodified>0),T.R7$(),T.Y8G("ngIf",e.downloadTimeReadable)}}function AddonModResourceIndexComponent_ng_container_9_Template(e,n){if(1&e&&(T.qex(0),T.j41(1,"ion-list"),T.DNE(2,AddonModResourceIndexComponent_ng_container_9_ion_item_2_Template,7,4,"ion-item",20)(3,AddonModResourceIndexComponent_ng_container_9_ng_container_3_Template,5,4,"ng-container",6),T.k0s(),T.bVm()),2&e){const e=T.XpG();T.R7$(2),T.Y8G("ngIf",e.type),T.R7$(),T.Y8G("ngIf",!e.isExternalFile)}}function AddonModResourceIndexComponent_div_10_div_1_ion_button_1_Template(e,n){if(1&e){const e=T.RV6();T.j41(0,"ion-button",34),T.bIt("click",(function AddonModResourceIndexComponent_div_10_div_1_ion_button_1_Template_ion_button_click_0_listener(){T.eBV(e);const n=T.XpG(3);return T.Njj(n.open(n.openFileAction.OPEN_WITH))})),T.nrm(1,"ion-icon",35),T.EFF(2),T.nI1(3,"translate"),T.k0s()}2&e&&(T.R7$(2),T.SpI(" ",T.bMT(3,1,"core.openwith")," "))}function AddonModResourceIndexComponent_div_10_div_1_ng_container_3_Template(e,n){1&e&&(T.qex(0),T.nrm(1,"ion-icon",36),T.EFF(2),T.nI1(3,"translate"),T.bVm()),2&e&&(T.R7$(2),T.SpI(" ",T.bMT(3,1,"core.play")," "))}function AddonModResourceIndexComponent_div_10_div_1_ng_container_4_Template(e,n){1&e&&(T.qex(0),T.nrm(1,"ion-icon",37),T.EFF(2),T.nI1(3,"translate"),T.bVm()),2&e&&(T.R7$(2),T.SpI(" ",T.bMT(3,1,"addon.mod_resource.openthefile")," "))}function AddonModResourceIndexComponent_div_10_div_1_Template(e,n){if(1&e){const e=T.RV6();T.j41(0,"div",31),T.DNE(1,AddonModResourceIndexComponent_div_10_div_1_ion_button_1_Template,4,3,"ion-button",32),T.j41(2,"ion-button",33),T.bIt("click",(function AddonModResourceIndexComponent_div_10_div_1_Template_ion_button_click_2_listener(){T.eBV(e);const n=T.XpG(2);return T.Njj(n.open(n.openFileAction.OPEN))})),T.DNE(3,AddonModResourceIndexComponent_div_10_div_1_ng_container_3_Template,4,3,"ng-container",6)(4,AddonModResourceIndexComponent_div_10_div_1_ng_container_4_Template,4,3,"ng-container",6),T.k0s()()}if(2&e){const e=T.XpG(2);T.R7$(),T.Y8G("ngIf",e.isIOS&&(!e.shouldOpenInBrowser||!e.isOnline)),T.R7$(2),T.Y8G("ngIf",e.isStreamedFile),T.R7$(),T.Y8G("ngIf",!e.isStreamedFile)}}function AddonModResourceIndexComponent_div_10_Template(e,n){if(1&e&&(T.j41(0,"div",28),T.DNE(1,AddonModResourceIndexComponent_div_10_div_1_Template,5,3,"div",29),T.nrm(2,"core-course-module-navigation",30),T.k0s()),2&e){const e=T.XpG();T.R7$(),T.Y8G("ngIf","external"===e.mode),T.R7$(),T.Y8G("courseId",e.courseId)("currentModuleId",e.module.id)}}let N=(()=>{var e;class AddonModResourceIndexComponent extends r.x{constructor(e){super("AddonModResourceIndexComponent",e),this.component=x.X,this.pluginName="resource",this.mode="",this.src="",this.contentText="",this.displayDescription=!0,this.warning="",this.isIOS=!1,this.openFileAction=M.n,this.isOnline=!1,this.isStreamedFile=!1,this.shouldOpenInBrowser=!1,this.type="",this.readableSize="",this.timecreated=-1,this.timemodified=-1,this.isExternalFile=!1,this.outdatedStatus=i.DownloadStatus.OUTDATED}ngOnInit(){var _superprop_getNgOnInit=()=>super.ngOnInit,e=this;return(0,t.A)((function*(){_superprop_getNgOnInit().call(e),e.isIOS=R.CorePlatform.isIOS(),e.isOnline=c.WE.isOnline(),e.onlineObserver=c.WE.onChange().subscribe((()=>{f.SK.run((()=>{e.isOnline=c.WE.isOnline()}))})),yield e.loadContent()}))()}invalidateContent(){var e=this;return(0,t.A)((function*(){return g.x.invalidateContent(e.module.id,e.courseId)}))()}fetchContent(e){var n=this;return(0,t.A)((function*(){const o=yield a.CoreCourse.getModuleContents(n.module,void 0,void 0,!1,e);if(!o.length)throw new d.CoreError(f.HT.instant("core.filenotfound"));n.module.afterlink=yield I.j.getAfterLinkDetails(n.module,n.courseId);const t=yield g.x.getResourceData(n.courseId,n.module.id);n.description=t.intro||"";const i=t.displayoptions?p.Ni.unserialize(t.displayoptions):{};if(n.displayDescription=void 0===i.printintro||!!i.printintro,n.dataRetrieved.emit(t),n.setStatusListener(),I.j.isDisplayedInIframe(n.module)){var r;const o=yield n.downloadResourceIfNeeded(e,!0),t=yield I.j.getIframeSrc(n.module);return n.mode="iframe",n.src&&t.toString()==n.src.toString()?(n.src="",setTimeout((()=>{n.src=t}))):n.src=t,n.displayDescription=!1,n.warning=o.failed?n.getErrorDownloadingSomeFilesMessage(null!==(r=o.error)&&void 0!==r?r:""):"",void 0}if(t&&"display"in t&&I.j.isDisplayedEmbedded(n.module,t.display))n.mode="embedded",n.warning="",n.contentText=yield I.j.getEmbeddedHtml(n.module),n.mode=n.contentText.length>0?"embedded":"external";else{let e;n.mode="external",n.warning="",n.displayDescription=!0,n.isIOS&&(n.shouldOpenInBrowser=l.CoreFileHelper.shouldOpenInBrowser(o[0])),"contentsinfo"in n.module&&n.module.contentsinfo?(e=n.module.contentsinfo.mimetypes[0],n.readableSize=p.Ni.bytesToSize(n.module.contentsinfo.filessize,1),n.timemodified=1e3*n.module.contentsinfo.lastmodified):(e=yield u.CoreMimetypeUtils.getMimeTypeFromUrl(l.CoreFileHelper.getFileUrl(o[0])),n.readableSize=p.Ni.bytesToSize(o[0].filesize,1),n.timemodified=1e3*o[0].timemodified),n.timecreated=1e3*o[0].timecreated,n.isExternalFile=!!o[0].isexternalfile,n.type=u.CoreMimetypeUtils.getMimetypeDescription(e),n.isStreamedFile=u.CoreMimetypeUtils.isStreamedMimetype(e)}}))()}logActivity(){var e=this;return(0,t.A)((function*(){yield C.g.ignoreErrors(g.x.logView(e.module.instance)),e.analyticsLogEvent("mod_resource_view_resource")}))()}open(e){var n=this;return(0,t.A)((function*(){var o;let t=yield s.CoreCourseModulePrefetchDelegate.isModuleDownloadable(n.module,n.courseId);if(t&&(t=yield I.j.isMainFileDownloadable(n.module),t)){if(n.currentStatus===i.DownloadStatus.OUTDATED&&!n.isOnline&&!n.isExternalFile){const e=yield m.CoreDomUtils.showAlert(void 0,f.HT.instant("addon.mod_resource.resourcestatusoutdatedconfirm"));yield e.onWillDismiss()}return I.j.openModuleFile(n.module,n.courseId,{iOSOpenFileAction:e})}yield null===(o=_.CoreSites.getCurrentSite())||void 0===o?void 0:o.openInBrowserWithAutoLogin(n.module.url||"")}))()}ngOnDestroy(){var e;super.ngOnDestroy(),null===(e=this.onlineObserver)||void 0===e||e.unsubscribe()}}return(e=AddonModResourceIndexComponent).ɵfac=function AddonModResourceIndexComponent_Factory(n){return new(n||e)(T.rXU(h.k,8))},e.ɵcmp=T.VBU({type:e,selectors:[["addon-mod-resource-index"]],features:[T.Vt3],decls:11,vars:13,consts:[["slot","end"],["fill","clear","aria-haspopup","true",3,"ariaLabel"],[3,"hideUntil"],[3,"completionChanged","module","courseId","description","component","componentId"],["class","addon-mod_resource-afterlink ion-text-wrap","description","",4,"ngIf"],["class","core-warning-card",4,"ngIf"],[4,"ngIf"],["class","ion-padding",4,"ngIf"],["collapsible-footer","","appearOnBottom","","slot","fixed",4,"ngIf"],["fill","clear","aria-haspopup","true",3,"click","ariaLabel"],["name","fas-circle-info","slot","icon-only","aria-hidden","true"],["iconAction","fas-circle-info",3,"action","priority","content"],["description","",1,"addon-mod_resource-afterlink","ion-text-wrap"],["contextLevel","module",3,"text","contextInstanceId","courseId"],[1,"core-warning-card"],["name","fas-triangle-exclamation","slot","start","aria-hidden","true"],[3,"innerHTML"],[3,"src"],[1,"ion-padding"],[3,"text","filter"],["class","ion-text-wrap",4,"ngIf"],[1,"ion-text-wrap"],[1,"item-heading"],["class","addon-mod_resource-outdated",4,"ngIf"],[1,"addon-mod_resource-outdated"],[1,"ion-align-items-center"],["size","auto"],["color","warning","name","fas-triangle-exclamation","aria-hidden","true"],["collapsible-footer","","appearOnBottom","","slot","fixed"],["class","list-item-limited-width",4,"ngIf"],[3,"courseId","currentModuleId"],[1,"list-item-limited-width"],["expand","block","fill","outline","class","ion-margin ion-text-wrap",3,"click",4,"ngIf"],["expand","block",1,"ion-margin","ion-text-wrap",3,"click"],["expand","block","fill","outline",1,"ion-margin","ion-text-wrap",3,"click"],["name","far-share-from-square","slot","start","aria-hidden","true"],["name","fas-play","slot","start","aria-hidden","true"],["name","far-file","slot","start","aria-hidden","true"]],template:function AddonModResourceIndexComponent_Template(e,n){1&e&&(T.j41(0,"core-navbar-buttons",0),T.DNE(1,AddonModResourceIndexComponent_Conditional_1_Template,3,3,"ion-button",1)(2,AddonModResourceIndexComponent_Conditional_2_Template,3,4),T.k0s(),T.j41(3,"core-loading",2)(4,"core-course-module-info",3),T.bIt("completionChanged",(function AddonModResourceIndexComponent_Template_core_course_module_info_completionChanged_4_listener(){return n.onCompletionChange()})),T.DNE(5,AddonModResourceIndexComponent_div_5_Template,2,3,"div",4),T.k0s(),T.DNE(6,AddonModResourceIndexComponent_ion_card_6_Template,5,1,"ion-card",5)(7,AddonModResourceIndexComponent_ng_container_7_Template,2,1,"ng-container",6)(8,AddonModResourceIndexComponent_div_8_Template,2,2,"div",7)(9,AddonModResourceIndexComponent_ng_container_9_Template,4,2,"ng-container",6)(10,AddonModResourceIndexComponent_div_10_Template,3,3,"div",8),T.k0s()),2&e&&(T.R7$(),T.vxM(1,n.courseContentsPage?2:1),T.R7$(2),T.Y8G("hideUntil",!n.showLoading),T.R7$(),T.Y8G("module",n.module)("courseId",n.courseId)("description",n.displayDescription&&n.description)("component",n.component)("componentId",n.componentId),T.R7$(),T.Y8G("ngIf",n.module.afterlink),T.R7$(),T.Y8G("ngIf",n.warning),T.R7$(),T.Y8G("ngIf","iframe"===n.mode),T.R7$(),T.Y8G("ngIf","embedded"===n.mode),T.R7$(),T.Y8G("ngIf","external"===n.mode),T.R7$(),T.Y8G("ngIf",!n.showLoading))},dependencies:[b.bT,v.B,A.Q,y.l,k.R,F.c,w.t,G.B,j.i,E.T,$.Jm,$.b_,$.hU,$.lO,$.iq,$.uz,$.he,$.nf,$.ln,O.Y,S.Q,D.f,Y.D9],styles:["[_nghost-%COMP%]   .addon-mod_resource-outdated[_ngcontent-%COMP%]{padding-inline-start:0px;padding-inline-end:0px;padding-top:4px;padding-bottom:0}[_nghost-%COMP%]   .addon-mod_resource-outdated[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:var(--mdl-typography-icon-fontSize-lg)}[_nghost-%COMP%]   .addon-mod_resource-afterlink[_ngcontent-%COMP%]{font-size:var(--text-size)}"]}),AddonModResourceIndexComponent})()}}]);